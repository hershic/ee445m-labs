<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: driverlib/usb.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('usb_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">driverlib/usb.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="usb_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//*****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">//</span>
<a name="l00003"></a>00003 <span class="comment">// usb.c - Driver for the USB Interface.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// Copyright (c) 2007-2014 Texas Instruments Incorporated.  All rights reserved.</span>
<a name="l00006"></a>00006 <span class="comment">// Software License Agreement</span>
<a name="l00007"></a>00007 <span class="comment">// </span>
<a name="l00008"></a>00008 <span class="comment">//   Redistribution and use in source and binary forms, with or without</span>
<a name="l00009"></a>00009 <span class="comment">//   modification, are permitted provided that the following conditions</span>
<a name="l00010"></a>00010 <span class="comment">//   are met:</span>
<a name="l00011"></a>00011 <span class="comment">// </span>
<a name="l00012"></a>00012 <span class="comment">//   Redistributions of source code must retain the above copyright</span>
<a name="l00013"></a>00013 <span class="comment">//   notice, this list of conditions and the following disclaimer.</span>
<a name="l00014"></a>00014 <span class="comment">// </span>
<a name="l00015"></a>00015 <span class="comment">//   Redistributions in binary form must reproduce the above copyright</span>
<a name="l00016"></a>00016 <span class="comment">//   notice, this list of conditions and the following disclaimer in the</span>
<a name="l00017"></a>00017 <span class="comment">//   documentation and/or other materials provided with the  </span>
<a name="l00018"></a>00018 <span class="comment">//   distribution.</span>
<a name="l00019"></a>00019 <span class="comment">// </span>
<a name="l00020"></a>00020 <span class="comment">//   Neither the name of Texas Instruments Incorporated nor the names of</span>
<a name="l00021"></a>00021 <span class="comment">//   its contributors may be used to endorse or promote products derived</span>
<a name="l00022"></a>00022 <span class="comment">//   from this software without specific prior written permission.</span>
<a name="l00023"></a>00023 <span class="comment">// </span>
<a name="l00024"></a>00024 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00025"></a>00025 <span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00026"></a>00026 <span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00027"></a>00027 <span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00028"></a>00028 <span class="comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00029"></a>00029 <span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00030"></a>00030 <span class="comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00031"></a>00031 <span class="comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00032"></a>00032 <span class="comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00033"></a>00033 <span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00034"></a>00034 <span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00035"></a>00035 <span class="comment">// </span>
<a name="l00036"></a>00036 <span class="comment">// This is part of revision 2.1.0.12573 of the Tiva Peripheral Driver Library.</span>
<a name="l00037"></a>00037 <span class="comment">//</span>
<a name="l00038"></a>00038 <span class="comment">//*****************************************************************************</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">//*****************************************************************************</span>
<a name="l00041"></a>00041 <span class="comment">//</span>
<a name="l00044"></a>00044 <span class="comment"></span><span class="comment">//</span>
<a name="l00045"></a>00045 <span class="comment">//*****************************************************************************</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;stdbool.h&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;stdint.h&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="hw__ints_8h.html">inc/hw_ints.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="hw__memmap_8h.html">inc/hw_memmap.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="hw__types_8h.html">inc/hw_types.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="hw__sysctl_8h.html">inc/hw_sysctl.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="hw__usb_8h.html">inc/hw_usb.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">driverlib/debug.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="interrupt_8h.html">driverlib/interrupt.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="sysctl_8h.html">driverlib/sysctl.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="udma_8h.html">driverlib/udma.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="usb_8h.html">driverlib/usb.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">//*****************************************************************************</span>
<a name="l00061"></a>00061 <span class="comment">//</span>
<a name="l00062"></a>00062 <span class="comment">// Amount to shift the RX interrupt sources by in the flags used in the</span>
<a name="l00063"></a>00063 <span class="comment">// interrupt calls.</span>
<a name="l00064"></a>00064 <span class="comment">//</span>
<a name="l00065"></a>00065 <span class="comment">//*****************************************************************************</span>
<a name="l00066"></a><a class="code" href="group__usb__api.html#ga30003dae047f43963cd6ba85ae6f0689">00066</a> <span class="preprocessor">#define USB_INTEP_RX_SHIFT      16</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068 <span class="comment">//*****************************************************************************</span>
<a name="l00069"></a>00069 <span class="comment">//</span>
<a name="l00070"></a>00070 <span class="comment">// Amount to shift the RX endpoint status sources by in the flags used in the</span>
<a name="l00071"></a>00071 <span class="comment">// calls.</span>
<a name="l00072"></a>00072 <span class="comment">//</span>
<a name="l00073"></a>00073 <span class="comment">//*****************************************************************************</span>
<a name="l00074"></a><a class="code" href="group__usb__api.html#ga20ceb718c0b5bea3d8b0a8d89919160c">00074</a> <span class="preprocessor">#define USB_RX_EPSTATUS_SHIFT   16</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>
<a name="l00076"></a>00076 <span class="comment">//*****************************************************************************</span>
<a name="l00077"></a>00077 <span class="comment">//</span>
<a name="l00078"></a>00078 <span class="comment">// Converts from an endpoint specifier to the offset of the endpoint&#39;s</span>
<a name="l00079"></a>00079 <span class="comment">// control/status registers.</span>
<a name="l00080"></a>00080 <span class="comment">//</span>
<a name="l00081"></a>00081 <span class="comment">//*****************************************************************************</span>
<a name="l00082"></a><a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">00082</a> <span class="preprocessor">#define EP_OFFSET(Endpoint)     (Endpoint - 0x10)</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>
<a name="l00084"></a>00084 <span class="comment">//*****************************************************************************</span>
<a name="l00085"></a>00085 <span class="comment">//</span>
<a name="l00086"></a>00086 <span class="comment">// Sets one of the indexed registers.</span>
<a name="l00087"></a>00087 <span class="comment">//</span>
<a name="l00088"></a>00088 <span class="comment">// \param ui32Base specifies the USB module base address.</span>
<a name="l00089"></a>00089 <span class="comment">// \param ui32Endpoint is the endpoint index to target for this write.</span>
<a name="l00090"></a>00090 <span class="comment">// \param ui32IndexedReg is the indexed register to write to.</span>
<a name="l00091"></a>00091 <span class="comment">// \param ui8Value is the value to write to the register.</span>
<a name="l00092"></a>00092 <span class="comment">//</span>
<a name="l00093"></a>00093 <span class="comment">// This function is used to access the indexed registers for each endpoint.</span>
<a name="l00094"></a>00094 <span class="comment">// The only registers that are indexed are the FIFO configuration registers,</span>
<a name="l00095"></a>00095 <span class="comment">// which are not used after configuration.</span>
<a name="l00096"></a>00096 <span class="comment">//</span>
<a name="l00097"></a>00097 <span class="comment">// \return None.</span>
<a name="l00098"></a>00098 <span class="comment">//</span>
<a name="l00099"></a>00099 <span class="comment">//*****************************************************************************</span>
<a name="l00100"></a>00100 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00101"></a><a class="code" href="group__usb__api.html#gad79a9385143d09823224d3715f63e412">00101</a> <a class="code" href="group__usb__api.html#gad79a9385143d09823224d3715f63e412">_USBIndexWrite</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l00102"></a>00102                uint32_t ui32IndexedReg, uint32_t ui32Value, uint32_t ui32Size)
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104     uint32_t ui32Index;
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     <span class="comment">//</span>
<a name="l00107"></a>00107     <span class="comment">// Check the arguments.</span>
<a name="l00108"></a>00108     <span class="comment">//</span>
<a name="l00109"></a>00109     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00110"></a>00110     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == 0) || (ui32Endpoint == 1) || (ui32Endpoint == 2) ||
<a name="l00111"></a>00111            (ui32Endpoint == 3));
<a name="l00112"></a>00112     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Size == 1) || (ui32Size == 2));
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="comment">//</span>
<a name="l00115"></a>00115     <span class="comment">// Save the old index in case it was in use.</span>
<a name="l00116"></a>00116     <span class="comment">//</span>
<a name="l00117"></a>00117     ui32Index = <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a032870fa4a26a05e3049ee555c36070a">USB_O_EPIDX</a>);
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <span class="comment">//</span>
<a name="l00120"></a>00120     <span class="comment">// Set the index.</span>
<a name="l00121"></a>00121     <span class="comment">//</span>
<a name="l00122"></a>00122     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a032870fa4a26a05e3049ee555c36070a">USB_O_EPIDX</a>) = ui32Endpoint;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="comment">//</span>
<a name="l00125"></a>00125     <span class="comment">// Determine the size of the register value.</span>
<a name="l00126"></a>00126     <span class="comment">//</span>
<a name="l00127"></a>00127     <span class="keywordflow">if</span>(ui32Size == 1)
<a name="l00128"></a>00128     {
<a name="l00129"></a>00129         <span class="comment">//</span>
<a name="l00130"></a>00130         <span class="comment">// Set the value.</span>
<a name="l00131"></a>00131         <span class="comment">//</span>
<a name="l00132"></a>00132         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + ui32IndexedReg) = ui32Value;
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134     <span class="keywordflow">else</span>
<a name="l00135"></a>00135     {
<a name="l00136"></a>00136         <span class="comment">//</span>
<a name="l00137"></a>00137         <span class="comment">// Set the value.</span>
<a name="l00138"></a>00138         <span class="comment">//</span>
<a name="l00139"></a>00139         <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + ui32IndexedReg) = ui32Value;
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="comment">//</span>
<a name="l00143"></a>00143     <span class="comment">// Restore the old index in case it was in use.</span>
<a name="l00144"></a>00144     <span class="comment">//</span>
<a name="l00145"></a>00145     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a032870fa4a26a05e3049ee555c36070a">USB_O_EPIDX</a>) = ui32Index;
<a name="l00146"></a>00146 }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="comment">//*****************************************************************************</span>
<a name="l00149"></a>00149 <span class="comment">//</span>
<a name="l00150"></a>00150 <span class="comment">// Reads one of the indexed registers.</span>
<a name="l00151"></a>00151 <span class="comment">//</span>
<a name="l00152"></a>00152 <span class="comment">// \param ui32Base specifies the USB module base address.</span>
<a name="l00153"></a>00153 <span class="comment">// \param ui32Endpoint is the endpoint index to target for this write.</span>
<a name="l00154"></a>00154 <span class="comment">// \param ui32IndexedReg is the indexed register to write to.</span>
<a name="l00155"></a>00155 <span class="comment">//</span>
<a name="l00156"></a>00156 <span class="comment">// This function is used internally to access the indexed registers for each</span>
<a name="l00157"></a>00157 <span class="comment">// endpoint.  The only registers that are indexed are the FIFO configuration</span>
<a name="l00158"></a>00158 <span class="comment">// registers, which are not used after configuration.</span>
<a name="l00159"></a>00159 <span class="comment">//</span>
<a name="l00160"></a>00160 <span class="comment">// \return The value in the register requested.</span>
<a name="l00161"></a>00161 <span class="comment">//</span>
<a name="l00162"></a>00162 <span class="comment">//*****************************************************************************</span>
<a name="l00163"></a>00163 <span class="keyword">static</span> uint32_t
<a name="l00164"></a><a class="code" href="group__usb__api.html#gac3b3f5b56ebdcc078407fd787afcafae">00164</a> <a class="code" href="group__usb__api.html#gac3b3f5b56ebdcc078407fd787afcafae">_USBIndexRead</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l00165"></a>00165               uint32_t ui32IndexedReg, uint32_t ui32Size)
<a name="l00166"></a>00166 {
<a name="l00167"></a>00167     uint8_t ui8Index;
<a name="l00168"></a>00168     uint8_t ui8Value;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     <span class="comment">//</span>
<a name="l00171"></a>00171     <span class="comment">// Check the arguments.</span>
<a name="l00172"></a>00172     <span class="comment">//</span>
<a name="l00173"></a>00173     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00174"></a>00174     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == 0) || (ui32Endpoint == 1) || (ui32Endpoint == 2) ||
<a name="l00175"></a>00175            (ui32Endpoint == 3));
<a name="l00176"></a>00176     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Size == 1) || (ui32Size == 2));
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <span class="comment">//</span>
<a name="l00179"></a>00179     <span class="comment">// Save the old index in case it was in use.</span>
<a name="l00180"></a>00180     <span class="comment">//</span>
<a name="l00181"></a>00181     ui8Index = <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a032870fa4a26a05e3049ee555c36070a">USB_O_EPIDX</a>);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <span class="comment">//</span>
<a name="l00184"></a>00184     <span class="comment">// Set the index.</span>
<a name="l00185"></a>00185     <span class="comment">//</span>
<a name="l00186"></a>00186     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a032870fa4a26a05e3049ee555c36070a">USB_O_EPIDX</a>) = ui32Endpoint;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="comment">//</span>
<a name="l00189"></a>00189     <span class="comment">// Determine the size of the register value.</span>
<a name="l00190"></a>00190     <span class="comment">//</span>
<a name="l00191"></a>00191     <span class="keywordflow">if</span>(ui32Size == 1)
<a name="l00192"></a>00192     {
<a name="l00193"></a>00193         <span class="comment">//</span>
<a name="l00194"></a>00194         <span class="comment">// Get the value.</span>
<a name="l00195"></a>00195         <span class="comment">//</span>
<a name="l00196"></a>00196         ui8Value = <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + ui32IndexedReg);
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198     <span class="keywordflow">else</span>
<a name="l00199"></a>00199     {
<a name="l00200"></a>00200         <span class="comment">//</span>
<a name="l00201"></a>00201         <span class="comment">// Get the value.</span>
<a name="l00202"></a>00202         <span class="comment">//</span>
<a name="l00203"></a>00203         ui8Value = <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + ui32IndexedReg);
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="comment">//</span>
<a name="l00207"></a>00207     <span class="comment">// Restore the old index in case it was in use.</span>
<a name="l00208"></a>00208     <span class="comment">//</span>
<a name="l00209"></a>00209     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a032870fa4a26a05e3049ee555c36070a">USB_O_EPIDX</a>) = ui8Index;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     <span class="comment">//</span>
<a name="l00212"></a>00212     <span class="comment">// Return the register&#39;s value.</span>
<a name="l00213"></a>00213     <span class="comment">//</span>
<a name="l00214"></a>00214     <span class="keywordflow">return</span>(ui8Value);
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="comment">//*****************************************************************************</span>
<a name="l00218"></a>00218 <span class="comment">//</span>
<a name="l00229"></a>00229 <span class="comment"></span><span class="comment">//</span>
<a name="l00230"></a>00230 <span class="comment">//*****************************************************************************</span>
<a name="l00231"></a>00231 <span class="keywordtype">void</span>
<a name="l00232"></a><a class="code" href="group__usb__api.html#gaf63de77efc2ce0912a4be7e5970d6888">00232</a> <a class="code" href="group__usb__api.html#gaf63de77efc2ce0912a4be7e5970d6888">USBHostSuspend</a>(uint32_t ui32Base)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234     <span class="comment">//</span>
<a name="l00235"></a>00235     <span class="comment">// Check the arguments.</span>
<a name="l00236"></a>00236     <span class="comment">//</span>
<a name="l00237"></a>00237     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     <span class="comment">//</span>
<a name="l00240"></a>00240     <span class="comment">// Send the suspend signaling to the USB bus.</span>
<a name="l00241"></a>00241     <span class="comment">//</span>
<a name="l00242"></a>00242     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) |= <a class="code" href="hw__usb_8h.html#a26f24c171021e851e56f6bc09ce30e1f">USB_POWER_SUSPEND</a>;
<a name="l00243"></a>00243 }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245 <span class="comment">//*****************************************************************************</span>
<a name="l00246"></a>00246 <span class="comment">//</span>
<a name="l00261"></a>00261 <span class="comment"></span><span class="comment">//</span>
<a name="l00262"></a>00262 <span class="comment">//*****************************************************************************</span>
<a name="l00263"></a>00263 <span class="keywordtype">void</span>
<a name="l00264"></a><a class="code" href="group__usb__api.html#ga5855c6aac27d3f867721c70176d57b8d">00264</a> <a class="code" href="group__usb__api.html#ga5855c6aac27d3f867721c70176d57b8d">USBHostReset</a>(uint32_t ui32Base, <span class="keywordtype">bool</span> bStart)
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266     <span class="comment">//</span>
<a name="l00267"></a>00267     <span class="comment">// Check the arguments.</span>
<a name="l00268"></a>00268     <span class="comment">//</span>
<a name="l00269"></a>00269     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="comment">//</span>
<a name="l00272"></a>00272     <span class="comment">// Send a reset signal to the bus.</span>
<a name="l00273"></a>00273     <span class="comment">//</span>
<a name="l00274"></a>00274     <span class="keywordflow">if</span>(bStart)
<a name="l00275"></a>00275     {
<a name="l00276"></a>00276         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) |= <a class="code" href="hw__usb_8h.html#a07be6b6ae6bc5b8829d50f4364e72170">USB_POWER_RESET</a>;
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278     <span class="keywordflow">else</span>
<a name="l00279"></a>00279     {
<a name="l00280"></a>00280         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a07be6b6ae6bc5b8829d50f4364e72170">USB_POWER_RESET</a>;
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 <span class="comment">//*****************************************************************************</span>
<a name="l00285"></a>00285 <span class="comment">//</span>
<a name="l00315"></a>00315 <span class="comment"></span><span class="comment">//</span>
<a name="l00316"></a>00316 <span class="comment">//*****************************************************************************</span>
<a name="l00317"></a>00317 <span class="keywordtype">void</span>
<a name="l00318"></a><a class="code" href="group__usb__api.html#gaaa314fd6805d04b88687890d35de2706">00318</a> <a class="code" href="group__usb__api.html#gaaa314fd6805d04b88687890d35de2706">USBHighSpeed</a>(uint32_t ui32Base, <span class="keywordtype">bool</span> bEnable)
<a name="l00319"></a>00319 {
<a name="l00320"></a>00320     <span class="comment">//</span>
<a name="l00321"></a>00321     <span class="comment">// Check the arguments.</span>
<a name="l00322"></a>00322     <span class="comment">//</span>
<a name="l00323"></a>00323     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <span class="keywordflow">if</span>(bEnable)
<a name="l00326"></a>00326     {
<a name="l00327"></a>00327         <span class="comment">//</span>
<a name="l00328"></a>00328         <span class="comment">// Enable high speed mode negotiations in hosts or device mode.</span>
<a name="l00329"></a>00329         <span class="comment">//</span>
<a name="l00330"></a>00330         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) |= <a class="code" href="hw__usb_8h.html#a759aaef010059777ab66ec7ba4e11eb0">USB_POWER_HSENAB</a>;
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332     <span class="keywordflow">else</span>
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334         <span class="comment">//</span>
<a name="l00335"></a>00335         <span class="comment">// Enable high speed mode negotiations in hosts or device mode.</span>
<a name="l00336"></a>00336         <span class="comment">//</span>
<a name="l00337"></a>00337         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a759aaef010059777ab66ec7ba4e11eb0">USB_POWER_HSENAB</a>;
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="comment">//*****************************************************************************</span>
<a name="l00342"></a>00342 <span class="comment">//</span>
<a name="l00365"></a>00365 <span class="comment"></span><span class="comment">//</span>
<a name="l00366"></a>00366 <span class="comment">//*****************************************************************************</span>
<a name="l00367"></a>00367 <span class="keywordtype">void</span>
<a name="l00368"></a><a class="code" href="group__usb__api.html#ga19c9936d7b17cd81b5b4969769e5b6c9">00368</a> <a class="code" href="group__usb__api.html#ga19c9936d7b17cd81b5b4969769e5b6c9">USBHostResume</a>(uint32_t ui32Base, <span class="keywordtype">bool</span> bStart)
<a name="l00369"></a>00369 {
<a name="l00370"></a>00370     <span class="comment">//</span>
<a name="l00371"></a>00371     <span class="comment">// Check the arguments.</span>
<a name="l00372"></a>00372     <span class="comment">//</span>
<a name="l00373"></a>00373     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375     <span class="comment">//</span>
<a name="l00376"></a>00376     <span class="comment">// Send a resume signal to the bus.</span>
<a name="l00377"></a>00377     <span class="comment">//</span>
<a name="l00378"></a>00378     <span class="keywordflow">if</span>(bStart)
<a name="l00379"></a>00379     {
<a name="l00380"></a>00380         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) |= <a class="code" href="hw__usb_8h.html#a1b7d36d2650b70ee144894419244e4c8">USB_POWER_RESUME</a>;
<a name="l00381"></a>00381     }
<a name="l00382"></a>00382     <span class="keywordflow">else</span>
<a name="l00383"></a>00383     {
<a name="l00384"></a>00384         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a1b7d36d2650b70ee144894419244e4c8">USB_POWER_RESUME</a>;
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386 }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="comment">//*****************************************************************************</span>
<a name="l00389"></a>00389 <span class="comment">//</span>
<a name="l00409"></a>00409 <span class="comment"></span><span class="comment">//</span>
<a name="l00410"></a>00410 <span class="comment">//*****************************************************************************</span>
<a name="l00411"></a>00411 uint32_t
<a name="l00412"></a><a class="code" href="group__usb__api.html#ga13ea6df3582326aeb9b234f15657ed7f">00412</a> <a class="code" href="group__usb__api.html#ga13ea6df3582326aeb9b234f15657ed7f">USBHostSpeedGet</a>(uint32_t ui32Base)
<a name="l00413"></a>00413 {
<a name="l00414"></a>00414     <span class="comment">//</span>
<a name="l00415"></a>00415     <span class="comment">// Check the arguments.</span>
<a name="l00416"></a>00416     <span class="comment">//</span>
<a name="l00417"></a>00417     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <span class="comment">//</span>
<a name="l00420"></a>00420     <span class="comment">// If the Full Speed device bit is set, then this is a full speed device.</span>
<a name="l00421"></a>00421     <span class="comment">//</span>
<a name="l00422"></a>00422     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) &amp; <a class="code" href="hw__usb_8h.html#a45dc0abcc59469c9035589b99deab15f">USB_POWER_HSMODE</a>)
<a name="l00423"></a>00423     {
<a name="l00424"></a>00424         <span class="keywordflow">return</span>(<a class="code" href="usb_8h.html#ad2b3e75df582ecec2adfbc4c00406332">USB_HIGH_SPEED</a>);
<a name="l00425"></a>00425     }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     <span class="comment">//</span>
<a name="l00428"></a>00428     <span class="comment">// If the Full Speed device bit is set, then this is a full speed device.</span>
<a name="l00429"></a>00429     <span class="comment">//</span>
<a name="l00430"></a>00430     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5fc89d07656f2fbb1d14dd7f05279dcd">USB_O_DEVCTL</a>) &amp; <a class="code" href="hw__usb_8h.html#aa141482d4f6178876a5b3334cb6678e6">USB_DEVCTL_FSDEV</a>)
<a name="l00431"></a>00431     {
<a name="l00432"></a>00432         <span class="keywordflow">return</span>(<a class="code" href="usb_8h.html#a254b82211d11df3f1649aad174b4cb92">USB_FULL_SPEED</a>);
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435     <span class="comment">//</span>
<a name="l00436"></a>00436     <span class="comment">// If the Low Speed device bit is set, then this is a low speed device.</span>
<a name="l00437"></a>00437     <span class="comment">//</span>
<a name="l00438"></a>00438     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5fc89d07656f2fbb1d14dd7f05279dcd">USB_O_DEVCTL</a>) &amp; <a class="code" href="hw__usb_8h.html#a0074b44b7d227fc7082abf54a3efee80">USB_DEVCTL_LSDEV</a>)
<a name="l00439"></a>00439     {
<a name="l00440"></a>00440         <span class="keywordflow">return</span>(<a class="code" href="usb_8h.html#a94ffa3513063a99bbcb1202714633fe5">USB_LOW_SPEED</a>);
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     <span class="comment">//</span>
<a name="l00444"></a>00444     <span class="comment">// The device speed is not known.</span>
<a name="l00445"></a>00445     <span class="comment">//</span>
<a name="l00446"></a>00446     <span class="keywordflow">return</span>(<a class="code" href="usb_8h.html#a2c6634a58c66a452f47799f42afb183e">USB_UNDEF_SPEED</a>);
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 <span class="comment">//*****************************************************************************</span>
<a name="l00450"></a>00450 <span class="comment">//</span>
<a name="l00471"></a>00471 <span class="comment"></span><span class="comment">//</span>
<a name="l00472"></a>00472 <span class="comment">//*****************************************************************************</span>
<a name="l00473"></a>00473 uint32_t
<a name="l00474"></a><a class="code" href="group__usb__api.html#ga4b4e8eecc32eacd26ffbada0f618263f">00474</a> <a class="code" href="group__usb__api.html#ga4b4e8eecc32eacd26ffbada0f618263f">USBDevSpeedGet</a>(uint32_t ui32Base)
<a name="l00475"></a>00475 {
<a name="l00476"></a>00476     <span class="comment">//</span>
<a name="l00477"></a>00477     <span class="comment">// Check the arguments.</span>
<a name="l00478"></a>00478     <span class="comment">//</span>
<a name="l00479"></a>00479     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00480"></a>00480 
<a name="l00481"></a>00481     <span class="comment">//</span>
<a name="l00482"></a>00482     <span class="comment">// If the Full Speed device bit is set, then this is a full speed device.</span>
<a name="l00483"></a>00483     <span class="comment">//</span>
<a name="l00484"></a>00484     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) &amp; <a class="code" href="hw__usb_8h.html#a45dc0abcc59469c9035589b99deab15f">USB_POWER_HSMODE</a>)
<a name="l00485"></a>00485     {
<a name="l00486"></a>00486         <span class="keywordflow">return</span>(<a class="code" href="usb_8h.html#ad2b3e75df582ecec2adfbc4c00406332">USB_HIGH_SPEED</a>);
<a name="l00487"></a>00487     }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <span class="keywordflow">return</span>(<a class="code" href="usb_8h.html#a254b82211d11df3f1649aad174b4cb92">USB_FULL_SPEED</a>);
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="comment">//*****************************************************************************</span>
<a name="l00493"></a>00493 <span class="comment">//</span>
<a name="l00506"></a>00506 <span class="comment"></span><span class="comment">//</span>
<a name="l00507"></a>00507 <span class="comment">//*****************************************************************************</span>
<a name="l00508"></a>00508 <span class="keywordtype">void</span>
<a name="l00509"></a><a class="code" href="group__usb__api.html#gace8dc370774ff8b09997378277e13041">00509</a> <a class="code" href="group__usb__api.html#gace8dc370774ff8b09997378277e13041">USBIntDisableControl</a>(uint32_t ui32Base, uint32_t ui32Flags)
<a name="l00510"></a>00510 {
<a name="l00511"></a>00511     <span class="comment">//</span>
<a name="l00512"></a>00512     <span class="comment">// Check the arguments.</span>
<a name="l00513"></a>00513     <span class="comment">//</span>
<a name="l00514"></a>00514     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00515"></a>00515     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Flags &amp; ~(<a class="code" href="usb_8h.html#ac00638d8e979e9df899209cef06473e3">USB_INTCTRL_ALL</a>)) == 0);
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="comment">//</span>
<a name="l00518"></a>00518     <span class="comment">// If any general interrupts were disabled then write the general interrupt</span>
<a name="l00519"></a>00519     <span class="comment">// settings out to the hardware.</span>
<a name="l00520"></a>00520     <span class="comment">//</span>
<a name="l00521"></a>00521     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a10b42c43898a73234ef89aab9eb4a902">USB_INTCTRL_STATUS</a>)
<a name="l00522"></a>00522     {
<a name="l00523"></a>00523         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae48b2643a2ba39329cf2ea7597a1f0b8">USB_O_IE</a>) &amp;= ~(ui32Flags &amp; <a class="code" href="usb_8h.html#a10b42c43898a73234ef89aab9eb4a902">USB_INTCTRL_STATUS</a>);
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="comment">//</span>
<a name="l00527"></a>00527     <span class="comment">// Disable the power fault interrupt.</span>
<a name="l00528"></a>00528     <span class="comment">//</span>
<a name="l00529"></a>00529     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a4edbd272151cebcecb8d0d2c6028e76e">USB_INTCTRL_POWER_FAULT</a>)
<a name="l00530"></a>00530     {
<a name="l00531"></a>00531         <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#add886d4759c91d33312419329010a612">USB_O_EPCIM</a>) = 0;
<a name="l00532"></a>00532     }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534     <span class="comment">//</span>
<a name="l00535"></a>00535     <span class="comment">// Disable the ID pin detect interrupt.</span>
<a name="l00536"></a>00536     <span class="comment">//</span>
<a name="l00537"></a>00537     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a8b1220edc0a796335fbc71064a5d938b">USB_INTCTRL_MODE_DETECT</a>)
<a name="l00538"></a>00538     {
<a name="l00539"></a>00539         <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a> + <a class="code" href="hw__usb_8h.html#a589aec69350ab5bd24e63c72d14d5289">USB_O_IDVIM</a>) = 0;
<a name="l00540"></a>00540     }
<a name="l00541"></a>00541 }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">//*****************************************************************************</span>
<a name="l00544"></a>00544 <span class="comment">//</span>
<a name="l00557"></a>00557 <span class="comment"></span><span class="comment">//</span>
<a name="l00558"></a>00558 <span class="comment">//*****************************************************************************</span>
<a name="l00559"></a>00559 <span class="keywordtype">void</span>
<a name="l00560"></a><a class="code" href="group__usb__api.html#ga1d07b07b2ca977373308380f92c6747f">00560</a> <a class="code" href="group__usb__api.html#ga1d07b07b2ca977373308380f92c6747f">USBIntEnableControl</a>(uint32_t ui32Base, uint32_t ui32Flags)
<a name="l00561"></a>00561 {
<a name="l00562"></a>00562     <span class="comment">//</span>
<a name="l00563"></a>00563     <span class="comment">// Check the arguments.</span>
<a name="l00564"></a>00564     <span class="comment">//</span>
<a name="l00565"></a>00565     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00566"></a>00566     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Flags &amp; (~<a class="code" href="usb_8h.html#ac00638d8e979e9df899209cef06473e3">USB_INTCTRL_ALL</a>)) == 0);
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="comment">//</span>
<a name="l00569"></a>00569     <span class="comment">// If any general interrupts were enabled, then write the general</span>
<a name="l00570"></a>00570     <span class="comment">// interrupt settings out to the hardware.</span>
<a name="l00571"></a>00571     <span class="comment">//</span>
<a name="l00572"></a>00572     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a10b42c43898a73234ef89aab9eb4a902">USB_INTCTRL_STATUS</a>)
<a name="l00573"></a>00573     {
<a name="l00574"></a>00574         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae48b2643a2ba39329cf2ea7597a1f0b8">USB_O_IE</a>) |= ui32Flags;
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576 
<a name="l00577"></a>00577     <span class="comment">//</span>
<a name="l00578"></a>00578     <span class="comment">// Enable the power fault interrupt.</span>
<a name="l00579"></a>00579     <span class="comment">//</span>
<a name="l00580"></a>00580     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a4edbd272151cebcecb8d0d2c6028e76e">USB_INTCTRL_POWER_FAULT</a>)
<a name="l00581"></a>00581     {
<a name="l00582"></a>00582         <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#add886d4759c91d33312419329010a612">USB_O_EPCIM</a>) = <a class="code" href="hw__usb_8h.html#ab0ba01a76c0f169310fb2819bb537220">USB_EPCIM_PF</a>;
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584 
<a name="l00585"></a>00585     <span class="comment">//</span>
<a name="l00586"></a>00586     <span class="comment">// Enable the ID pin detect interrupt.</span>
<a name="l00587"></a>00587     <span class="comment">//</span>
<a name="l00588"></a>00588     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a8b1220edc0a796335fbc71064a5d938b">USB_INTCTRL_MODE_DETECT</a>)
<a name="l00589"></a>00589     {
<a name="l00590"></a>00590         <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a> + <a class="code" href="hw__usb_8h.html#a589aec69350ab5bd24e63c72d14d5289">USB_O_IDVIM</a>) = <a class="code" href="hw__usb_8h.html#a9fd4d419cfbb95ce3358f6d1430efb85">USB_IDVIM_ID</a>;
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592 }
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 <span class="comment">//*****************************************************************************</span>
<a name="l00595"></a>00595 <span class="comment">//</span>
<a name="l00632"></a>00632 <span class="comment"></span><span class="comment">//</span>
<a name="l00633"></a>00633 <span class="comment">//*****************************************************************************</span>
<a name="l00634"></a>00634 uint32_t
<a name="l00635"></a><a class="code" href="group__usb__api.html#gaeb586119918265fd5f02fc7574549547">00635</a> <a class="code" href="group__usb__api.html#gaeb586119918265fd5f02fc7574549547">USBIntStatusControl</a>(uint32_t ui32Base)
<a name="l00636"></a>00636 {
<a name="l00637"></a>00637     uint32_t ui32Status;
<a name="l00638"></a>00638 
<a name="l00639"></a>00639     <span class="comment">//</span>
<a name="l00640"></a>00640     <span class="comment">// Check the arguments.</span>
<a name="l00641"></a>00641     <span class="comment">//</span>
<a name="l00642"></a>00642     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00643"></a>00643 
<a name="l00644"></a>00644     <span class="comment">//</span>
<a name="l00645"></a>00645     <span class="comment">// Get the general interrupt status, these bits go into the upper 8 bits</span>
<a name="l00646"></a>00646     <span class="comment">// of the returned value.</span>
<a name="l00647"></a>00647     <span class="comment">//</span>
<a name="l00648"></a>00648     ui32Status = <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad57c612b75b42aad9d15aec00787bced">USB_O_IS</a>);
<a name="l00649"></a>00649 
<a name="l00650"></a>00650     <span class="comment">//</span>
<a name="l00651"></a>00651     <span class="comment">// Add the power fault status.</span>
<a name="l00652"></a>00652     <span class="comment">//</span>
<a name="l00653"></a>00653     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aec3e74ccce3b4e9e38c589a51614cc0e">USB_O_EPCISC</a>) &amp; <a class="code" href="hw__usb_8h.html#ac9f92c4601e8eb60b53d62c468794c50">USB_EPCISC_PF</a>)
<a name="l00654"></a>00654     {
<a name="l00655"></a>00655         <span class="comment">//</span>
<a name="l00656"></a>00656         <span class="comment">// Indicate a power fault was detected.</span>
<a name="l00657"></a>00657         <span class="comment">//</span>
<a name="l00658"></a>00658         ui32Status |= <a class="code" href="usb_8h.html#a4edbd272151cebcecb8d0d2c6028e76e">USB_INTCTRL_POWER_FAULT</a>;
<a name="l00659"></a>00659 
<a name="l00660"></a>00660         <span class="comment">//</span>
<a name="l00661"></a>00661         <span class="comment">// Clear the power fault interrupt.</span>
<a name="l00662"></a>00662         <span class="comment">//</span>
<a name="l00663"></a>00663         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aec3e74ccce3b4e9e38c589a51614cc0e">USB_O_EPCISC</a>) |= <a class="code" href="hw__usb_8h.html#ac9f92c4601e8eb60b53d62c468794c50">USB_EPCISC_PF</a>;
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a> + <a class="code" href="hw__usb_8h.html#aab05d86db4358f683ff54c6b34ec0171">USB_O_IDVISC</a>) &amp; <a class="code" href="hw__usb_8h.html#a64349596181f53d571a3387efbce8e21">USB_IDVRIS_ID</a>)
<a name="l00667"></a>00667     {
<a name="l00668"></a>00668         <span class="comment">//</span>
<a name="l00669"></a>00669         <span class="comment">// Indicate an id detection.</span>
<a name="l00670"></a>00670         <span class="comment">//</span>
<a name="l00671"></a>00671         ui32Status |= <a class="code" href="usb_8h.html#a8b1220edc0a796335fbc71064a5d938b">USB_INTCTRL_MODE_DETECT</a>;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673         <span class="comment">//</span>
<a name="l00674"></a>00674         <span class="comment">// Clear the id detection interrupt.</span>
<a name="l00675"></a>00675         <span class="comment">//</span>
<a name="l00676"></a>00676         <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a> + <a class="code" href="hw__usb_8h.html#aab05d86db4358f683ff54c6b34ec0171">USB_O_IDVISC</a>) |= <a class="code" href="hw__usb_8h.html#a64349596181f53d571a3387efbce8e21">USB_IDVRIS_ID</a>;
<a name="l00677"></a>00677     }
<a name="l00678"></a>00678 
<a name="l00679"></a>00679     <span class="comment">//</span>
<a name="l00680"></a>00680     <span class="comment">// Return the combined interrupt status.</span>
<a name="l00681"></a>00681     <span class="comment">//</span>
<a name="l00682"></a>00682     <span class="keywordflow">return</span>(ui32Status);
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 <span class="comment">//*****************************************************************************</span>
<a name="l00686"></a>00686 <span class="comment">//</span>
<a name="l00699"></a>00699 <span class="comment"></span><span class="comment">//</span>
<a name="l00700"></a>00700 <span class="comment">//*****************************************************************************</span>
<a name="l00701"></a>00701 <span class="keywordtype">void</span>
<a name="l00702"></a><a class="code" href="group__usb__api.html#ga426a977426ab190b6bb5b0938eb73976">00702</a> <a class="code" href="group__usb__api.html#ga426a977426ab190b6bb5b0938eb73976">USBIntDisableEndpoint</a>(uint32_t ui32Base, uint32_t ui32Flags)
<a name="l00703"></a>00703 {
<a name="l00704"></a>00704     <span class="comment">//</span>
<a name="l00705"></a>00705     <span class="comment">// Check the arguments.</span>
<a name="l00706"></a>00706     <span class="comment">//</span>
<a name="l00707"></a>00707     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00708"></a>00708 
<a name="l00709"></a>00709     <span class="comment">//</span>
<a name="l00710"></a>00710     <span class="comment">// If any transmit interrupts were disabled, then write the transmit</span>
<a name="l00711"></a>00711     <span class="comment">// interrupt settings out to the hardware.</span>
<a name="l00712"></a>00712     <span class="comment">//</span>
<a name="l00713"></a>00713     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a124817ef8175986c7d64ce5702bf32bd">USB_O_TXIE</a>) &amp;=
<a name="l00714"></a>00714         ~(ui32Flags &amp; (<a class="code" href="usb_8h.html#ad040b23d93cfeb73448c4ae711f76610">USB_INTEP_HOST_OUT</a> | <a class="code" href="usb_8h.html#afca3aba661b7c1b662d0bfd5a367d84d">USB_INTEP_DEV_IN</a> | <a class="code" href="usb_8h.html#adb08df3018212f3804d08533f90be74f">USB_INTEP_0</a>));
<a name="l00715"></a>00715 
<a name="l00716"></a>00716     <span class="comment">//</span>
<a name="l00717"></a>00717     <span class="comment">// If any receive interrupts were disabled, then write the receive</span>
<a name="l00718"></a>00718     <span class="comment">// interrupt settings out to the hardware.</span>
<a name="l00719"></a>00719     <span class="comment">//</span>
<a name="l00720"></a>00720     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aac98c8b069ecf1600f3e62b0082de154">USB_O_RXIE</a>) &amp;=
<a name="l00721"></a>00721         ~((ui32Flags &amp; (<a class="code" href="usb_8h.html#ac59c2432d90938342fc91d7995cf64ab">USB_INTEP_HOST_IN</a> | <a class="code" href="usb_8h.html#a832eef4e62748988e7e149ecfcaa20cb">USB_INTEP_DEV_OUT</a>)) &gt;&gt;
<a name="l00722"></a>00722           <a class="code" href="group__usb__api.html#ga30003dae047f43963cd6ba85ae6f0689">USB_INTEP_RX_SHIFT</a>);
<a name="l00723"></a>00723 }
<a name="l00724"></a>00724 
<a name="l00725"></a>00725 <span class="comment">//*****************************************************************************</span>
<a name="l00726"></a>00726 <span class="comment">//</span>
<a name="l00739"></a>00739 <span class="comment"></span><span class="comment">//</span>
<a name="l00740"></a>00740 <span class="comment">//*****************************************************************************</span>
<a name="l00741"></a>00741 <span class="keywordtype">void</span>
<a name="l00742"></a><a class="code" href="group__usb__api.html#ga37a65b0b311de6869aeba2b25f7c4c29">00742</a> <a class="code" href="group__usb__api.html#ga37a65b0b311de6869aeba2b25f7c4c29">USBIntEnableEndpoint</a>(uint32_t ui32Base, uint32_t ui32Flags)
<a name="l00743"></a>00743 {
<a name="l00744"></a>00744     <span class="comment">//</span>
<a name="l00745"></a>00745     <span class="comment">// Check the arguments.</span>
<a name="l00746"></a>00746     <span class="comment">//</span>
<a name="l00747"></a>00747     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00748"></a>00748 
<a name="l00749"></a>00749     <span class="comment">//</span>
<a name="l00750"></a>00750     <span class="comment">// Enable any transmit endpoint interrupts.</span>
<a name="l00751"></a>00751     <span class="comment">//</span>
<a name="l00752"></a>00752     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a124817ef8175986c7d64ce5702bf32bd">USB_O_TXIE</a>) |=
<a name="l00753"></a>00753         ui32Flags &amp; (<a class="code" href="usb_8h.html#ad040b23d93cfeb73448c4ae711f76610">USB_INTEP_HOST_OUT</a> | <a class="code" href="usb_8h.html#afca3aba661b7c1b662d0bfd5a367d84d">USB_INTEP_DEV_IN</a> | <a class="code" href="usb_8h.html#adb08df3018212f3804d08533f90be74f">USB_INTEP_0</a>);
<a name="l00754"></a>00754 
<a name="l00755"></a>00755     <span class="comment">//</span>
<a name="l00756"></a>00756     <span class="comment">// Enable any receive endpoint interrupts.</span>
<a name="l00757"></a>00757     <span class="comment">//</span>
<a name="l00758"></a>00758     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aac98c8b069ecf1600f3e62b0082de154">USB_O_RXIE</a>) |=
<a name="l00759"></a>00759         ((ui32Flags &amp; (<a class="code" href="usb_8h.html#ac59c2432d90938342fc91d7995cf64ab">USB_INTEP_HOST_IN</a> | <a class="code" href="usb_8h.html#a832eef4e62748988e7e149ecfcaa20cb">USB_INTEP_DEV_OUT</a>)) &gt;&gt;
<a name="l00760"></a>00760          <a class="code" href="group__usb__api.html#ga30003dae047f43963cd6ba85ae6f0689">USB_INTEP_RX_SHIFT</a>);
<a name="l00761"></a>00761 }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="comment">//*****************************************************************************</span>
<a name="l00764"></a>00764 <span class="comment">//</span>
<a name="l00780"></a>00780 <span class="comment"></span><span class="comment">//</span>
<a name="l00781"></a>00781 <span class="comment">//*****************************************************************************</span>
<a name="l00782"></a>00782 uint32_t
<a name="l00783"></a><a class="code" href="group__usb__api.html#gadff57e2a9e63a8be23c935de236477e1">00783</a> <a class="code" href="group__usb__api.html#gadff57e2a9e63a8be23c935de236477e1">USBIntStatusEndpoint</a>(uint32_t ui32Base)
<a name="l00784"></a>00784 {
<a name="l00785"></a>00785     uint32_t ui32Status;
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="comment">//</span>
<a name="l00788"></a>00788     <span class="comment">// Check the arguments.</span>
<a name="l00789"></a>00789     <span class="comment">//</span>
<a name="l00790"></a>00790     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <span class="comment">//</span>
<a name="l00793"></a>00793     <span class="comment">// Get the transmit interrupt status.</span>
<a name="l00794"></a>00794     <span class="comment">//</span>
<a name="l00795"></a>00795     ui32Status = <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a14fce45c175e0d914b9bc3701e12ca72">USB_O_TXIS</a>);
<a name="l00796"></a>00796     ui32Status |= (<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a9069bfcd4c703ece1f664196a0ad924f">USB_O_RXIS</a>) &lt;&lt; <a class="code" href="group__usb__api.html#ga30003dae047f43963cd6ba85ae6f0689">USB_INTEP_RX_SHIFT</a>);
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="comment">//</span>
<a name="l00799"></a>00799     <span class="comment">// Return the combined interrupt status.</span>
<a name="l00800"></a>00800     <span class="comment">//</span>
<a name="l00801"></a>00801     <span class="keywordflow">return</span>(ui32Status);
<a name="l00802"></a>00802 }
<a name="l00803"></a>00803 
<a name="l00804"></a>00804 <span class="comment">//*****************************************************************************</span>
<a name="l00805"></a>00805 <span class="comment">//</span>
<a name="l00815"></a>00815 <span class="comment"></span><span class="comment">//</span>
<a name="l00816"></a>00816 <span class="comment">//*****************************************************************************</span>
<a name="l00817"></a>00817 <span class="keyword">static</span> uint32_t
<a name="l00818"></a><a class="code" href="group__usb__api.html#gac630e5bea6974c6d98f789ccc05d2559">00818</a> <a class="code" href="group__usb__api.html#gac630e5bea6974c6d98f789ccc05d2559">_USBIntNumberGet</a>(uint32_t ui32Base)
<a name="l00819"></a>00819 {
<a name="l00820"></a>00820     uint32_t ui32Int;
<a name="l00821"></a>00821 
<a name="l00822"></a>00822     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#aed400510c15509bdc6296e5c233f6cd3">CLASS_IS_TM4C123</a>)
<a name="l00823"></a>00823     {
<a name="l00824"></a>00824         ui32Int = <a class="code" href="hw__ints_8h.html#a6e84b84a1f9d783ca3a2ea6a1dbde0ac">INT_USB0_TM4C123</a>;
<a name="l00825"></a>00825     }
<a name="l00826"></a>00826     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#ad585839948168b2f3b39c3dbf2cbe200">CLASS_IS_TM4C129</a>)
<a name="l00827"></a>00827     {
<a name="l00828"></a>00828         ui32Int = <a class="code" href="hw__ints_8h.html#a1148accad75ad2ce2cf9112a45df42f2">INT_USB0_TM4C129</a>;
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830     <span class="keywordflow">else</span>
<a name="l00831"></a>00831     {
<a name="l00832"></a>00832         ui32Int = 0;
<a name="l00833"></a>00833     }
<a name="l00834"></a>00834     <span class="keywordflow">return</span>(ui32Int);
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 <span class="comment">//*****************************************************************************</span>
<a name="l00838"></a>00838 <span class="comment">//</span>
<a name="l00856"></a>00856 <span class="comment"></span><span class="comment">//</span>
<a name="l00857"></a>00857 <span class="comment">//*****************************************************************************</span>
<a name="l00858"></a>00858 <span class="keywordtype">void</span>
<a name="l00859"></a><a class="code" href="group__usb__api.html#gaa8a3b5d7dd0c767873b1d42a5b40aa67">00859</a> <a class="code" href="group__usb__api.html#gaa8a3b5d7dd0c767873b1d42a5b40aa67">USBIntRegister</a>(uint32_t ui32Base, <span class="keywordtype">void</span> (*pfnHandler)(<span class="keywordtype">void</span>))
<a name="l00860"></a>00860 {
<a name="l00861"></a>00861     uint32_t ui32Int;
<a name="l00862"></a>00862 
<a name="l00863"></a>00863     <span class="comment">//</span>
<a name="l00864"></a>00864     <span class="comment">// Check the arguments.</span>
<a name="l00865"></a>00865     <span class="comment">//</span>
<a name="l00866"></a>00866     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00867"></a>00867 
<a name="l00868"></a>00868     ui32Int = <a class="code" href="group__usb__api.html#gac630e5bea6974c6d98f789ccc05d2559">_USBIntNumberGet</a>(ui32Base);
<a name="l00869"></a>00869 
<a name="l00870"></a>00870     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Int != 0);
<a name="l00871"></a>00871 
<a name="l00872"></a>00872     <span class="comment">//</span>
<a name="l00873"></a>00873     <span class="comment">// Register the interrupt handler.</span>
<a name="l00874"></a>00874     <span class="comment">//</span>
<a name="l00875"></a>00875     <a class="code" href="group__interrupt__api.html#ga0a32aafea7f4904d2a64ee18b45f96c9">IntRegister</a>(ui32Int, pfnHandler);
<a name="l00876"></a>00876 
<a name="l00877"></a>00877     <span class="comment">//</span>
<a name="l00878"></a>00878     <span class="comment">// Enable the USB interrupt.</span>
<a name="l00879"></a>00879     <span class="comment">//</span>
<a name="l00880"></a>00880     <a class="code" href="group__interrupt__api.html#ga49fc9c3d1a0f8c42a20249f8c5d360ce">IntEnable</a>(ui32Int);
<a name="l00881"></a>00881 }
<a name="l00882"></a>00882 
<a name="l00883"></a>00883 <span class="comment">//*****************************************************************************</span>
<a name="l00884"></a>00884 <span class="comment">//</span>
<a name="l00896"></a>00896 <span class="comment"></span><span class="comment">//</span>
<a name="l00897"></a>00897 <span class="comment">//*****************************************************************************</span>
<a name="l00898"></a>00898 <span class="keywordtype">void</span>
<a name="l00899"></a><a class="code" href="group__usb__api.html#ga52446b27aa21e19ab5e81b552f50eb92">00899</a> <a class="code" href="group__usb__api.html#ga52446b27aa21e19ab5e81b552f50eb92">USBIntUnregister</a>(uint32_t ui32Base)
<a name="l00900"></a>00900 {
<a name="l00901"></a>00901     uint32_t ui32Int;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903     <span class="comment">//</span>
<a name="l00904"></a>00904     <span class="comment">// Check the arguments.</span>
<a name="l00905"></a>00905     <span class="comment">//</span>
<a name="l00906"></a>00906     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l00907"></a>00907 
<a name="l00908"></a>00908     ui32Int = <a class="code" href="group__usb__api.html#gac630e5bea6974c6d98f789ccc05d2559">_USBIntNumberGet</a>(ui32Base);
<a name="l00909"></a>00909 
<a name="l00910"></a>00910     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Int != 0);
<a name="l00911"></a>00911 
<a name="l00912"></a>00912     <span class="comment">//</span>
<a name="l00913"></a>00913     <span class="comment">// Disable the USB interrupt.</span>
<a name="l00914"></a>00914     <span class="comment">//</span>
<a name="l00915"></a>00915     <a class="code" href="group__interrupt__api.html#ga9af6b00884dc44e92b3d05ff821b5334">IntDisable</a>(ui32Int);
<a name="l00916"></a>00916 
<a name="l00917"></a>00917     <span class="comment">//</span>
<a name="l00918"></a>00918     <span class="comment">// Unregister the interrupt handler.</span>
<a name="l00919"></a>00919     <span class="comment">//</span>
<a name="l00920"></a>00920     <a class="code" href="group__interrupt__api.html#ga5dffc81c27c005f83e9bfc30f775982a">IntUnregister</a>(ui32Int);
<a name="l00921"></a>00921 }
<a name="l00922"></a>00922 
<a name="l00923"></a>00923 <span class="comment">//*****************************************************************************</span>
<a name="l00924"></a>00924 <span class="comment">//</span>
<a name="l00991"></a>00991 <span class="comment"></span><span class="comment">//</span>
<a name="l00992"></a>00992 <span class="comment">//*****************************************************************************</span>
<a name="l00993"></a>00993 uint32_t
<a name="l00994"></a><a class="code" href="group__usb__api.html#ga2320e3a284b3b809d6dab77def7dfe49">00994</a> <a class="code" href="group__usb__api.html#ga2320e3a284b3b809d6dab77def7dfe49">USBEndpointStatus</a>(uint32_t ui32Base, uint32_t ui32Endpoint)
<a name="l00995"></a>00995 {
<a name="l00996"></a>00996     uint32_t ui32Status;
<a name="l00997"></a>00997 
<a name="l00998"></a>00998     <span class="comment">//</span>
<a name="l00999"></a>00999     <span class="comment">// Check the arguments.</span>
<a name="l01000"></a>01000     <span class="comment">//</span>
<a name="l01001"></a>01001     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01002"></a>01002     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01003"></a>01003            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01004"></a>01004            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01005"></a>01005            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01006"></a>01006 
<a name="l01007"></a>01007     <span class="comment">//</span>
<a name="l01008"></a>01008     <span class="comment">// Get the TX portion of the endpoint status.</span>
<a name="l01009"></a>01009     <span class="comment">//</span>
<a name="l01010"></a>01010     ui32Status = <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a>);
<a name="l01011"></a>01011 
<a name="l01012"></a>01012     <span class="comment">//</span>
<a name="l01013"></a>01013     <span class="comment">// Get the RX portion of the endpoint status.</span>
<a name="l01014"></a>01014     <span class="comment">//</span>
<a name="l01015"></a>01015     ui32Status |=
<a name="l01016"></a>01016         ((<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a>)) &lt;&lt;
<a name="l01017"></a>01017          <a class="code" href="group__usb__api.html#ga20ceb718c0b5bea3d8b0a8d89919160c">USB_RX_EPSTATUS_SHIFT</a>);
<a name="l01018"></a>01018 
<a name="l01019"></a>01019     <span class="comment">//</span>
<a name="l01020"></a>01020     <span class="comment">// Return the endpoint status.</span>
<a name="l01021"></a>01021     <span class="comment">//</span>
<a name="l01022"></a>01022     <span class="keywordflow">return</span>(ui32Status);
<a name="l01023"></a>01023 }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025 <span class="comment">//*****************************************************************************</span>
<a name="l01026"></a>01026 <span class="comment">//</span>
<a name="l01040"></a>01040 <span class="comment"></span><span class="comment">//</span>
<a name="l01041"></a>01041 <span class="comment">//*****************************************************************************</span>
<a name="l01042"></a>01042 <span class="keywordtype">void</span>
<a name="l01043"></a><a class="code" href="group__usb__api.html#gaa6c7268ab8985502d6db54c2773614e3">01043</a> <a class="code" href="group__usb__api.html#gaa6c7268ab8985502d6db54c2773614e3">USBHostEndpointStatusClear</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01044"></a>01044                            uint32_t ui32Flags)
<a name="l01045"></a>01045 {
<a name="l01046"></a>01046     <span class="comment">//</span>
<a name="l01047"></a>01047     <span class="comment">// Check the arguments.</span>
<a name="l01048"></a>01048     <span class="comment">//</span>
<a name="l01049"></a>01049     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01050"></a>01050     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01051"></a>01051            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01052"></a>01052            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01053"></a>01053            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01054"></a>01054 
<a name="l01055"></a>01055     <span class="comment">//</span>
<a name="l01056"></a>01056     <span class="comment">// Clear the specified flags for the endpoint.</span>
<a name="l01057"></a>01057     <span class="comment">//</span>
<a name="l01058"></a>01058     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01059"></a>01059     {
<a name="l01060"></a>01060         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) &amp;= ~ui32Flags;
<a name="l01061"></a>01061     }
<a name="l01062"></a>01062     <span class="keywordflow">else</span>
<a name="l01063"></a>01063     {
<a name="l01064"></a>01064         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l01065"></a>01065             ~ui32Flags;
<a name="l01066"></a>01066         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l01067"></a>01067             ~(ui32Flags &gt;&gt; <a class="code" href="group__usb__api.html#ga20ceb718c0b5bea3d8b0a8d89919160c">USB_RX_EPSTATUS_SHIFT</a>);
<a name="l01068"></a>01068     }
<a name="l01069"></a>01069 }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071 <span class="comment">//*****************************************************************************</span>
<a name="l01072"></a>01072 <span class="comment">//</span>
<a name="l01086"></a>01086 <span class="comment"></span><span class="comment">//</span>
<a name="l01087"></a>01087 <span class="comment">//*****************************************************************************</span>
<a name="l01088"></a>01088 <span class="keywordtype">void</span>
<a name="l01089"></a><a class="code" href="group__usb__api.html#ga86b9ed2def63c841765968898d6e19e8">01089</a> <a class="code" href="group__usb__api.html#ga86b9ed2def63c841765968898d6e19e8">USBDevEndpointStatusClear</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01090"></a>01090                           uint32_t ui32Flags)
<a name="l01091"></a>01091 {
<a name="l01092"></a>01092     <span class="comment">//</span>
<a name="l01093"></a>01093     <span class="comment">// Check the arguments.</span>
<a name="l01094"></a>01094     <span class="comment">//</span>
<a name="l01095"></a>01095     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01096"></a>01096     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01097"></a>01097            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01098"></a>01098            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01099"></a>01099            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01100"></a>01100 
<a name="l01101"></a>01101     <span class="comment">//</span>
<a name="l01102"></a>01102     <span class="comment">// If this is endpoint 0, then the bits have different meaning and map</span>
<a name="l01103"></a>01103     <span class="comment">// into the TX memory location.</span>
<a name="l01104"></a>01104     <span class="comment">//</span>
<a name="l01105"></a>01105     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01106"></a>01106     {
<a name="l01107"></a>01107         <span class="comment">//</span>
<a name="l01108"></a>01108         <span class="comment">// Set the Serviced RxPktRdy bit to clear the RxPktRdy.</span>
<a name="l01109"></a>01109         <span class="comment">//</span>
<a name="l01110"></a>01110         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ac8686c0b97db7be8a1a42106850fda5c">USB_DEV_EP0_OUT_PKTRDY</a>)
<a name="l01111"></a>01111         {
<a name="l01112"></a>01112             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) |= <a class="code" href="hw__usb_8h.html#a48e2f3edca2d034139b6ee968e041d34">USB_CSRL0_RXRDYC</a>;
<a name="l01113"></a>01113         }
<a name="l01114"></a>01114 
<a name="l01115"></a>01115         <span class="comment">//</span>
<a name="l01116"></a>01116         <span class="comment">// Set the serviced Setup End bit to clear the SetupEnd status.</span>
<a name="l01117"></a>01117         <span class="comment">//</span>
<a name="l01118"></a>01118         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a14f6bf821887a22781416142ab18f6a9">USB_DEV_EP0_SETUP_END</a>)
<a name="l01119"></a>01119         {
<a name="l01120"></a>01120             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) |= <a class="code" href="hw__usb_8h.html#af99ad022830386b6eeec1668cf509228">USB_CSRL0_SETENDC</a>;
<a name="l01121"></a>01121         }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123         <span class="comment">//</span>
<a name="l01124"></a>01124         <span class="comment">// Clear the Sent Stall status flag.</span>
<a name="l01125"></a>01125         <span class="comment">//</span>
<a name="l01126"></a>01126         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ad6435c446f97fc6d7f8f185cb9359815">USB_DEV_EP0_SENT_STALL</a>)
<a name="l01127"></a>01127         {
<a name="l01128"></a>01128             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) &amp;= ~(<a class="code" href="usb_8h.html#ad6435c446f97fc6d7f8f185cb9359815">USB_DEV_EP0_SENT_STALL</a>);
<a name="l01129"></a>01129         }
<a name="l01130"></a>01130     }
<a name="l01131"></a>01131     <span class="keywordflow">else</span>
<a name="l01132"></a>01132     {
<a name="l01133"></a>01133         <span class="comment">//</span>
<a name="l01134"></a>01134         <span class="comment">// Clear out any TX flags that were passed in.  Only</span>
<a name="l01135"></a>01135         <span class="comment">// USB_DEV_TX_SENT_STALL and USB_DEV_TX_UNDERRUN must be cleared.</span>
<a name="l01136"></a>01136         <span class="comment">//</span>
<a name="l01137"></a>01137         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l01138"></a>01138             ~(ui32Flags &amp; (<a class="code" href="usb_8h.html#aeaae19cabdb49ea44a6b3dfec1fd2e7a">USB_DEV_TX_SENT_STALL</a> | <a class="code" href="usb_8h.html#a38a7843e4a4ed633b63edefd20f3ac20">USB_DEV_TX_UNDERRUN</a>));
<a name="l01139"></a>01139 
<a name="l01140"></a>01140         <span class="comment">//</span>
<a name="l01141"></a>01141         <span class="comment">// Clear out valid RX flags that were passed in.  Only</span>
<a name="l01142"></a>01142         <span class="comment">// USB_DEV_RX_SENT_STALL, USB_DEV_RX_DATA_ERROR, and USB_DEV_RX_OVERRUN</span>
<a name="l01143"></a>01143         <span class="comment">// must be cleared.</span>
<a name="l01144"></a>01144         <span class="comment">//</span>
<a name="l01145"></a>01145         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l01146"></a>01146             ~((ui32Flags &amp; (<a class="code" href="usb_8h.html#a54af244515656b7eb8c329c69e709e81">USB_DEV_RX_SENT_STALL</a> | <a class="code" href="usb_8h.html#a9c70d5d386ba2a5fd29917e513f907e5">USB_DEV_RX_DATA_ERROR</a> |
<a name="l01147"></a>01147                             <a class="code" href="usb_8h.html#a60f5018be8c83b0391cc3dd28fad7d93">USB_DEV_RX_OVERRUN</a>)) &gt;&gt; <a class="code" href="group__usb__api.html#ga20ceb718c0b5bea3d8b0a8d89919160c">USB_RX_EPSTATUS_SHIFT</a>);
<a name="l01148"></a>01148     }
<a name="l01149"></a>01149 }
<a name="l01150"></a>01150 
<a name="l01151"></a>01151 <span class="comment">//*****************************************************************************</span>
<a name="l01152"></a>01152 <span class="comment">//</span>
<a name="l01170"></a>01170 <span class="comment"></span><span class="comment">//</span>
<a name="l01171"></a>01171 <span class="comment">//*****************************************************************************</span>
<a name="l01172"></a>01172 <span class="keywordtype">void</span>
<a name="l01173"></a><a class="code" href="group__usb__api.html#gae8dcd09dc4a8d5485ca668a10ae206bf">01173</a> <a class="code" href="group__usb__api.html#gae8dcd09dc4a8d5485ca668a10ae206bf">USBHostEndpointDataToggle</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01174"></a>01174                           <span class="keywordtype">bool</span> bDataToggle, uint32_t ui32Flags)
<a name="l01175"></a>01175 {
<a name="l01176"></a>01176     uint32_t ui32DataToggle;
<a name="l01177"></a>01177 
<a name="l01178"></a>01178     <span class="comment">//</span>
<a name="l01179"></a>01179     <span class="comment">// Check the arguments.</span>
<a name="l01180"></a>01180     <span class="comment">//</span>
<a name="l01181"></a>01181     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01182"></a>01182     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01183"></a>01183            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01184"></a>01184            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01185"></a>01185            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01186"></a>01186 
<a name="l01187"></a>01187     <span class="comment">//</span>
<a name="l01188"></a>01188     <span class="comment">// The data toggle defaults to DATA0.</span>
<a name="l01189"></a>01189     <span class="comment">//</span>
<a name="l01190"></a>01190     ui32DataToggle = 0;
<a name="l01191"></a>01191 
<a name="l01192"></a>01192     <span class="comment">//</span>
<a name="l01193"></a>01193     <span class="comment">// See if the data toggle must be set to DATA1.</span>
<a name="l01194"></a>01194     <span class="comment">//</span>
<a name="l01195"></a>01195     <span class="keywordflow">if</span>(bDataToggle)
<a name="l01196"></a>01196     {
<a name="l01197"></a>01197         <span class="comment">//</span>
<a name="l01198"></a>01198         <span class="comment">// Select the data toggle bit based on the endpoint.</span>
<a name="l01199"></a>01199         <span class="comment">//</span>
<a name="l01200"></a>01200         <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01201"></a>01201         {
<a name="l01202"></a>01202             ui32DataToggle = <a class="code" href="hw__usb_8h.html#a53d350895f5d8cf5e6010bdf8c105bb4">USB_CSRH0_DT</a>;
<a name="l01203"></a>01203         }
<a name="l01204"></a>01204         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags == <a class="code" href="usb_8h.html#a7043469050377562ecd8e46924e150a0">USB_EP_HOST_IN</a>)
<a name="l01205"></a>01205         {
<a name="l01206"></a>01206             ui32DataToggle = <a class="code" href="hw__usb_8h.html#a5955eb93ff853fd246ec9eabd08ec50e">USB_RXCSRH1_DT</a>;
<a name="l01207"></a>01207         }
<a name="l01208"></a>01208         <span class="keywordflow">else</span>
<a name="l01209"></a>01209         {
<a name="l01210"></a>01210             ui32DataToggle = <a class="code" href="hw__usb_8h.html#a1fd2de9ccb64b357ad1827970dc32779">USB_TXCSRH1_DT</a>;
<a name="l01211"></a>01211         }
<a name="l01212"></a>01212     }
<a name="l01213"></a>01213 
<a name="l01214"></a>01214     <span class="comment">//</span>
<a name="l01215"></a>01215     <span class="comment">// Set the data toggle based on the endpoint.</span>
<a name="l01216"></a>01216     <span class="comment">//</span>
<a name="l01217"></a>01217     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01218"></a>01218     {
<a name="l01219"></a>01219         <span class="comment">//</span>
<a name="l01220"></a>01220         <span class="comment">// Set the write enable and the bit value for endpoint zero.</span>
<a name="l01221"></a>01221         <span class="comment">//</span>
<a name="l01222"></a>01222         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a49559efd3060e084e68662a070eed5c2">USB_O_CSRH0</a>) =
<a name="l01223"></a>01223             ((<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a49559efd3060e084e68662a070eed5c2">USB_O_CSRH0</a>) &amp;
<a name="l01224"></a>01224               ~(<a class="code" href="hw__usb_8h.html#a3dfeb869eb77d4235fa81f14e16dcb4f">USB_CSRH0_DTWE</a> | <a class="code" href="hw__usb_8h.html#a53d350895f5d8cf5e6010bdf8c105bb4">USB_CSRH0_DT</a>)) |
<a name="l01225"></a>01225              (ui32DataToggle | <a class="code" href="hw__usb_8h.html#a3dfeb869eb77d4235fa81f14e16dcb4f">USB_CSRH0_DTWE</a>));
<a name="l01226"></a>01226     }
<a name="l01227"></a>01227     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags == <a class="code" href="usb_8h.html#a7043469050377562ecd8e46924e150a0">USB_EP_HOST_IN</a>)
<a name="l01228"></a>01228     {
<a name="l01229"></a>01229         <span class="comment">//</span>
<a name="l01230"></a>01230         <span class="comment">// Set the Write enable and the bit value for an IN endpoint.</span>
<a name="l01231"></a>01231         <span class="comment">//</span>
<a name="l01232"></a>01232         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) =
<a name="l01233"></a>01233             ((<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;
<a name="l01234"></a>01234               ~(<a class="code" href="hw__usb_8h.html#a49a0a2b8744213d777d676496c862838">USB_RXCSRH1_DTWE</a> | <a class="code" href="hw__usb_8h.html#a5955eb93ff853fd246ec9eabd08ec50e">USB_RXCSRH1_DT</a>)) |
<a name="l01235"></a>01235              (ui32DataToggle | <a class="code" href="hw__usb_8h.html#a49a0a2b8744213d777d676496c862838">USB_RXCSRH1_DTWE</a>));
<a name="l01236"></a>01236     }
<a name="l01237"></a>01237     <span class="keywordflow">else</span>
<a name="l01238"></a>01238     {
<a name="l01239"></a>01239         <span class="comment">//</span>
<a name="l01240"></a>01240         <span class="comment">// Set the Write enable and the bit value for an OUT endpoint.</span>
<a name="l01241"></a>01241         <span class="comment">//</span>
<a name="l01242"></a>01242         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) =
<a name="l01243"></a>01243             ((<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;
<a name="l01244"></a>01244               ~(<a class="code" href="hw__usb_8h.html#a11b3d8939e767c6f6a67facfae442c13">USB_TXCSRH1_DTWE</a> | <a class="code" href="hw__usb_8h.html#a1fd2de9ccb64b357ad1827970dc32779">USB_TXCSRH1_DT</a>)) |
<a name="l01245"></a>01245              (ui32DataToggle | <a class="code" href="hw__usb_8h.html#a11b3d8939e767c6f6a67facfae442c13">USB_TXCSRH1_DTWE</a>));
<a name="l01246"></a>01246     }
<a name="l01247"></a>01247 }
<a name="l01248"></a>01248 
<a name="l01249"></a>01249 <span class="comment">//*****************************************************************************</span>
<a name="l01250"></a>01250 <span class="comment">//</span>
<a name="l01265"></a>01265 <span class="comment"></span><span class="comment">//</span>
<a name="l01266"></a>01266 <span class="comment">//*****************************************************************************</span>
<a name="l01267"></a>01267 <span class="keywordtype">void</span>
<a name="l01268"></a><a class="code" href="group__usb__api.html#ga1c823a10fa83951546f0824a4f29fee5">01268</a> <a class="code" href="group__usb__api.html#ga1c823a10fa83951546f0824a4f29fee5">USBEndpointDataToggleClear</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01269"></a>01269                            uint32_t ui32Flags)
<a name="l01270"></a>01270 {
<a name="l01271"></a>01271     <span class="comment">//</span>
<a name="l01272"></a>01272     <span class="comment">// Check the arguments.</span>
<a name="l01273"></a>01273     <span class="comment">//</span>
<a name="l01274"></a>01274     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01275"></a>01275     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) ||
<a name="l01276"></a>01276            (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) ||
<a name="l01277"></a>01277            (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) ||
<a name="l01278"></a>01278            (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01279"></a>01279 
<a name="l01280"></a>01280     <span class="comment">//</span>
<a name="l01281"></a>01281     <span class="comment">// See if the transmit or receive data toggle must be cleared.</span>
<a name="l01282"></a>01282     <span class="comment">//</span>
<a name="l01283"></a>01283     <span class="keywordflow">if</span>(ui32Flags &amp; (<a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a> | <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>))
<a name="l01284"></a>01284     {
<a name="l01285"></a>01285         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l01286"></a>01286             <a class="code" href="hw__usb_8h.html#a70a1b1e35e89f7ef19cf13df87a011bf">USB_TXCSRL1_CLRDT</a>;
<a name="l01287"></a>01287     }
<a name="l01288"></a>01288     <span class="keywordflow">else</span>
<a name="l01289"></a>01289     {
<a name="l01290"></a>01290         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l01291"></a>01291             <a class="code" href="hw__usb_8h.html#aee0bc3c1d82b61a1fabab0e5347f052c">USB_RXCSRL1_CLRDT</a>;
<a name="l01292"></a>01292     }
<a name="l01293"></a>01293 }
<a name="l01294"></a>01294 
<a name="l01295"></a>01295 <span class="comment">//*****************************************************************************</span>
<a name="l01296"></a>01296 <span class="comment">//</span>
<a name="l01325"></a>01325 <span class="comment"></span><span class="comment">//</span>
<a name="l01326"></a>01326 <span class="comment">//*****************************************************************************</span>
<a name="l01327"></a>01327 <span class="keywordtype">void</span>
<a name="l01328"></a><a class="code" href="group__usb__api.html#ga03847418c00f8609f406a753bbc10f12">01328</a> <a class="code" href="group__usb__api.html#ga03847418c00f8609f406a753bbc10f12">USBHostEndpointPing</a>(uint32_t ui32Base, uint32_t ui32Endpoint, <span class="keywordtype">bool</span> bEnable)
<a name="l01329"></a>01329 {
<a name="l01330"></a>01330     <span class="comment">//</span>
<a name="l01331"></a>01331     <span class="comment">// Check the arguments.</span>
<a name="l01332"></a>01332     <span class="comment">//</span>
<a name="l01333"></a>01333     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01334"></a>01334     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>));
<a name="l01335"></a>01335 
<a name="l01336"></a>01336     <span class="comment">//</span>
<a name="l01337"></a>01337     <span class="comment">// Handle the endpoint 0 case separately.</span>
<a name="l01338"></a>01338     <span class="comment">//</span>
<a name="l01339"></a>01339     <span class="keywordflow">if</span>(bEnable)
<a name="l01340"></a>01340     {
<a name="l01341"></a>01341         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(<a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a> + <a class="code" href="hw__usb_8h.html#a49559efd3060e084e68662a070eed5c2">USB_O_CSRH0</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#aedeb8cce253a583a48d0e59283d2767b">USB_CSRH0_DISPING</a>;
<a name="l01342"></a>01342     }
<a name="l01343"></a>01343     <span class="keywordflow">else</span>
<a name="l01344"></a>01344     {
<a name="l01345"></a>01345         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(<a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a> + <a class="code" href="hw__usb_8h.html#a49559efd3060e084e68662a070eed5c2">USB_O_CSRH0</a>) |= <a class="code" href="hw__usb_8h.html#aedeb8cce253a583a48d0e59283d2767b">USB_CSRH0_DISPING</a>;
<a name="l01346"></a>01346     }
<a name="l01347"></a>01347 }
<a name="l01348"></a>01348 
<a name="l01349"></a>01349 <span class="comment">//*****************************************************************************</span>
<a name="l01350"></a>01350 <span class="comment">//</span>
<a name="l01366"></a>01366 <span class="comment"></span><span class="comment">//</span>
<a name="l01367"></a>01367 <span class="comment">//*****************************************************************************</span>
<a name="l01368"></a>01368 <span class="keywordtype">void</span>
<a name="l01369"></a><a class="code" href="group__usb__api.html#ga168e327aa696b75fa46363f5c6e8530e">01369</a> <a class="code" href="group__usb__api.html#ga168e327aa696b75fa46363f5c6e8530e">USBDevEndpointStall</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01370"></a>01370                     uint32_t ui32Flags)
<a name="l01371"></a>01371 {
<a name="l01372"></a>01372     <span class="comment">//</span>
<a name="l01373"></a>01373     <span class="comment">// Check the arguments.</span>
<a name="l01374"></a>01374     <span class="comment">//</span>
<a name="l01375"></a>01375     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01376"></a>01376     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Flags &amp; ~(<a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a> | <a class="code" href="usb_8h.html#a7f1336c270a8ee96a67edef7f124e5ba">USB_EP_DEV_OUT</a>)) == 0);
<a name="l01377"></a>01377     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01378"></a>01378            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01379"></a>01379            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01380"></a>01380            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01381"></a>01381 
<a name="l01382"></a>01382     <span class="comment">//</span>
<a name="l01383"></a>01383     <span class="comment">// Determine how to stall this endpoint.</span>
<a name="l01384"></a>01384     <span class="comment">//</span>
<a name="l01385"></a>01385     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01386"></a>01386     {
<a name="l01387"></a>01387         <span class="comment">//</span>
<a name="l01388"></a>01388         <span class="comment">// Perform a stall on endpoint zero.</span>
<a name="l01389"></a>01389         <span class="comment">//</span>
<a name="l01390"></a>01390         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) |= <a class="code" href="hw__usb_8h.html#ab41d8813224b450b8d5fb8602d7f8362">USB_CSRL0_STALL</a> | <a class="code" href="hw__usb_8h.html#a48e2f3edca2d034139b6ee968e041d34">USB_CSRL0_RXRDYC</a>;
<a name="l01391"></a>01391     }
<a name="l01392"></a>01392     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags == <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>)
<a name="l01393"></a>01393     {
<a name="l01394"></a>01394         <span class="comment">//</span>
<a name="l01395"></a>01395         <span class="comment">// Perform a stall on an IN endpoint.</span>
<a name="l01396"></a>01396         <span class="comment">//</span>
<a name="l01397"></a>01397         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l01398"></a>01398             <a class="code" href="hw__usb_8h.html#a37d6d15e1848c4aef25049a3dc9e09d2">USB_TXCSRL1_STALL</a>;
<a name="l01399"></a>01399     }
<a name="l01400"></a>01400     <span class="keywordflow">else</span>
<a name="l01401"></a>01401     {
<a name="l01402"></a>01402         <span class="comment">//</span>
<a name="l01403"></a>01403         <span class="comment">// Perform a stall on an OUT endpoint.</span>
<a name="l01404"></a>01404         <span class="comment">//</span>
<a name="l01405"></a>01405         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l01406"></a>01406             <a class="code" href="hw__usb_8h.html#a14d69e7194f31c15b10dfda9c5109b5f">USB_RXCSRL1_STALL</a>;
<a name="l01407"></a>01407     }
<a name="l01408"></a>01408 }
<a name="l01409"></a>01409 
<a name="l01410"></a>01410 <span class="comment">//*****************************************************************************</span>
<a name="l01411"></a>01411 <span class="comment">//</span>
<a name="l01428"></a>01428 <span class="comment"></span><span class="comment">//</span>
<a name="l01429"></a>01429 <span class="comment">//*****************************************************************************</span>
<a name="l01430"></a>01430 <span class="keywordtype">void</span>
<a name="l01431"></a><a class="code" href="group__usb__api.html#ga5994707f1b0acbc57d3c1bbc6e2483f0">01431</a> <a class="code" href="group__usb__api.html#ga5994707f1b0acbc57d3c1bbc6e2483f0">USBDevEndpointStallClear</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01432"></a>01432                          uint32_t ui32Flags)
<a name="l01433"></a>01433 {
<a name="l01434"></a>01434     <span class="comment">//</span>
<a name="l01435"></a>01435     <span class="comment">// Check the arguments.</span>
<a name="l01436"></a>01436     <span class="comment">//</span>
<a name="l01437"></a>01437     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01438"></a>01438     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01439"></a>01439            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01440"></a>01440            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01441"></a>01441            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01442"></a>01442     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Flags &amp; ~(<a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a> | <a class="code" href="usb_8h.html#a7f1336c270a8ee96a67edef7f124e5ba">USB_EP_DEV_OUT</a>)) == 0);
<a name="l01443"></a>01443 
<a name="l01444"></a>01444     <span class="comment">//</span>
<a name="l01445"></a>01445     <span class="comment">// Determine how to clear the stall on this endpoint.</span>
<a name="l01446"></a>01446     <span class="comment">//</span>
<a name="l01447"></a>01447     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01448"></a>01448     {
<a name="l01449"></a>01449         <span class="comment">//</span>
<a name="l01450"></a>01450         <span class="comment">// Clear the stall on endpoint zero.</span>
<a name="l01451"></a>01451         <span class="comment">//</span>
<a name="l01452"></a>01452         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#aa0f1b7e9ac27a773a386af520e89980d">USB_CSRL0_STALLED</a>;
<a name="l01453"></a>01453     }
<a name="l01454"></a>01454     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags == <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>)
<a name="l01455"></a>01455     {
<a name="l01456"></a>01456         <span class="comment">//</span>
<a name="l01457"></a>01457         <span class="comment">// Clear the stall on an IN endpoint.</span>
<a name="l01458"></a>01458         <span class="comment">//</span>
<a name="l01459"></a>01459         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l01460"></a>01460             ~(<a class="code" href="hw__usb_8h.html#a37d6d15e1848c4aef25049a3dc9e09d2">USB_TXCSRL1_STALL</a> | <a class="code" href="hw__usb_8h.html#a1386169b6005024ea7ce15648f253839">USB_TXCSRL1_STALLED</a>);
<a name="l01461"></a>01461 
<a name="l01462"></a>01462         <span class="comment">//</span>
<a name="l01463"></a>01463         <span class="comment">// Reset the data toggle.</span>
<a name="l01464"></a>01464         <span class="comment">//</span>
<a name="l01465"></a>01465         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l01466"></a>01466             <a class="code" href="hw__usb_8h.html#a70a1b1e35e89f7ef19cf13df87a011bf">USB_TXCSRL1_CLRDT</a>;
<a name="l01467"></a>01467     }
<a name="l01468"></a>01468     <span class="keywordflow">else</span>
<a name="l01469"></a>01469     {
<a name="l01470"></a>01470         <span class="comment">//</span>
<a name="l01471"></a>01471         <span class="comment">// Clear the stall on an OUT endpoint.</span>
<a name="l01472"></a>01472         <span class="comment">//</span>
<a name="l01473"></a>01473         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l01474"></a>01474             ~(<a class="code" href="hw__usb_8h.html#a14d69e7194f31c15b10dfda9c5109b5f">USB_RXCSRL1_STALL</a> | <a class="code" href="hw__usb_8h.html#a538d1dd26c7eb2bc5112ac4e20e8f6d4">USB_RXCSRL1_STALLED</a>);
<a name="l01475"></a>01475 
<a name="l01476"></a>01476         <span class="comment">//</span>
<a name="l01477"></a>01477         <span class="comment">// Reset the data toggle.</span>
<a name="l01478"></a>01478         <span class="comment">//</span>
<a name="l01479"></a>01479         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l01480"></a>01480             <a class="code" href="hw__usb_8h.html#aee0bc3c1d82b61a1fabab0e5347f052c">USB_RXCSRL1_CLRDT</a>;
<a name="l01481"></a>01481     }
<a name="l01482"></a>01482 }
<a name="l01483"></a>01483 
<a name="l01484"></a>01484 <span class="comment">//*****************************************************************************</span>
<a name="l01485"></a>01485 <span class="comment">//</span>
<a name="l01496"></a>01496 <span class="comment"></span><span class="comment">//</span>
<a name="l01497"></a>01497 <span class="comment">//*****************************************************************************</span>
<a name="l01498"></a>01498 <span class="keywordtype">void</span>
<a name="l01499"></a><a class="code" href="group__usb__api.html#gab60e93390009b01e2e6934e6dda3f94d">01499</a> <a class="code" href="group__usb__api.html#gab60e93390009b01e2e6934e6dda3f94d">USBDevConnect</a>(uint32_t ui32Base)
<a name="l01500"></a>01500 {
<a name="l01501"></a>01501     <span class="comment">//</span>
<a name="l01502"></a>01502     <span class="comment">// Check the arguments.</span>
<a name="l01503"></a>01503     <span class="comment">//</span>
<a name="l01504"></a>01504     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01505"></a>01505 
<a name="l01506"></a>01506     <span class="comment">//</span>
<a name="l01507"></a>01507     <span class="comment">// Enable connection to the USB bus.</span>
<a name="l01508"></a>01508     <span class="comment">//</span>
<a name="l01509"></a>01509     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) |= <a class="code" href="hw__usb_8h.html#a924294c1d15dc9e28ed111eea2e24afc">USB_POWER_SOFTCONN</a>;
<a name="l01510"></a>01510 }
<a name="l01511"></a>01511 
<a name="l01512"></a>01512 <span class="comment">//*****************************************************************************</span>
<a name="l01513"></a>01513 <span class="comment">//</span>
<a name="l01525"></a>01525 <span class="comment"></span><span class="comment">//</span>
<a name="l01526"></a>01526 <span class="comment">//*****************************************************************************</span>
<a name="l01527"></a>01527 <span class="keywordtype">void</span>
<a name="l01528"></a><a class="code" href="group__usb__api.html#gab6d43280f582f4a34aa5c26cf1f87e62">01528</a> <a class="code" href="group__usb__api.html#gab6d43280f582f4a34aa5c26cf1f87e62">USBDevDisconnect</a>(uint32_t ui32Base)
<a name="l01529"></a>01529 {
<a name="l01530"></a>01530     <span class="comment">//</span>
<a name="l01531"></a>01531     <span class="comment">// Check the arguments.</span>
<a name="l01532"></a>01532     <span class="comment">//</span>
<a name="l01533"></a>01533     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01534"></a>01534 
<a name="l01535"></a>01535     <span class="comment">//</span>
<a name="l01536"></a>01536     <span class="comment">// Disable connection to the USB bus.</span>
<a name="l01537"></a>01537     <span class="comment">//</span>
<a name="l01538"></a>01538     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) &amp;= (~<a class="code" href="hw__usb_8h.html#a924294c1d15dc9e28ed111eea2e24afc">USB_POWER_SOFTCONN</a>);
<a name="l01539"></a>01539 }
<a name="l01540"></a>01540 
<a name="l01541"></a>01541 <span class="comment">//*****************************************************************************</span>
<a name="l01542"></a>01542 <span class="comment">//</span>
<a name="l01554"></a>01554 <span class="comment"></span><span class="comment">//</span>
<a name="l01555"></a>01555 <span class="comment">//*****************************************************************************</span>
<a name="l01556"></a>01556 <span class="keywordtype">void</span>
<a name="l01557"></a><a class="code" href="group__usb__api.html#gaceb9c8a1e98f690beeabf1bdc193db31">01557</a> <a class="code" href="group__usb__api.html#gaceb9c8a1e98f690beeabf1bdc193db31">USBDevAddrSet</a>(uint32_t ui32Base, uint32_t ui32Address)
<a name="l01558"></a>01558 {
<a name="l01559"></a>01559     <span class="comment">//</span>
<a name="l01560"></a>01560     <span class="comment">// Check the arguments.</span>
<a name="l01561"></a>01561     <span class="comment">//</span>
<a name="l01562"></a>01562     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="comment">//</span>
<a name="l01565"></a>01565     <span class="comment">// Set the function address in the correct location.</span>
<a name="l01566"></a>01566     <span class="comment">//</span>
<a name="l01567"></a>01567     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#acc7854024e1d624c4777205e8c98839c">USB_O_FADDR</a>) = (uint8_t)ui32Address;
<a name="l01568"></a>01568 }
<a name="l01569"></a>01569 
<a name="l01570"></a>01570 <span class="comment">//*****************************************************************************</span>
<a name="l01571"></a>01571 <span class="comment">//</span>
<a name="l01582"></a>01582 <span class="comment"></span><span class="comment">//</span>
<a name="l01583"></a>01583 <span class="comment">//*****************************************************************************</span>
<a name="l01584"></a>01584 uint32_t
<a name="l01585"></a><a class="code" href="group__usb__api.html#gadf0186afcf2fa5192b9701be4b3224c3">01585</a> <a class="code" href="group__usb__api.html#gadf0186afcf2fa5192b9701be4b3224c3">USBDevAddrGet</a>(uint32_t ui32Base)
<a name="l01586"></a>01586 {
<a name="l01587"></a>01587     <span class="comment">//</span>
<a name="l01588"></a>01588     <span class="comment">// Check the arguments.</span>
<a name="l01589"></a>01589     <span class="comment">//</span>
<a name="l01590"></a>01590     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01591"></a>01591 
<a name="l01592"></a>01592     <span class="comment">//</span>
<a name="l01593"></a>01593     <span class="comment">// Return the function address.</span>
<a name="l01594"></a>01594     <span class="comment">//</span>
<a name="l01595"></a>01595     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#acc7854024e1d624c4777205e8c98839c">USB_O_FADDR</a>));
<a name="l01596"></a>01596 }
<a name="l01597"></a>01597 
<a name="l01598"></a>01598 <span class="comment">//*****************************************************************************</span>
<a name="l01599"></a>01599 <span class="comment">//</span>
<a name="l01677"></a>01677 <span class="comment"></span><span class="comment">//</span>
<a name="l01678"></a>01678 <span class="comment">//*****************************************************************************</span>
<a name="l01679"></a>01679 <span class="keywordtype">void</span>
<a name="l01680"></a><a class="code" href="group__usb__api.html#ga27c1e1dc9de6db51b766d39694cb7ffb">01680</a> <a class="code" href="group__usb__api.html#ga27c1e1dc9de6db51b766d39694cb7ffb">USBHostEndpointConfig</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01681"></a>01681                       uint32_t ui32MaxPayload, uint32_t ui32NAKPollInterval,
<a name="l01682"></a>01682                       uint32_t ui32TargetEndpoint, uint32_t ui32Flags)
<a name="l01683"></a>01683 {
<a name="l01684"></a>01684     uint32_t ui32Register;
<a name="l01685"></a>01685 
<a name="l01686"></a>01686     <span class="comment">//</span>
<a name="l01687"></a>01687     <span class="comment">// Check the arguments.</span>
<a name="l01688"></a>01688     <span class="comment">//</span>
<a name="l01689"></a>01689     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01690"></a>01690     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01691"></a>01691            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01692"></a>01692            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01693"></a>01693            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01694"></a>01694     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32NAKPollInterval &lt;= <a class="code" href="usb_8h.html#a0156f796460a70cd6732d1ba5ffe1f2f">MAX_NAK_LIMIT</a>);
<a name="l01695"></a>01695 
<a name="l01696"></a>01696     <span class="comment">//</span>
<a name="l01697"></a>01697     <span class="comment">// Endpoint zero is configured differently than the other endpoints, so see</span>
<a name="l01698"></a>01698     <span class="comment">// if this is endpoint zero.</span>
<a name="l01699"></a>01699     <span class="comment">//</span>
<a name="l01700"></a>01700     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01701"></a>01701     {
<a name="l01702"></a>01702         <span class="comment">//</span>
<a name="l01703"></a>01703         <span class="comment">// Set the NAK timeout.</span>
<a name="l01704"></a>01704         <span class="comment">//</span>
<a name="l01705"></a>01705         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a4b642ce24b7f03b357b737f8e0b8d9f6">USB_O_NAKLMT</a>) = ui32NAKPollInterval;
<a name="l01706"></a>01706 
<a name="l01707"></a>01707         <span class="comment">//</span>
<a name="l01708"></a>01708         <span class="comment">// Set the transfer type information.</span>
<a name="l01709"></a>01709         <span class="comment">//</span>
<a name="l01710"></a>01710         <span class="comment">//</span>
<a name="l01711"></a>01711         <span class="comment">// Set the speed of this endpoint.</span>
<a name="l01712"></a>01712         <span class="comment">//</span>
<a name="l01713"></a>01713         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a83597dac986079e006ae113acce82ccb">USB_EP_SPEED_HIGH</a>)
<a name="l01714"></a>01714         {
<a name="l01715"></a>01715             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae968897d93669d85a774c00bdc5553fb">USB_O_TYPE0</a>) = <a class="code" href="hw__usb_8h.html#a4c332d0768cf2ec5bf7c64ecfa3d72c9">USB_TYPE0_SPEED_HIGH</a>;
<a name="l01716"></a>01716         }
<a name="l01717"></a>01717         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a45b104ecc0673dc778e652ca88ec45a1">USB_EP_SPEED_FULL</a>)
<a name="l01718"></a>01718         {
<a name="l01719"></a>01719             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae968897d93669d85a774c00bdc5553fb">USB_O_TYPE0</a>) = <a class="code" href="hw__usb_8h.html#ad75009234bcb791c90f83a6eba56558e">USB_TYPE0_SPEED_FULL</a>;
<a name="l01720"></a>01720         }
<a name="l01721"></a>01721         <span class="keywordflow">else</span>
<a name="l01722"></a>01722         {
<a name="l01723"></a>01723             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae968897d93669d85a774c00bdc5553fb">USB_O_TYPE0</a>) = <a class="code" href="hw__usb_8h.html#a2c11924120fbb14d0f29521e30c31264">USB_TYPE0_SPEED_LOW</a>;
<a name="l01724"></a>01724         }
<a name="l01725"></a>01725     }
<a name="l01726"></a>01726     <span class="keywordflow">else</span>
<a name="l01727"></a>01727     {
<a name="l01728"></a>01728         <span class="comment">//</span>
<a name="l01729"></a>01729         <span class="comment">// Start with the target endpoint.</span>
<a name="l01730"></a>01730         <span class="comment">//</span>
<a name="l01731"></a>01731         ui32Register = ui32TargetEndpoint;
<a name="l01732"></a>01732 
<a name="l01733"></a>01733         <span class="comment">//</span>
<a name="l01734"></a>01734         <span class="comment">// Set the speed for the device using this endpoint.</span>
<a name="l01735"></a>01735         <span class="comment">//</span>
<a name="l01736"></a>01736         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a83597dac986079e006ae113acce82ccb">USB_EP_SPEED_HIGH</a>)
<a name="l01737"></a>01737         {
<a name="l01738"></a>01738             ui32Register |= <a class="code" href="hw__usb_8h.html#a1c9620c5171f279a788a4788d3073b90">USB_TXTYPE1_SPEED_HIGH</a>;
<a name="l01739"></a>01739         }
<a name="l01740"></a>01740         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a45b104ecc0673dc778e652ca88ec45a1">USB_EP_SPEED_FULL</a>)
<a name="l01741"></a>01741         {
<a name="l01742"></a>01742             ui32Register |= <a class="code" href="hw__usb_8h.html#a25e094c993b8e4befbe82517aff7e0c4">USB_TXTYPE1_SPEED_FULL</a>;
<a name="l01743"></a>01743         }
<a name="l01744"></a>01744         <span class="keywordflow">else</span>
<a name="l01745"></a>01745         {
<a name="l01746"></a>01746             ui32Register |= <a class="code" href="hw__usb_8h.html#ac2e80f243222c9910924df86682a3862">USB_TXTYPE1_SPEED_LOW</a>;
<a name="l01747"></a>01747         }
<a name="l01748"></a>01748 
<a name="l01749"></a>01749         <span class="comment">//</span>
<a name="l01750"></a>01750         <span class="comment">// Set the protocol for the device using this endpoint.</span>
<a name="l01751"></a>01751         <span class="comment">//</span>
<a name="l01752"></a>01752         <span class="keywordflow">switch</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ac4867149a95bf62b061dc3149c6eb596">USB_EP_MODE_MASK</a>)
<a name="l01753"></a>01753         {
<a name="l01754"></a>01754             <span class="comment">//</span>
<a name="l01755"></a>01755             <span class="comment">// The bulk protocol is being used.</span>
<a name="l01756"></a>01756             <span class="comment">//</span>
<a name="l01757"></a>01757             <span class="keywordflow">case</span> <a class="code" href="usb_8h.html#aa6159888b439bfb438c8e5d898214922">USB_EP_MODE_BULK</a>:
<a name="l01758"></a>01758             {
<a name="l01759"></a>01759                 ui32Register |= <a class="code" href="hw__usb_8h.html#a28d9e128ba6150fa5285efb9e56c36bc">USB_TXTYPE1_PROTO_BULK</a>;
<a name="l01760"></a>01760                 <span class="keywordflow">break</span>;
<a name="l01761"></a>01761             }
<a name="l01762"></a>01762 
<a name="l01763"></a>01763             <span class="comment">//</span>
<a name="l01764"></a>01764             <span class="comment">// The isochronous protocol is being used.</span>
<a name="l01765"></a>01765             <span class="comment">//</span>
<a name="l01766"></a>01766             <span class="keywordflow">case</span> <a class="code" href="usb_8h.html#a12885dc6ed4485c48d871c639cc6f952">USB_EP_MODE_ISOC</a>:
<a name="l01767"></a>01767             {
<a name="l01768"></a>01768                 ui32Register |= <a class="code" href="hw__usb_8h.html#a69bcc8c2b04150394222d31e20a332b4">USB_TXTYPE1_PROTO_ISOC</a>;
<a name="l01769"></a>01769                 <span class="keywordflow">break</span>;
<a name="l01770"></a>01770             }
<a name="l01771"></a>01771 
<a name="l01772"></a>01772             <span class="comment">//</span>
<a name="l01773"></a>01773             <span class="comment">// The interrupt protocol is being used.</span>
<a name="l01774"></a>01774             <span class="comment">//</span>
<a name="l01775"></a>01775             <span class="keywordflow">case</span> <a class="code" href="usb_8h.html#a245bdb5fbcaa58e65d6b55106decd25e">USB_EP_MODE_INT</a>:
<a name="l01776"></a>01776             {
<a name="l01777"></a>01777                 ui32Register |= <a class="code" href="hw__usb_8h.html#a29c6b2764df8d6c668f65159ffb4fb31">USB_TXTYPE1_PROTO_INT</a>;
<a name="l01778"></a>01778                 <span class="keywordflow">break</span>;
<a name="l01779"></a>01779             }
<a name="l01780"></a>01780 
<a name="l01781"></a>01781             <span class="comment">//</span>
<a name="l01782"></a>01782             <span class="comment">// The control protocol is being used.</span>
<a name="l01783"></a>01783             <span class="comment">//</span>
<a name="l01784"></a>01784             <span class="keywordflow">case</span> <a class="code" href="usb_8h.html#a8fec31410bb407e42d93601ceaa7abe3">USB_EP_MODE_CTRL</a>:
<a name="l01785"></a>01785             {
<a name="l01786"></a>01786                 ui32Register |= <a class="code" href="hw__usb_8h.html#ae9f06160100f5ea8021367a7998c421d">USB_TXTYPE1_PROTO_CTRL</a>;
<a name="l01787"></a>01787                 <span class="keywordflow">break</span>;
<a name="l01788"></a>01788             }
<a name="l01789"></a>01789         }
<a name="l01790"></a>01790 
<a name="l01791"></a>01791         <span class="comment">//</span>
<a name="l01792"></a>01792         <span class="comment">// See if the transmit or receive endpoint is being configured.</span>
<a name="l01793"></a>01793         <span class="comment">//</span>
<a name="l01794"></a>01794         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a>)
<a name="l01795"></a>01795         {
<a name="l01796"></a>01796             <span class="comment">//</span>
<a name="l01797"></a>01797             <span class="comment">// Set the transfer type information.</span>
<a name="l01798"></a>01798             <span class="comment">//</span>
<a name="l01799"></a>01799             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a855cd09323bbba69032b89d2160d3490">USB_O_TXTYPE1</a>) =
<a name="l01800"></a>01800                 ui32Register;
<a name="l01801"></a>01801 
<a name="l01802"></a>01802             <span class="comment">//</span>
<a name="l01803"></a>01803             <span class="comment">// Set the NAK timeout or polling interval.</span>
<a name="l01804"></a>01804             <span class="comment">//</span>
<a name="l01805"></a>01805             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a43f0ae79a371a84ca972532226fc135d">USB_O_TXINTERVAL1</a>) =
<a name="l01806"></a>01806                 ui32NAKPollInterval;
<a name="l01807"></a>01807 
<a name="l01808"></a>01808             <span class="comment">//</span>
<a name="l01809"></a>01809             <span class="comment">// Set the Maximum Payload per transaction.</span>
<a name="l01810"></a>01810             <span class="comment">//</span>
<a name="l01811"></a>01811             <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a10a3276cbd2ee4806cbe3e0f4840b578">USB_O_TXMAXP1</a>) =
<a name="l01812"></a>01812                 ui32MaxPayload;
<a name="l01813"></a>01813 
<a name="l01814"></a>01814             <span class="comment">//</span>
<a name="l01815"></a>01815             <span class="comment">// Set the transmit control value to zero.</span>
<a name="l01816"></a>01816             <span class="comment">//</span>
<a name="l01817"></a>01817             ui32Register = 0;
<a name="l01818"></a>01818 
<a name="l01819"></a>01819             <span class="comment">//</span>
<a name="l01820"></a>01820             <span class="comment">// Allow auto setting of TxPktRdy when max packet size has been</span>
<a name="l01821"></a>01821             <span class="comment">// loaded into the FIFO.</span>
<a name="l01822"></a>01822             <span class="comment">//</span>
<a name="l01823"></a>01823             <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#af83d520bf70b794bd74c9e2f8573e7ab">USB_EP_AUTO_SET</a>)
<a name="l01824"></a>01824             {
<a name="l01825"></a>01825                 ui32Register |= <a class="code" href="hw__usb_8h.html#a6a74dc0cf7f4010a9562834742a12569">USB_TXCSRH1_AUTOSET</a>;
<a name="l01826"></a>01826             }
<a name="l01827"></a>01827 
<a name="l01828"></a>01828             <span class="comment">//</span>
<a name="l01829"></a>01829             <span class="comment">// Configure the DMA Mode.</span>
<a name="l01830"></a>01830             <span class="comment">//</span>
<a name="l01831"></a>01831             <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>)
<a name="l01832"></a>01832             {
<a name="l01833"></a>01833                 ui32Register |= <a class="code" href="hw__usb_8h.html#a70a09d67fe2b11247e013449470a04d0">USB_TXCSRH1_DMAEN</a> | <a class="code" href="hw__usb_8h.html#abd420b366edbcda207b59235e060eea6">USB_TXCSRH1_DMAMOD</a>;
<a name="l01834"></a>01834             }
<a name="l01835"></a>01835             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ab35e7f9177cbd7f7c6af3319d936c1d3">USB_EP_DMA_MODE_0</a>)
<a name="l01836"></a>01836             {
<a name="l01837"></a>01837                 ui32Register |= <a class="code" href="hw__usb_8h.html#a70a09d67fe2b11247e013449470a04d0">USB_TXCSRH1_DMAEN</a>;
<a name="l01838"></a>01838             }
<a name="l01839"></a>01839 
<a name="l01840"></a>01840             <span class="comment">//</span>
<a name="l01841"></a>01841             <span class="comment">// Write out the transmit control value.</span>
<a name="l01842"></a>01842             <span class="comment">//</span>
<a name="l01843"></a>01843             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a>) =
<a name="l01844"></a>01844                 (uint8_t)ui32Register;
<a name="l01845"></a>01845         }
<a name="l01846"></a>01846         <span class="keywordflow">else</span>
<a name="l01847"></a>01847         {
<a name="l01848"></a>01848             <span class="comment">//</span>
<a name="l01849"></a>01849             <span class="comment">// Set the transfer type information.</span>
<a name="l01850"></a>01850             <span class="comment">//</span>
<a name="l01851"></a>01851             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a916127bf93c85870b97f19d8d5d7d4f0">USB_O_RXTYPE1</a>) =
<a name="l01852"></a>01852                 ui32Register;
<a name="l01853"></a>01853 
<a name="l01854"></a>01854             <span class="comment">//</span>
<a name="l01855"></a>01855             <span class="comment">// Set the NAK timeout or polling interval.</span>
<a name="l01856"></a>01856             <span class="comment">//</span>
<a name="l01857"></a>01857             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a4c9b261e7f741a2c361a5a69282a6d70">USB_O_RXINTERVAL1</a>) =
<a name="l01858"></a>01858                 ui32NAKPollInterval;
<a name="l01859"></a>01859 
<a name="l01860"></a>01860             <span class="comment">//</span>
<a name="l01861"></a>01861             <span class="comment">// Set the Maximum Payload per transaction.</span>
<a name="l01862"></a>01862             <span class="comment">//</span>
<a name="l01863"></a>01863             <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a74c921b3840ba9d08eabd9de16401bd2">USB_O_RXMAXP1</a>) =
<a name="l01864"></a>01864                 ui32MaxPayload;
<a name="l01865"></a>01865 
<a name="l01866"></a>01866             <span class="comment">//</span>
<a name="l01867"></a>01867             <span class="comment">// Set the receive control value to zero.</span>
<a name="l01868"></a>01868             <span class="comment">//</span>
<a name="l01869"></a>01869             ui32Register = 0;
<a name="l01870"></a>01870 
<a name="l01871"></a>01871             <span class="comment">//</span>
<a name="l01872"></a>01872             <span class="comment">// Allow auto clearing of RxPktRdy when packet of size max packet</span>
<a name="l01873"></a>01873             <span class="comment">// has been unloaded from the FIFO.</span>
<a name="l01874"></a>01874             <span class="comment">//</span>
<a name="l01875"></a>01875             <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ac6ffbe05755a887eff3bee31239d76ee">USB_EP_AUTO_CLEAR</a>)
<a name="l01876"></a>01876             {
<a name="l01877"></a>01877                 ui32Register |= <a class="code" href="hw__usb_8h.html#a3f19fc8cbdc83cd742276b0787c0705f">USB_RXCSRH1_AUTOCL</a>;
<a name="l01878"></a>01878             }
<a name="l01879"></a>01879 
<a name="l01880"></a>01880             <span class="comment">//</span>
<a name="l01881"></a>01881             <span class="comment">// Allow auto generation of DMA requests.</span>
<a name="l01882"></a>01882             <span class="comment">//</span>
<a name="l01883"></a>01883             <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a6fdc385936265c4f00b1582e9ea0a230">USB_EP_AUTO_REQUEST</a>)
<a name="l01884"></a>01884             {
<a name="l01885"></a>01885                 ui32Register |= <a class="code" href="hw__usb_8h.html#ace44928f33d51fdb2ea895982f810c9d">USB_RXCSRH1_AUTORQ</a>;
<a name="l01886"></a>01886             }
<a name="l01887"></a>01887 
<a name="l01888"></a>01888             <span class="comment">//</span>
<a name="l01889"></a>01889             <span class="comment">// Configure the DMA Mode.</span>
<a name="l01890"></a>01890             <span class="comment">//</span>
<a name="l01891"></a>01891             <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>)
<a name="l01892"></a>01892             {
<a name="l01893"></a>01893                 ui32Register |= <a class="code" href="hw__usb_8h.html#a77d6133e3e9658960e4bf88ea5e98219">USB_RXCSRH1_DMAEN</a> | <a class="code" href="hw__usb_8h.html#a765b6bd345468708035e8c6d4efd8a29">USB_RXCSRH1_DMAMOD</a>;
<a name="l01894"></a>01894             }
<a name="l01895"></a>01895             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ab35e7f9177cbd7f7c6af3319d936c1d3">USB_EP_DMA_MODE_0</a>)
<a name="l01896"></a>01896             {
<a name="l01897"></a>01897                 ui32Register |= <a class="code" href="hw__usb_8h.html#a77d6133e3e9658960e4bf88ea5e98219">USB_RXCSRH1_DMAEN</a>;
<a name="l01898"></a>01898             }
<a name="l01899"></a>01899 
<a name="l01900"></a>01900             <span class="comment">//</span>
<a name="l01901"></a>01901             <span class="comment">// Write out the receive control value.</span>
<a name="l01902"></a>01902             <span class="comment">//</span>
<a name="l01903"></a>01903             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a>) =
<a name="l01904"></a>01904                 (uint8_t)ui32Register;
<a name="l01905"></a>01905         }
<a name="l01906"></a>01906     }
<a name="l01907"></a>01907 }
<a name="l01908"></a>01908 
<a name="l01909"></a>01909 <span class="comment">//*****************************************************************************</span>
<a name="l01910"></a>01910 <span class="comment">//</span>
<a name="l01937"></a>01937 <span class="comment"></span><span class="comment">//</span>
<a name="l01938"></a>01938 <span class="comment">//*****************************************************************************</span>
<a name="l01939"></a>01939 <span class="keywordtype">void</span>
<a name="l01940"></a><a class="code" href="group__usb__api.html#ga3dd3bac2941ff16170cc162ac5dc56e7">01940</a> <a class="code" href="group__usb__api.html#ga3dd3bac2941ff16170cc162ac5dc56e7">USBHostEndpointSpeed</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l01941"></a>01941                      uint32_t ui32Flags)
<a name="l01942"></a>01942 {
<a name="l01943"></a>01943     uint32_t ui32Reg;
<a name="l01944"></a>01944     uint32_t ui32Speed;
<a name="l01945"></a>01945 
<a name="l01946"></a>01946     <span class="comment">//</span>
<a name="l01947"></a>01947     <span class="comment">// Check the arguments.</span>
<a name="l01948"></a>01948     <span class="comment">//</span>
<a name="l01949"></a>01949     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l01950"></a>01950     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l01951"></a>01951            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l01952"></a>01952            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l01953"></a>01953            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l01954"></a>01954 
<a name="l01955"></a>01955     <span class="comment">//</span>
<a name="l01956"></a>01956     <span class="comment">// Create the register speed value.</span>
<a name="l01957"></a>01957     <span class="comment">//</span>
<a name="l01958"></a>01958     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a83597dac986079e006ae113acce82ccb">USB_EP_SPEED_HIGH</a>)
<a name="l01959"></a>01959     {
<a name="l01960"></a>01960         ui32Speed = <a class="code" href="hw__usb_8h.html#a4c332d0768cf2ec5bf7c64ecfa3d72c9">USB_TYPE0_SPEED_HIGH</a>;
<a name="l01961"></a>01961     }
<a name="l01962"></a>01962     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a45b104ecc0673dc778e652ca88ec45a1">USB_EP_SPEED_FULL</a>)
<a name="l01963"></a>01963     {
<a name="l01964"></a>01964         ui32Speed = <a class="code" href="hw__usb_8h.html#ad75009234bcb791c90f83a6eba56558e">USB_TYPE0_SPEED_FULL</a>;
<a name="l01965"></a>01965     }
<a name="l01966"></a>01966     <span class="keywordflow">else</span>
<a name="l01967"></a>01967     {
<a name="l01968"></a>01968         ui32Speed = <a class="code" href="hw__usb_8h.html#a2c11924120fbb14d0f29521e30c31264">USB_TYPE0_SPEED_LOW</a>;
<a name="l01969"></a>01969     }
<a name="l01970"></a>01970 
<a name="l01971"></a>01971     <span class="comment">//</span>
<a name="l01972"></a>01972     <span class="comment">// Endpoint 0 is handled differently as it is bi-directional.</span>
<a name="l01973"></a>01973     <span class="comment">//</span>
<a name="l01974"></a>01974     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l01975"></a>01975     {
<a name="l01976"></a>01976         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae968897d93669d85a774c00bdc5553fb">USB_O_TYPE0</a>) = ui32Speed;
<a name="l01977"></a>01977     }
<a name="l01978"></a>01978     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a>)
<a name="l01979"></a>01979     {
<a name="l01980"></a>01980         <span class="comment">//</span>
<a name="l01981"></a>01981         <span class="comment">// Clear the current speed and set the new speed.</span>
<a name="l01982"></a>01982         <span class="comment">//</span>
<a name="l01983"></a>01983         ui32Reg = (<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a855cd09323bbba69032b89d2160d3490">USB_O_TXTYPE1</a>) &amp;
<a name="l01984"></a>01984                    ~(<a class="code" href="hw__usb_8h.html#a9122ae4476961b89262804328282d1ab">USB_TXTYPE1_SPEED_M</a>));
<a name="l01985"></a>01985         ui32Reg |= ui32Speed;
<a name="l01986"></a>01986 
<a name="l01987"></a>01987         <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a855cd09323bbba69032b89d2160d3490">USB_O_TXTYPE1</a>) |= ui32Reg;
<a name="l01988"></a>01988     }
<a name="l01989"></a>01989     <span class="keywordflow">else</span>
<a name="l01990"></a>01990     {
<a name="l01991"></a>01991         <span class="comment">//</span>
<a name="l01992"></a>01992         <span class="comment">// Clear the current speed and set the new speed.</span>
<a name="l01993"></a>01993         <span class="comment">//</span>
<a name="l01994"></a>01994         ui32Reg = (<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a916127bf93c85870b97f19d8d5d7d4f0">USB_O_RXTYPE1</a>) &amp;
<a name="l01995"></a>01995                    ~(<a class="code" href="hw__usb_8h.html#a3668954cf466d7d006d588fe6d106b4e">USB_RXTYPE1_SPEED_M</a>));
<a name="l01996"></a>01996         ui32Reg |= ui32Speed;
<a name="l01997"></a>01997 
<a name="l01998"></a>01998         <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a916127bf93c85870b97f19d8d5d7d4f0">USB_O_RXTYPE1</a>) |= ui32Reg;
<a name="l01999"></a>01999     }
<a name="l02000"></a>02000 }
<a name="l02001"></a>02001 
<a name="l02002"></a>02002 <span class="comment">//*****************************************************************************</span>
<a name="l02003"></a>02003 <span class="comment">//</span>
<a name="l02050"></a>02050 <span class="comment"></span><span class="comment">//</span>
<a name="l02051"></a>02051 <span class="comment">//*****************************************************************************</span>
<a name="l02052"></a>02052 <span class="keywordtype">void</span>
<a name="l02053"></a><a class="code" href="group__usb__api.html#ga01a7ebd9276d10d86358d5fcc945d35c">02053</a> <a class="code" href="group__usb__api.html#ga01a7ebd9276d10d86358d5fcc945d35c">USBDevEndpointConfigSet</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02054"></a>02054                         uint32_t ui32MaxPacketSize, uint32_t ui32Flags)
<a name="l02055"></a>02055 {
<a name="l02056"></a>02056     uint32_t ui32Register;
<a name="l02057"></a>02057 
<a name="l02058"></a>02058     <span class="comment">//</span>
<a name="l02059"></a>02059     <span class="comment">// Check the arguments.</span>
<a name="l02060"></a>02060     <span class="comment">//</span>
<a name="l02061"></a>02061     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02062"></a>02062     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) ||
<a name="l02063"></a>02063            (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) ||
<a name="l02064"></a>02064            (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) ||
<a name="l02065"></a>02065            (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02066"></a>02066 
<a name="l02067"></a>02067     <span class="comment">//</span>
<a name="l02068"></a>02068     <span class="comment">// Determine if a transmit or receive endpoint is being configured.</span>
<a name="l02069"></a>02069     <span class="comment">//</span>
<a name="l02070"></a>02070     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>)
<a name="l02071"></a>02071     {
<a name="l02072"></a>02072         <span class="comment">//</span>
<a name="l02073"></a>02073         <span class="comment">// Set the maximum packet size.</span>
<a name="l02074"></a>02074         <span class="comment">//</span>
<a name="l02075"></a>02075         <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a10a3276cbd2ee4806cbe3e0f4840b578">USB_O_TXMAXP1</a>) =
<a name="l02076"></a>02076             ui32MaxPacketSize;
<a name="l02077"></a>02077 
<a name="l02078"></a>02078         <span class="comment">//</span>
<a name="l02079"></a>02079         <span class="comment">// The transmit control value is zero unless options are enabled.</span>
<a name="l02080"></a>02080         <span class="comment">//</span>
<a name="l02081"></a>02081         ui32Register = 0;
<a name="l02082"></a>02082 
<a name="l02083"></a>02083         <span class="comment">//</span>
<a name="l02084"></a>02084         <span class="comment">// Allow auto setting of TxPktRdy when max packet size has been loaded</span>
<a name="l02085"></a>02085         <span class="comment">// into the FIFO.</span>
<a name="l02086"></a>02086         <span class="comment">//</span>
<a name="l02087"></a>02087         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#af83d520bf70b794bd74c9e2f8573e7ab">USB_EP_AUTO_SET</a>)
<a name="l02088"></a>02088         {
<a name="l02089"></a>02089             ui32Register |= <a class="code" href="hw__usb_8h.html#a6a74dc0cf7f4010a9562834742a12569">USB_TXCSRH1_AUTOSET</a>;
<a name="l02090"></a>02090         }
<a name="l02091"></a>02091 
<a name="l02092"></a>02092         <span class="comment">//</span>
<a name="l02093"></a>02093         <span class="comment">// Configure the DMA mode.</span>
<a name="l02094"></a>02094         <span class="comment">//</span>
<a name="l02095"></a>02095         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>)
<a name="l02096"></a>02096         {
<a name="l02097"></a>02097             ui32Register |= <a class="code" href="hw__usb_8h.html#a70a09d67fe2b11247e013449470a04d0">USB_TXCSRH1_DMAEN</a> | <a class="code" href="hw__usb_8h.html#abd420b366edbcda207b59235e060eea6">USB_TXCSRH1_DMAMOD</a>;
<a name="l02098"></a>02098         }
<a name="l02099"></a>02099         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ab35e7f9177cbd7f7c6af3319d936c1d3">USB_EP_DMA_MODE_0</a>)
<a name="l02100"></a>02100         {
<a name="l02101"></a>02101             ui32Register |= <a class="code" href="hw__usb_8h.html#a70a09d67fe2b11247e013449470a04d0">USB_TXCSRH1_DMAEN</a>;
<a name="l02102"></a>02102         }
<a name="l02103"></a>02103 
<a name="l02104"></a>02104         <span class="comment">//</span>
<a name="l02105"></a>02105         <span class="comment">// Enable isochronous mode if requested.</span>
<a name="l02106"></a>02106         <span class="comment">//</span>
<a name="l02107"></a>02107         <span class="keywordflow">if</span>((ui32Flags &amp; <a class="code" href="usb_8h.html#ac4867149a95bf62b061dc3149c6eb596">USB_EP_MODE_MASK</a>) == <a class="code" href="usb_8h.html#a12885dc6ed4485c48d871c639cc6f952">USB_EP_MODE_ISOC</a>)
<a name="l02108"></a>02108         {
<a name="l02109"></a>02109             ui32Register |= <a class="code" href="hw__usb_8h.html#aa7f88966e1ed96f9874b97457f8e3aa9">USB_TXCSRH1_ISO</a>;
<a name="l02110"></a>02110         }
<a name="l02111"></a>02111 
<a name="l02112"></a>02112         <span class="comment">//</span>
<a name="l02113"></a>02113         <span class="comment">// Write the transmit control value.</span>
<a name="l02114"></a>02114         <span class="comment">//</span>
<a name="l02115"></a>02115         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a>) =
<a name="l02116"></a>02116             (uint8_t)ui32Register;
<a name="l02117"></a>02117 
<a name="l02118"></a>02118         <span class="comment">//</span>
<a name="l02119"></a>02119         <span class="comment">// Reset the Data toggle to zero.</span>
<a name="l02120"></a>02120         <span class="comment">//</span>
<a name="l02121"></a>02121         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a>) =
<a name="l02122"></a>02122             <a class="code" href="hw__usb_8h.html#a70a1b1e35e89f7ef19cf13df87a011bf">USB_TXCSRL1_CLRDT</a>;
<a name="l02123"></a>02123     }
<a name="l02124"></a>02124     <span class="keywordflow">else</span>
<a name="l02125"></a>02125     {
<a name="l02126"></a>02126         <span class="comment">//</span>
<a name="l02127"></a>02127         <span class="comment">// Set the MaxPacketSize.</span>
<a name="l02128"></a>02128         <span class="comment">//</span>
<a name="l02129"></a>02129         <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a74c921b3840ba9d08eabd9de16401bd2">USB_O_RXMAXP1</a>) =
<a name="l02130"></a>02130             ui32MaxPacketSize;
<a name="l02131"></a>02131 
<a name="l02132"></a>02132         <span class="comment">//</span>
<a name="l02133"></a>02133         <span class="comment">// The receive control value is zero unless options are enabled.</span>
<a name="l02134"></a>02134         <span class="comment">//</span>
<a name="l02135"></a>02135         ui32Register = 0;
<a name="l02136"></a>02136 
<a name="l02137"></a>02137         <span class="comment">//</span>
<a name="l02138"></a>02138         <span class="comment">// Allow auto clearing of RxPktRdy when packet of size max packet</span>
<a name="l02139"></a>02139         <span class="comment">// has been unloaded from the FIFO.</span>
<a name="l02140"></a>02140         <span class="comment">//</span>
<a name="l02141"></a>02141         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ac6ffbe05755a887eff3bee31239d76ee">USB_EP_AUTO_CLEAR</a>)
<a name="l02142"></a>02142         {
<a name="l02143"></a>02143             ui32Register = <a class="code" href="hw__usb_8h.html#a3f19fc8cbdc83cd742276b0787c0705f">USB_RXCSRH1_AUTOCL</a>;
<a name="l02144"></a>02144         }
<a name="l02145"></a>02145 
<a name="l02146"></a>02146         <span class="comment">//</span>
<a name="l02147"></a>02147         <span class="comment">// Configure the DMA mode.</span>
<a name="l02148"></a>02148         <span class="comment">//</span>
<a name="l02149"></a>02149         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>)
<a name="l02150"></a>02150         {
<a name="l02151"></a>02151             ui32Register |= <a class="code" href="hw__usb_8h.html#a77d6133e3e9658960e4bf88ea5e98219">USB_RXCSRH1_DMAEN</a> | <a class="code" href="hw__usb_8h.html#a765b6bd345468708035e8c6d4efd8a29">USB_RXCSRH1_DMAMOD</a>;
<a name="l02152"></a>02152         }
<a name="l02153"></a>02153         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ab35e7f9177cbd7f7c6af3319d936c1d3">USB_EP_DMA_MODE_0</a>)
<a name="l02154"></a>02154         {
<a name="l02155"></a>02155             ui32Register |= <a class="code" href="hw__usb_8h.html#a77d6133e3e9658960e4bf88ea5e98219">USB_RXCSRH1_DMAEN</a>;
<a name="l02156"></a>02156         }
<a name="l02157"></a>02157 
<a name="l02158"></a>02158         <span class="comment">//</span>
<a name="l02159"></a>02159         <span class="comment">// If requested, disable NYET responses for high-speed bulk and</span>
<a name="l02160"></a>02160         <span class="comment">// interrupt endpoints.</span>
<a name="l02161"></a>02161         <span class="comment">//</span>
<a name="l02162"></a>02162         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#ada00401c28ff54d738c82aaab7a040bb">USB_EP_DIS_NYET</a>)
<a name="l02163"></a>02163         {
<a name="l02164"></a>02164             ui32Register |= <a class="code" href="hw__usb_8h.html#a6c83ed4e64462e78c83dd403118c842d">USB_RXCSRH1_DISNYET</a>;
<a name="l02165"></a>02165         }
<a name="l02166"></a>02166 
<a name="l02167"></a>02167         <span class="comment">//</span>
<a name="l02168"></a>02168         <span class="comment">// Enable isochronous mode if requested.</span>
<a name="l02169"></a>02169         <span class="comment">//</span>
<a name="l02170"></a>02170         <span class="keywordflow">if</span>((ui32Flags &amp; <a class="code" href="usb_8h.html#ac4867149a95bf62b061dc3149c6eb596">USB_EP_MODE_MASK</a>) == <a class="code" href="usb_8h.html#a12885dc6ed4485c48d871c639cc6f952">USB_EP_MODE_ISOC</a>)
<a name="l02171"></a>02171         {
<a name="l02172"></a>02172             ui32Register |= <a class="code" href="hw__usb_8h.html#a423af9f584de17f1261b1736e3e0b98b">USB_RXCSRH1_ISO</a>;
<a name="l02173"></a>02173         }
<a name="l02174"></a>02174 
<a name="l02175"></a>02175         <span class="comment">//</span>
<a name="l02176"></a>02176         <span class="comment">// Write the receive control value.</span>
<a name="l02177"></a>02177         <span class="comment">//</span>
<a name="l02178"></a>02178         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a>) =
<a name="l02179"></a>02179             (uint8_t)ui32Register;
<a name="l02180"></a>02180 
<a name="l02181"></a>02181         <span class="comment">//</span>
<a name="l02182"></a>02182         <span class="comment">// Reset the Data toggle to zero.</span>
<a name="l02183"></a>02183         <span class="comment">//</span>
<a name="l02184"></a>02184         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a>) =
<a name="l02185"></a>02185             <a class="code" href="hw__usb_8h.html#aee0bc3c1d82b61a1fabab0e5347f052c">USB_RXCSRL1_CLRDT</a>;
<a name="l02186"></a>02186     }
<a name="l02187"></a>02187 }
<a name="l02188"></a>02188 
<a name="l02189"></a>02189 <span class="comment">//*****************************************************************************</span>
<a name="l02190"></a>02190 <span class="comment">//</span>
<a name="l02210"></a>02210 <span class="comment"></span><span class="comment">//</span>
<a name="l02211"></a>02211 <span class="comment">//*****************************************************************************</span>
<a name="l02212"></a>02212 <span class="keywordtype">void</span>
<a name="l02213"></a><a class="code" href="group__usb__api.html#gac2e45712bd23adbcbe650b8cb2a3e4d9">02213</a> <a class="code" href="group__usb__api.html#gac2e45712bd23adbcbe650b8cb2a3e4d9">USBDevEndpointConfigGet</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02214"></a>02214                         uint32_t *pui32MaxPacketSize, uint32_t *pui32Flags)
<a name="l02215"></a>02215 {
<a name="l02216"></a>02216     uint32_t ui32Register;
<a name="l02217"></a>02217 
<a name="l02218"></a>02218     <span class="comment">//</span>
<a name="l02219"></a>02219     <span class="comment">// Check the arguments.</span>
<a name="l02220"></a>02220     <span class="comment">//</span>
<a name="l02221"></a>02221     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02222"></a>02222     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(pui32MaxPacketSize &amp;&amp; pui32Flags);
<a name="l02223"></a>02223     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) ||
<a name="l02224"></a>02224            (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) ||
<a name="l02225"></a>02225            (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) ||
<a name="l02226"></a>02226            (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02227"></a>02227 
<a name="l02228"></a>02228     <span class="comment">//</span>
<a name="l02229"></a>02229     <span class="comment">// Determine if a transmit or receive endpoint is being queried.</span>
<a name="l02230"></a>02230     <span class="comment">//</span>
<a name="l02231"></a>02231     <span class="keywordflow">if</span>(*pui32Flags &amp; <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>)
<a name="l02232"></a>02232     {
<a name="l02233"></a>02233         <span class="comment">//</span>
<a name="l02234"></a>02234         <span class="comment">// Clear the flags other than the direction bit.</span>
<a name="l02235"></a>02235         <span class="comment">//</span>
<a name="l02236"></a>02236         *pui32Flags = <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>;
<a name="l02237"></a>02237 
<a name="l02238"></a>02238         <span class="comment">//</span>
<a name="l02239"></a>02239         <span class="comment">// Get the maximum packet size.</span>
<a name="l02240"></a>02240         <span class="comment">//</span>
<a name="l02241"></a>02241         *pui32MaxPacketSize = (uint32_t)<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base +
<a name="l02242"></a>02242                                                <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) +
<a name="l02243"></a>02243                                                <a class="code" href="hw__usb_8h.html#a10a3276cbd2ee4806cbe3e0f4840b578">USB_O_TXMAXP1</a>);
<a name="l02244"></a>02244 
<a name="l02245"></a>02245         <span class="comment">//</span>
<a name="l02246"></a>02246         <span class="comment">// Get the current transmit control register value.</span>
<a name="l02247"></a>02247         <span class="comment">//</span>
<a name="l02248"></a>02248         ui32Register = (uint32_t)<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) +
<a name="l02249"></a>02249                                         <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a>);
<a name="l02250"></a>02250 
<a name="l02251"></a>02251         <span class="comment">//</span>
<a name="l02252"></a>02252         <span class="comment">// Are we allowing auto setting of TxPktRdy when max packet size has</span>
<a name="l02253"></a>02253         <span class="comment">// been loaded into the FIFO?</span>
<a name="l02254"></a>02254         <span class="comment">//</span>
<a name="l02255"></a>02255         <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#a6a74dc0cf7f4010a9562834742a12569">USB_TXCSRH1_AUTOSET</a>)
<a name="l02256"></a>02256         {
<a name="l02257"></a>02257             *pui32Flags |= <a class="code" href="usb_8h.html#af83d520bf70b794bd74c9e2f8573e7ab">USB_EP_AUTO_SET</a>;
<a name="l02258"></a>02258         }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260         <span class="comment">//</span>
<a name="l02261"></a>02261         <span class="comment">// Get the DMA mode.</span>
<a name="l02262"></a>02262         <span class="comment">//</span>
<a name="l02263"></a>02263         <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#a70a09d67fe2b11247e013449470a04d0">USB_TXCSRH1_DMAEN</a>)
<a name="l02264"></a>02264         {
<a name="l02265"></a>02265             <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#abd420b366edbcda207b59235e060eea6">USB_TXCSRH1_DMAMOD</a>)
<a name="l02266"></a>02266             {
<a name="l02267"></a>02267                 *pui32Flags |= <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>;
<a name="l02268"></a>02268             }
<a name="l02269"></a>02269             <span class="keywordflow">else</span>
<a name="l02270"></a>02270             {
<a name="l02271"></a>02271                 *pui32Flags |= <a class="code" href="usb_8h.html#ab35e7f9177cbd7f7c6af3319d936c1d3">USB_EP_DMA_MODE_0</a>;
<a name="l02272"></a>02272             }
<a name="l02273"></a>02273         }
<a name="l02274"></a>02274 
<a name="l02275"></a>02275         <span class="comment">//</span>
<a name="l02276"></a>02276         <span class="comment">// Are we in isochronous mode?</span>
<a name="l02277"></a>02277         <span class="comment">//</span>
<a name="l02278"></a>02278         <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#aa7f88966e1ed96f9874b97457f8e3aa9">USB_TXCSRH1_ISO</a>)
<a name="l02279"></a>02279         {
<a name="l02280"></a>02280             *pui32Flags |= <a class="code" href="usb_8h.html#a12885dc6ed4485c48d871c639cc6f952">USB_EP_MODE_ISOC</a>;
<a name="l02281"></a>02281         }
<a name="l02282"></a>02282         <span class="keywordflow">else</span>
<a name="l02283"></a>02283         {
<a name="l02284"></a>02284             <span class="comment">//</span>
<a name="l02285"></a>02285             <span class="comment">// The hardware doesn&#39;t differentiate between bulk, interrupt</span>
<a name="l02286"></a>02286             <span class="comment">// and control mode for the endpoint so we just set something</span>
<a name="l02287"></a>02287             <span class="comment">// that isn&#39;t isochronous.  This protocol ensures that anyone</span>
<a name="l02288"></a>02288             <span class="comment">// modifying the returned flags in preparation for a call to</span>
<a name="l02289"></a>02289             <span class="comment">// USBDevEndpointConfigSet do not see an unexpected mode change.</span>
<a name="l02290"></a>02290             <span class="comment">// If they decode the returned mode, however, they may be in for</span>
<a name="l02291"></a>02291             <span class="comment">// a surprise.</span>
<a name="l02292"></a>02292             <span class="comment">//</span>
<a name="l02293"></a>02293             *pui32Flags |= <a class="code" href="usb_8h.html#aa6159888b439bfb438c8e5d898214922">USB_EP_MODE_BULK</a>;
<a name="l02294"></a>02294         }
<a name="l02295"></a>02295     }
<a name="l02296"></a>02296     <span class="keywordflow">else</span>
<a name="l02297"></a>02297     {
<a name="l02298"></a>02298         <span class="comment">//</span>
<a name="l02299"></a>02299         <span class="comment">// Clear the flags other than the direction bit.</span>
<a name="l02300"></a>02300         <span class="comment">//</span>
<a name="l02301"></a>02301         *pui32Flags = <a class="code" href="usb_8h.html#a7f1336c270a8ee96a67edef7f124e5ba">USB_EP_DEV_OUT</a>;
<a name="l02302"></a>02302 
<a name="l02303"></a>02303         <span class="comment">//</span>
<a name="l02304"></a>02304         <span class="comment">// Get the MaxPacketSize.</span>
<a name="l02305"></a>02305         <span class="comment">//</span>
<a name="l02306"></a>02306         *pui32MaxPacketSize = (uint32_t)<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base +
<a name="l02307"></a>02307                                                <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) +
<a name="l02308"></a>02308                                                <a class="code" href="hw__usb_8h.html#a74c921b3840ba9d08eabd9de16401bd2">USB_O_RXMAXP1</a>);
<a name="l02309"></a>02309 
<a name="l02310"></a>02310         <span class="comment">//</span>
<a name="l02311"></a>02311         <span class="comment">// Get the current receive control register value.</span>
<a name="l02312"></a>02312         <span class="comment">//</span>
<a name="l02313"></a>02313         ui32Register = (uint32_t)<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) +
<a name="l02314"></a>02314                                         <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a>);
<a name="l02315"></a>02315 
<a name="l02316"></a>02316         <span class="comment">//</span>
<a name="l02317"></a>02317         <span class="comment">// Are we allowing auto clearing of RxPktRdy when packet of size max</span>
<a name="l02318"></a>02318         <span class="comment">// packet has been unloaded from the FIFO?</span>
<a name="l02319"></a>02319         <span class="comment">//</span>
<a name="l02320"></a>02320         <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#a3f19fc8cbdc83cd742276b0787c0705f">USB_RXCSRH1_AUTOCL</a>)
<a name="l02321"></a>02321         {
<a name="l02322"></a>02322             *pui32Flags |= <a class="code" href="usb_8h.html#ac6ffbe05755a887eff3bee31239d76ee">USB_EP_AUTO_CLEAR</a>;
<a name="l02323"></a>02323         }
<a name="l02324"></a>02324 
<a name="l02325"></a>02325         <span class="comment">//</span>
<a name="l02326"></a>02326         <span class="comment">// Get the DMA mode.</span>
<a name="l02327"></a>02327         <span class="comment">//</span>
<a name="l02328"></a>02328         <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#a77d6133e3e9658960e4bf88ea5e98219">USB_RXCSRH1_DMAEN</a>)
<a name="l02329"></a>02329         {
<a name="l02330"></a>02330             <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#a765b6bd345468708035e8c6d4efd8a29">USB_RXCSRH1_DMAMOD</a>)
<a name="l02331"></a>02331             {
<a name="l02332"></a>02332                 *pui32Flags |= <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>;
<a name="l02333"></a>02333             }
<a name="l02334"></a>02334             <span class="keywordflow">else</span>
<a name="l02335"></a>02335             {
<a name="l02336"></a>02336                 *pui32Flags |= <a class="code" href="usb_8h.html#ab35e7f9177cbd7f7c6af3319d936c1d3">USB_EP_DMA_MODE_0</a>;
<a name="l02337"></a>02337             }
<a name="l02338"></a>02338         }
<a name="l02339"></a>02339 
<a name="l02340"></a>02340         <span class="comment">//</span>
<a name="l02341"></a>02341         <span class="comment">// Are we in isochronous mode?</span>
<a name="l02342"></a>02342         <span class="comment">//</span>
<a name="l02343"></a>02343         <span class="keywordflow">if</span>(ui32Register &amp; <a class="code" href="hw__usb_8h.html#a423af9f584de17f1261b1736e3e0b98b">USB_RXCSRH1_ISO</a>)
<a name="l02344"></a>02344         {
<a name="l02345"></a>02345             *pui32Flags |= <a class="code" href="usb_8h.html#a12885dc6ed4485c48d871c639cc6f952">USB_EP_MODE_ISOC</a>;
<a name="l02346"></a>02346         }
<a name="l02347"></a>02347         <span class="keywordflow">else</span>
<a name="l02348"></a>02348         {
<a name="l02349"></a>02349             <span class="comment">//</span>
<a name="l02350"></a>02350             <span class="comment">// The hardware doesn&#39;t differentiate between bulk, interrupt</span>
<a name="l02351"></a>02351             <span class="comment">// and control mode for the endpoint so we just set something</span>
<a name="l02352"></a>02352             <span class="comment">// that isn&#39;t isochronous.  This protocol ensures that anyone</span>
<a name="l02353"></a>02353             <span class="comment">// modifying the returned flags in preparation for a call to</span>
<a name="l02354"></a>02354             <span class="comment">// USBDevEndpointConfigSet do not see an unexpected mode change.</span>
<a name="l02355"></a>02355             <span class="comment">// If they decode the returned mode, however, they may be in for</span>
<a name="l02356"></a>02356             <span class="comment">// a surprise.</span>
<a name="l02357"></a>02357             <span class="comment">//</span>
<a name="l02358"></a>02358             *pui32Flags |= <a class="code" href="usb_8h.html#aa6159888b439bfb438c8e5d898214922">USB_EP_MODE_BULK</a>;
<a name="l02359"></a>02359         }
<a name="l02360"></a>02360     }
<a name="l02361"></a>02361 }
<a name="l02362"></a>02362 
<a name="l02363"></a>02363 <span class="comment">//*****************************************************************************</span>
<a name="l02364"></a>02364 <span class="comment">//</span>
<a name="l02390"></a>02390 <span class="comment"></span><span class="comment">//</span>
<a name="l02391"></a>02391 <span class="comment">//*****************************************************************************</span>
<a name="l02392"></a>02392 <span class="keywordtype">void</span>
<a name="l02393"></a><a class="code" href="group__usb__api.html#ga8177751d5f16390d8d6c5f10df790114">02393</a> <a class="code" href="group__usb__api.html#ga8177751d5f16390d8d6c5f10df790114">USBFIFOConfigSet</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02394"></a>02394                  uint32_t ui32FIFOAddress, uint32_t ui32FIFOSize,
<a name="l02395"></a>02395                  uint32_t ui32Flags)
<a name="l02396"></a>02396 {
<a name="l02397"></a>02397     <span class="comment">//</span>
<a name="l02398"></a>02398     <span class="comment">// Check the arguments.</span>
<a name="l02399"></a>02399     <span class="comment">//</span>
<a name="l02400"></a>02400     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02401"></a>02401     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) ||
<a name="l02402"></a>02402            (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) ||
<a name="l02403"></a>02403            (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) ||
<a name="l02404"></a>02404            (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02405"></a>02405 
<a name="l02406"></a>02406     <span class="comment">//</span>
<a name="l02407"></a>02407     <span class="comment">// See if the transmit or receive FIFO is being configured.</span>
<a name="l02408"></a>02408     <span class="comment">//</span>
<a name="l02409"></a>02409     <span class="keywordflow">if</span>(ui32Flags &amp; (<a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a> | <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>))
<a name="l02410"></a>02410     {
<a name="l02411"></a>02411         <span class="comment">//</span>
<a name="l02412"></a>02412         <span class="comment">// Set the transmit FIFO location and size for this endpoint.</span>
<a name="l02413"></a>02413         <span class="comment">//</span>
<a name="l02414"></a>02414         <a class="code" href="group__usb__api.html#gad79a9385143d09823224d3715f63e412">_USBIndexWrite</a>(ui32Base, ui32Endpoint &gt;&gt; 4, <a class="code" href="hw__usb_8h.html#a345060ad67afacef7f55cb55c88fe15d">USB_O_TXFIFOSZ</a>,
<a name="l02415"></a>02415                        ui32FIFOSize, 1);
<a name="l02416"></a>02416         <a class="code" href="group__usb__api.html#gad79a9385143d09823224d3715f63e412">_USBIndexWrite</a>(ui32Base, ui32Endpoint &gt;&gt; 4, <a class="code" href="hw__usb_8h.html#afb2c865cee8b265a40a417574efd6a48">USB_O_TXFIFOADD</a>,
<a name="l02417"></a>02417                        ui32FIFOAddress &gt;&gt; 3, 2);
<a name="l02418"></a>02418     }
<a name="l02419"></a>02419     <span class="keywordflow">else</span>
<a name="l02420"></a>02420     {
<a name="l02421"></a>02421         <span class="comment">//</span>
<a name="l02422"></a>02422         <span class="comment">// Set the receive FIFO location and size for this endpoint.</span>
<a name="l02423"></a>02423         <span class="comment">//</span>
<a name="l02424"></a>02424         <a class="code" href="group__usb__api.html#gad79a9385143d09823224d3715f63e412">_USBIndexWrite</a>(ui32Base, ui32Endpoint &gt;&gt; 4, <a class="code" href="hw__usb_8h.html#a4bcd804209bea8adc4660e0465e0e1bb">USB_O_RXFIFOSZ</a>,
<a name="l02425"></a>02425                        ui32FIFOSize, 1);
<a name="l02426"></a>02426         <a class="code" href="group__usb__api.html#gad79a9385143d09823224d3715f63e412">_USBIndexWrite</a>(ui32Base, ui32Endpoint &gt;&gt; 4, <a class="code" href="hw__usb_8h.html#a5317604651a6b46ad7e1e41ac5395af5">USB_O_RXFIFOADD</a>,
<a name="l02427"></a>02427                        ui32FIFOAddress &gt;&gt; 3, 2);
<a name="l02428"></a>02428     }
<a name="l02429"></a>02429 }
<a name="l02430"></a>02430 
<a name="l02431"></a>02431 <span class="comment">//*****************************************************************************</span>
<a name="l02432"></a>02432 <span class="comment">//</span>
<a name="l02453"></a>02453 <span class="comment"></span><span class="comment">//</span>
<a name="l02454"></a>02454 <span class="comment">//*****************************************************************************</span>
<a name="l02455"></a>02455 <span class="keywordtype">void</span>
<a name="l02456"></a><a class="code" href="group__usb__api.html#gafe99418aac4282546bca96be57580ec1">02456</a> <a class="code" href="group__usb__api.html#gafe99418aac4282546bca96be57580ec1">USBFIFOConfigGet</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02457"></a>02457                  uint32_t *pui32FIFOAddress, uint32_t *pui32FIFOSize,
<a name="l02458"></a>02458                  uint32_t ui32Flags)
<a name="l02459"></a>02459 {
<a name="l02460"></a>02460     <span class="comment">//</span>
<a name="l02461"></a>02461     <span class="comment">// Check the arguments.</span>
<a name="l02462"></a>02462     <span class="comment">//</span>
<a name="l02463"></a>02463     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02464"></a>02464     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) ||
<a name="l02465"></a>02465            (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) ||
<a name="l02466"></a>02466            (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) ||
<a name="l02467"></a>02467            (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02468"></a>02468 
<a name="l02469"></a>02469     <span class="comment">//</span>
<a name="l02470"></a>02470     <span class="comment">// See if the transmit or receive FIFO is being configured.</span>
<a name="l02471"></a>02471     <span class="comment">//</span>
<a name="l02472"></a>02472     <span class="keywordflow">if</span>(ui32Flags &amp; (<a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a> | <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>))
<a name="l02473"></a>02473     {
<a name="l02474"></a>02474         <span class="comment">//</span>
<a name="l02475"></a>02475         <span class="comment">// Get the transmit FIFO location and size for this endpoint.</span>
<a name="l02476"></a>02476         <span class="comment">//</span>
<a name="l02477"></a>02477         *pui32FIFOAddress = (<a class="code" href="group__usb__api.html#gac3b3f5b56ebdcc078407fd787afcafae">_USBIndexRead</a>(ui32Base, ui32Endpoint &gt;&gt; 4,
<a name="l02478"></a>02478                                            (uint32_t)<a class="code" href="hw__usb_8h.html#afb2c865cee8b265a40a417574efd6a48">USB_O_TXFIFOADD</a>,
<a name="l02479"></a>02479                                            2)) &lt;&lt; 3;
<a name="l02480"></a>02480         *pui32FIFOSize = <a class="code" href="group__usb__api.html#gac3b3f5b56ebdcc078407fd787afcafae">_USBIndexRead</a>(ui32Base, ui32Endpoint &gt;&gt; 4,
<a name="l02481"></a>02481                                        (uint32_t)<a class="code" href="hw__usb_8h.html#a345060ad67afacef7f55cb55c88fe15d">USB_O_TXFIFOSZ</a>, 1);
<a name="l02482"></a>02482     }
<a name="l02483"></a>02483     <span class="keywordflow">else</span>
<a name="l02484"></a>02484     {
<a name="l02485"></a>02485         <span class="comment">//</span>
<a name="l02486"></a>02486         <span class="comment">// Get the receive FIFO location and size for this endpoint.</span>
<a name="l02487"></a>02487         <span class="comment">//</span>
<a name="l02488"></a>02488         *pui32FIFOAddress = (<a class="code" href="group__usb__api.html#gac3b3f5b56ebdcc078407fd787afcafae">_USBIndexRead</a>(ui32Base, ui32Endpoint &gt;&gt; 4,
<a name="l02489"></a>02489                                            (uint32_t)<a class="code" href="hw__usb_8h.html#a5317604651a6b46ad7e1e41ac5395af5">USB_O_RXFIFOADD</a>,
<a name="l02490"></a>02490                                            2)) &lt;&lt; 3;
<a name="l02491"></a>02491         *pui32FIFOSize = <a class="code" href="group__usb__api.html#gac3b3f5b56ebdcc078407fd787afcafae">_USBIndexRead</a>(ui32Base, ui32Endpoint &gt;&gt; 4,
<a name="l02492"></a>02492                                        (uint32_t)<a class="code" href="hw__usb_8h.html#a4bcd804209bea8adc4660e0465e0e1bb">USB_O_RXFIFOSZ</a>, 1);
<a name="l02493"></a>02493     }
<a name="l02494"></a>02494 }
<a name="l02495"></a>02495 
<a name="l02496"></a>02496 <span class="comment">//*****************************************************************************</span>
<a name="l02497"></a>02497 <span class="comment">//</span>
<a name="l02571"></a>02571 <span class="comment"></span><span class="comment">//</span>
<a name="l02572"></a>02572 <span class="comment">//*****************************************************************************</span>
<a name="l02573"></a>02573 <span class="keywordtype">void</span>
<a name="l02574"></a><a class="code" href="group__usb__api.html#ga556aca2133c892662883dd8b9577430e">02574</a> <a class="code" href="group__usb__api.html#ga556aca2133c892662883dd8b9577430e">USBEndpointDMAConfigSet</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02575"></a>02575                         uint32_t ui32Config)
<a name="l02576"></a>02576 {
<a name="l02577"></a>02577     uint32_t ui32NewConfig;
<a name="l02578"></a>02578 
<a name="l02579"></a>02579     <span class="keywordflow">if</span>(ui32Config &amp; <a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a>)
<a name="l02580"></a>02580     {
<a name="l02581"></a>02581         <span class="comment">//</span>
<a name="l02582"></a>02582         <span class="comment">// Clear mode and DMA enable.</span>
<a name="l02583"></a>02583         <span class="comment">//</span>
<a name="l02584"></a>02584         ui32NewConfig =
<a name="l02585"></a>02585             (<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a>) &amp;
<a name="l02586"></a>02586              ~(<a class="code" href="hw__usb_8h.html#abd420b366edbcda207b59235e060eea6">USB_TXCSRH1_DMAMOD</a> | <a class="code" href="hw__usb_8h.html#a6a74dc0cf7f4010a9562834742a12569">USB_TXCSRH1_AUTOSET</a>));
<a name="l02587"></a>02587 
<a name="l02588"></a>02588         <span class="keywordflow">if</span>(ui32Config &amp; <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>)
<a name="l02589"></a>02589         {
<a name="l02590"></a>02590             ui32NewConfig |= <a class="code" href="hw__usb_8h.html#abd420b366edbcda207b59235e060eea6">USB_TXCSRH1_DMAMOD</a>;
<a name="l02591"></a>02591         }
<a name="l02592"></a>02592 
<a name="l02593"></a>02593         <span class="keywordflow">if</span>(ui32Config &amp; <a class="code" href="usb_8h.html#af83d520bf70b794bd74c9e2f8573e7ab">USB_EP_AUTO_SET</a>)
<a name="l02594"></a>02594         {
<a name="l02595"></a>02595             ui32NewConfig |= <a class="code" href="hw__usb_8h.html#a6a74dc0cf7f4010a9562834742a12569">USB_TXCSRH1_AUTOSET</a>;
<a name="l02596"></a>02596         }
<a name="l02597"></a>02597 
<a name="l02598"></a>02598         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a>) =
<a name="l02599"></a>02599             ui32NewConfig;
<a name="l02600"></a>02600     }
<a name="l02601"></a>02601     <span class="keywordflow">else</span>
<a name="l02602"></a>02602     {
<a name="l02603"></a>02603         ui32NewConfig =
<a name="l02604"></a>02604             (<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a>) &amp;
<a name="l02605"></a>02605              ~(<a class="code" href="hw__usb_8h.html#ace44928f33d51fdb2ea895982f810c9d">USB_RXCSRH1_AUTORQ</a> | <a class="code" href="hw__usb_8h.html#a3f19fc8cbdc83cd742276b0787c0705f">USB_RXCSRH1_AUTOCL</a> | <a class="code" href="hw__usb_8h.html#a765b6bd345468708035e8c6d4efd8a29">USB_RXCSRH1_DMAMOD</a>));
<a name="l02606"></a>02606 
<a name="l02607"></a>02607         <span class="keywordflow">if</span>(ui32Config &amp; <a class="code" href="usb_8h.html#a259f82df7349fa5e07fb80726e5de017">USB_EP_DMA_MODE_1</a>)
<a name="l02608"></a>02608         {
<a name="l02609"></a>02609             ui32NewConfig |= <a class="code" href="hw__usb_8h.html#a765b6bd345468708035e8c6d4efd8a29">USB_RXCSRH1_DMAMOD</a>;
<a name="l02610"></a>02610         }
<a name="l02611"></a>02611 
<a name="l02612"></a>02612         <span class="keywordflow">if</span>(ui32Config &amp; <a class="code" href="usb_8h.html#ac6ffbe05755a887eff3bee31239d76ee">USB_EP_AUTO_CLEAR</a>)
<a name="l02613"></a>02613         {
<a name="l02614"></a>02614             ui32NewConfig |= <a class="code" href="hw__usb_8h.html#a3f19fc8cbdc83cd742276b0787c0705f">USB_RXCSRH1_AUTOCL</a>;
<a name="l02615"></a>02615         }
<a name="l02616"></a>02616         <span class="keywordflow">if</span>(ui32Config &amp; <a class="code" href="usb_8h.html#a6fdc385936265c4f00b1582e9ea0a230">USB_EP_AUTO_REQUEST</a>)
<a name="l02617"></a>02617         {
<a name="l02618"></a>02618             ui32NewConfig |= <a class="code" href="hw__usb_8h.html#ace44928f33d51fdb2ea895982f810c9d">USB_RXCSRH1_AUTORQ</a>;
<a name="l02619"></a>02619         }
<a name="l02620"></a>02620         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a>) =
<a name="l02621"></a>02621             ui32NewConfig;
<a name="l02622"></a>02622     }
<a name="l02623"></a>02623 }
<a name="l02624"></a>02624 
<a name="l02625"></a>02625 <span class="comment">//*****************************************************************************</span>
<a name="l02626"></a>02626 <span class="comment">//</span>
<a name="l02644"></a>02644 <span class="comment"></span><span class="comment">//</span>
<a name="l02645"></a>02645 <span class="comment">//*****************************************************************************</span>
<a name="l02646"></a>02646 <span class="keywordtype">void</span>
<a name="l02647"></a><a class="code" href="group__usb__api.html#gad067c05a3f666bfb42400c8fef3c755b">02647</a> <a class="code" href="group__usb__api.html#gad067c05a3f666bfb42400c8fef3c755b">USBEndpointDMAEnable</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02648"></a>02648                      uint32_t ui32Flags)
<a name="l02649"></a>02649 {
<a name="l02650"></a>02650     <span class="comment">//</span>
<a name="l02651"></a>02651     <span class="comment">// See if the transmit DMA is being enabled.</span>
<a name="l02652"></a>02652     <span class="comment">//</span>
<a name="l02653"></a>02653     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>)
<a name="l02654"></a>02654     {
<a name="l02655"></a>02655         <span class="comment">//</span>
<a name="l02656"></a>02656         <span class="comment">// Enable DMA on the transmit endpoint.</span>
<a name="l02657"></a>02657         <span class="comment">//</span>
<a name="l02658"></a>02658         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a>) |=
<a name="l02659"></a>02659             <a class="code" href="hw__usb_8h.html#a70a09d67fe2b11247e013449470a04d0">USB_TXCSRH1_DMAEN</a>;
<a name="l02660"></a>02660     }
<a name="l02661"></a>02661     <span class="keywordflow">else</span>
<a name="l02662"></a>02662     {
<a name="l02663"></a>02663         <span class="comment">//</span>
<a name="l02664"></a>02664         <span class="comment">// Enable DMA on the receive endpoint.</span>
<a name="l02665"></a>02665         <span class="comment">//</span>
<a name="l02666"></a>02666         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a>) |=
<a name="l02667"></a>02667             <a class="code" href="hw__usb_8h.html#a77d6133e3e9658960e4bf88ea5e98219">USB_RXCSRH1_DMAEN</a>;
<a name="l02668"></a>02668     }
<a name="l02669"></a>02669 }
<a name="l02670"></a>02670 
<a name="l02671"></a>02671 <span class="comment">//*****************************************************************************</span>
<a name="l02672"></a>02672 <span class="comment">//</span>
<a name="l02684"></a>02684 <span class="comment"></span><span class="comment">//</span>
<a name="l02685"></a>02685 <span class="comment">//*****************************************************************************</span>
<a name="l02686"></a>02686 <span class="keywordtype">void</span>
<a name="l02687"></a><a class="code" href="group__usb__api.html#gae14b016b39b362515fe7d55abd451566">02687</a> <a class="code" href="group__usb__api.html#gae14b016b39b362515fe7d55abd451566">USBEndpointDMADisable</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02688"></a>02688                       uint32_t ui32Flags)
<a name="l02689"></a>02689 {
<a name="l02690"></a>02690     <span class="comment">//</span>
<a name="l02691"></a>02691     <span class="comment">// If this was a request to disable DMA on the IN portion of the endpoint</span>
<a name="l02692"></a>02692     <span class="comment">// then handle it.</span>
<a name="l02693"></a>02693     <span class="comment">//</span>
<a name="l02694"></a>02694     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>)
<a name="l02695"></a>02695     {
<a name="l02696"></a>02696         <span class="comment">//</span>
<a name="l02697"></a>02697         <span class="comment">// Just disable DMA leave the mode setting.</span>
<a name="l02698"></a>02698         <span class="comment">//</span>
<a name="l02699"></a>02699         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#aa2d73dc23a25ea5d43b680cedfbf191e">USB_O_TXCSRH1</a>) &amp;=
<a name="l02700"></a>02700             ~<a class="code" href="hw__usb_8h.html#a70a09d67fe2b11247e013449470a04d0">USB_TXCSRH1_DMAEN</a>;
<a name="l02701"></a>02701     }
<a name="l02702"></a>02702     <span class="keywordflow">else</span>
<a name="l02703"></a>02703     {
<a name="l02704"></a>02704         <span class="comment">//</span>
<a name="l02705"></a>02705         <span class="comment">// Just disable DMA leave the mode setting.</span>
<a name="l02706"></a>02706         <span class="comment">//</span>
<a name="l02707"></a>02707         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint) + <a class="code" href="hw__usb_8h.html#af953e2449fe4e26a4a805200be97b03c">USB_O_RXCSRH1</a>) &amp;=
<a name="l02708"></a>02708             ~<a class="code" href="hw__usb_8h.html#a77d6133e3e9658960e4bf88ea5e98219">USB_RXCSRH1_DMAEN</a>;
<a name="l02709"></a>02709     }
<a name="l02710"></a>02710 }
<a name="l02711"></a>02711 
<a name="l02712"></a>02712 <span class="comment">//*****************************************************************************</span>
<a name="l02713"></a>02713 <span class="comment">//</span>
<a name="l02727"></a>02727 <span class="comment"></span><span class="comment">//</span>
<a name="l02728"></a>02728 <span class="comment">//*****************************************************************************</span>
<a name="l02729"></a>02729 uint32_t
<a name="l02730"></a><a class="code" href="group__usb__api.html#ga1ec6376b4d4091ccd5366444cc15d0c6">02730</a> <a class="code" href="group__usb__api.html#ga1ec6376b4d4091ccd5366444cc15d0c6">USBEndpointDataAvail</a>(uint32_t ui32Base, uint32_t ui32Endpoint)
<a name="l02731"></a>02731 {
<a name="l02732"></a>02732     uint32_t ui32Register;
<a name="l02733"></a>02733 
<a name="l02734"></a>02734     <span class="comment">//</span>
<a name="l02735"></a>02735     <span class="comment">// Check the arguments.</span>
<a name="l02736"></a>02736     <span class="comment">//</span>
<a name="l02737"></a>02737     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02738"></a>02738     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l02739"></a>02739            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l02740"></a>02740            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l02741"></a>02741            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02742"></a>02742 
<a name="l02743"></a>02743     <span class="comment">//</span>
<a name="l02744"></a>02744     <span class="comment">// Get the address of the receive status register to use, based on the</span>
<a name="l02745"></a>02745     <span class="comment">// endpoint.</span>
<a name="l02746"></a>02746     <span class="comment">//</span>
<a name="l02747"></a>02747     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l02748"></a>02748     {
<a name="l02749"></a>02749         ui32Register = <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>;
<a name="l02750"></a>02750     }
<a name="l02751"></a>02751     <span class="keywordflow">else</span>
<a name="l02752"></a>02752     {
<a name="l02753"></a>02753         ui32Register = <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint);
<a name="l02754"></a>02754     }
<a name="l02755"></a>02755 
<a name="l02756"></a>02756     <span class="comment">//</span>
<a name="l02757"></a>02757     <span class="comment">// Is there a packet ready in the FIFO?</span>
<a name="l02758"></a>02758     <span class="comment">//</span>
<a name="l02759"></a>02759     <span class="keywordflow">if</span>((<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + ui32Register) &amp; <a class="code" href="hw__usb_8h.html#aa46f20c660cc47f9b3d8f9feace51914">USB_CSRL0_RXRDY</a>) == 0)
<a name="l02760"></a>02760     {
<a name="l02761"></a>02761         <span class="keywordflow">return</span>(0);
<a name="l02762"></a>02762     }
<a name="l02763"></a>02763 
<a name="l02764"></a>02764     <span class="comment">//</span>
<a name="l02765"></a>02765     <span class="comment">// Return the byte count in the FIFO.</span>
<a name="l02766"></a>02766     <span class="comment">//</span>
<a name="l02767"></a>02767     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a1cb5bf9dcee48cd3ad0417dbeb1b0e11">USB_O_COUNT0</a> + ui32Endpoint));
<a name="l02768"></a>02768 }
<a name="l02769"></a>02769 
<a name="l02770"></a>02770 <span class="comment">//*****************************************************************************</span>
<a name="l02771"></a>02771 <span class="comment">//</span>
<a name="l02791"></a>02791 <span class="comment"></span><span class="comment">//</span>
<a name="l02792"></a>02792 <span class="comment">//*****************************************************************************</span>
<a name="l02793"></a>02793 int32_t
<a name="l02794"></a><a class="code" href="group__usb__api.html#gab4dc6edbe6814f85a1abd2234693f6b2">02794</a> <a class="code" href="group__usb__api.html#gab4dc6edbe6814f85a1abd2234693f6b2">USBEndpointDataGet</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02795"></a>02795                    uint8_t *pui8Data, uint32_t *pui32Size)
<a name="l02796"></a>02796 {
<a name="l02797"></a>02797     uint32_t ui32Register, ui32ByteCount, ui32FIFO;
<a name="l02798"></a>02798 
<a name="l02799"></a>02799     <span class="comment">//</span>
<a name="l02800"></a>02800     <span class="comment">// Check the arguments.</span>
<a name="l02801"></a>02801     <span class="comment">//</span>
<a name="l02802"></a>02802     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02803"></a>02803     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l02804"></a>02804            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l02805"></a>02805            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l02806"></a>02806            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02807"></a>02807 
<a name="l02808"></a>02808     <span class="comment">//</span>
<a name="l02809"></a>02809     <span class="comment">// Get the address of the receive status register to use, based on the</span>
<a name="l02810"></a>02810     <span class="comment">// endpoint.</span>
<a name="l02811"></a>02811     <span class="comment">//</span>
<a name="l02812"></a>02812     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l02813"></a>02813     {
<a name="l02814"></a>02814         ui32Register = <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>;
<a name="l02815"></a>02815     }
<a name="l02816"></a>02816     <span class="keywordflow">else</span>
<a name="l02817"></a>02817     {
<a name="l02818"></a>02818         ui32Register = <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint);
<a name="l02819"></a>02819     }
<a name="l02820"></a>02820 
<a name="l02821"></a>02821     <span class="comment">//</span>
<a name="l02822"></a>02822     <span class="comment">// Don&#39;t allow reading of data if the RxPktRdy bit is not set.</span>
<a name="l02823"></a>02823     <span class="comment">//</span>
<a name="l02824"></a>02824     <span class="keywordflow">if</span>((<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + ui32Register) &amp; <a class="code" href="hw__usb_8h.html#aa46f20c660cc47f9b3d8f9feace51914">USB_CSRL0_RXRDY</a>) == 0)
<a name="l02825"></a>02825     {
<a name="l02826"></a>02826         <span class="comment">//</span>
<a name="l02827"></a>02827         <span class="comment">// Can&#39;t read the data because none is available.</span>
<a name="l02828"></a>02828         <span class="comment">//</span>
<a name="l02829"></a>02829         *pui32Size = 0;
<a name="l02830"></a>02830 
<a name="l02831"></a>02831         <span class="comment">//</span>
<a name="l02832"></a>02832         <span class="comment">// Return a failure since there is no data to read.</span>
<a name="l02833"></a>02833         <span class="comment">//</span>
<a name="l02834"></a>02834         <span class="keywordflow">return</span>(-1);
<a name="l02835"></a>02835     }
<a name="l02836"></a>02836 
<a name="l02837"></a>02837     <span class="comment">//</span>
<a name="l02838"></a>02838     <span class="comment">// Get the byte count in the FIFO.</span>
<a name="l02839"></a>02839     <span class="comment">//</span>
<a name="l02840"></a>02840     ui32ByteCount = <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a1cb5bf9dcee48cd3ad0417dbeb1b0e11">USB_O_COUNT0</a> + ui32Endpoint);
<a name="l02841"></a>02841 
<a name="l02842"></a>02842     <span class="comment">//</span>
<a name="l02843"></a>02843     <span class="comment">// Determine how many bytes are copied.</span>
<a name="l02844"></a>02844     <span class="comment">//</span>
<a name="l02845"></a>02845     ui32ByteCount = (ui32ByteCount &lt; *pui32Size) ? ui32ByteCount : *pui32Size;
<a name="l02846"></a>02846 
<a name="l02847"></a>02847     <span class="comment">//</span>
<a name="l02848"></a>02848     <span class="comment">// Return the number of bytes we are going to read.</span>
<a name="l02849"></a>02849     <span class="comment">//</span>
<a name="l02850"></a>02850     *pui32Size = ui32ByteCount;
<a name="l02851"></a>02851 
<a name="l02852"></a>02852     <span class="comment">//</span>
<a name="l02853"></a>02853     <span class="comment">// Calculate the FIFO address.</span>
<a name="l02854"></a>02854     <span class="comment">//</span>
<a name="l02855"></a>02855     ui32FIFO = ui32Base + <a class="code" href="hw__usb_8h.html#a2563224a44d17c5767b29eea6f47414a">USB_O_FIFO0</a> + (ui32Endpoint &gt;&gt; 2);
<a name="l02856"></a>02856 
<a name="l02857"></a>02857     <span class="comment">//</span>
<a name="l02858"></a>02858     <span class="comment">// Read the data out of the FIFO.</span>
<a name="l02859"></a>02859     <span class="comment">//</span>
<a name="l02860"></a>02860     <span class="keywordflow">for</span>(; ui32ByteCount &gt; 0; ui32ByteCount--)
<a name="l02861"></a>02861     {
<a name="l02862"></a>02862         <span class="comment">//</span>
<a name="l02863"></a>02863         <span class="comment">// Read a byte at a time from the FIFO.</span>
<a name="l02864"></a>02864         <span class="comment">//</span>
<a name="l02865"></a>02865         *pui8Data++ = <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32FIFO);
<a name="l02866"></a>02866     }
<a name="l02867"></a>02867 
<a name="l02868"></a>02868     <span class="comment">//</span>
<a name="l02869"></a>02869     <span class="comment">// Success.</span>
<a name="l02870"></a>02870     <span class="comment">//</span>
<a name="l02871"></a>02871     <span class="keywordflow">return</span>(0);
<a name="l02872"></a>02872 }
<a name="l02873"></a>02873 
<a name="l02874"></a>02874 <span class="comment">//*****************************************************************************</span>
<a name="l02875"></a>02875 <span class="comment">//</span>
<a name="l02893"></a>02893 <span class="comment"></span><span class="comment">//</span>
<a name="l02894"></a>02894 <span class="comment">//*****************************************************************************</span>
<a name="l02895"></a>02895 <span class="keywordtype">void</span>
<a name="l02896"></a><a class="code" href="group__usb__api.html#gab842492063a5b2e7ae08b2c8115b6506">02896</a> <a class="code" href="group__usb__api.html#gab842492063a5b2e7ae08b2c8115b6506">USBDevEndpointDataAck</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02897"></a>02897                       <span class="keywordtype">bool</span> bIsLastPacket)
<a name="l02898"></a>02898 {
<a name="l02899"></a>02899     <span class="comment">//</span>
<a name="l02900"></a>02900     <span class="comment">// Check the arguments.</span>
<a name="l02901"></a>02901     <span class="comment">//</span>
<a name="l02902"></a>02902     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02903"></a>02903     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l02904"></a>02904            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l02905"></a>02905            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l02906"></a>02906            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02907"></a>02907 
<a name="l02908"></a>02908     <span class="comment">//</span>
<a name="l02909"></a>02909     <span class="comment">// Determine which endpoint is being acked.</span>
<a name="l02910"></a>02910     <span class="comment">//</span>
<a name="l02911"></a>02911     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l02912"></a>02912     {
<a name="l02913"></a>02913         <span class="comment">//</span>
<a name="l02914"></a>02914         <span class="comment">// Clear RxPktRdy, and optionally DataEnd, on endpoint zero.</span>
<a name="l02915"></a>02915         <span class="comment">//</span>
<a name="l02916"></a>02916         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) =
<a name="l02917"></a>02917             <a class="code" href="hw__usb_8h.html#a48e2f3edca2d034139b6ee968e041d34">USB_CSRL0_RXRDYC</a> | (bIsLastPacket ? <a class="code" href="hw__usb_8h.html#a9d0b019991becfdfb91fe4227daad63e">USB_CSRL0_DATAEND</a> : 0);
<a name="l02918"></a>02918     }
<a name="l02919"></a>02919     <span class="keywordflow">else</span>
<a name="l02920"></a>02920     {
<a name="l02921"></a>02921         <span class="comment">//</span>
<a name="l02922"></a>02922         <span class="comment">// Clear RxPktRdy on all other endpoints.</span>
<a name="l02923"></a>02923         <span class="comment">//</span>
<a name="l02924"></a>02924         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l02925"></a>02925             ~(<a class="code" href="hw__usb_8h.html#aacc88e8db2bd97c22301ac3544a0d3ce">USB_RXCSRL1_RXRDY</a>);
<a name="l02926"></a>02926     }
<a name="l02927"></a>02927 }
<a name="l02928"></a>02928 
<a name="l02929"></a>02929 <span class="comment">//*****************************************************************************</span>
<a name="l02930"></a>02930 <span class="comment">//</span>
<a name="l02944"></a>02944 <span class="comment"></span><span class="comment">//</span>
<a name="l02945"></a>02945 <span class="comment">//*****************************************************************************</span>
<a name="l02946"></a>02946 <span class="keywordtype">void</span>
<a name="l02947"></a><a class="code" href="group__usb__api.html#ga74649d54e3b6af8aee335bc3ee13dacb">02947</a> <a class="code" href="group__usb__api.html#ga74649d54e3b6af8aee335bc3ee13dacb">USBHostEndpointDataAck</a>(uint32_t ui32Base, uint32_t ui32Endpoint)
<a name="l02948"></a>02948 {
<a name="l02949"></a>02949     <span class="comment">//</span>
<a name="l02950"></a>02950     <span class="comment">// Check the arguments.</span>
<a name="l02951"></a>02951     <span class="comment">//</span>
<a name="l02952"></a>02952     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l02953"></a>02953     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l02954"></a>02954            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l02955"></a>02955            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l02956"></a>02956            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l02957"></a>02957 
<a name="l02958"></a>02958     <span class="comment">//</span>
<a name="l02959"></a>02959     <span class="comment">// Clear RxPktRdy.</span>
<a name="l02960"></a>02960     <span class="comment">//</span>
<a name="l02961"></a>02961     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l02962"></a>02962     {
<a name="l02963"></a>02963         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#aa46f20c660cc47f9b3d8f9feace51914">USB_CSRL0_RXRDY</a>;
<a name="l02964"></a>02964     }
<a name="l02965"></a>02965     <span class="keywordflow">else</span>
<a name="l02966"></a>02966     {
<a name="l02967"></a>02967         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;=
<a name="l02968"></a>02968             ~(<a class="code" href="hw__usb_8h.html#aacc88e8db2bd97c22301ac3544a0d3ce">USB_RXCSRL1_RXRDY</a>);
<a name="l02969"></a>02969     }
<a name="l02970"></a>02970 }
<a name="l02971"></a>02971 
<a name="l02972"></a>02972 <span class="comment">//*****************************************************************************</span>
<a name="l02973"></a>02973 <span class="comment">//</span>
<a name="l02990"></a>02990 <span class="comment"></span><span class="comment">//</span>
<a name="l02991"></a>02991 <span class="comment">//*****************************************************************************</span>
<a name="l02992"></a>02992 int32_t
<a name="l02993"></a><a class="code" href="group__usb__api.html#gab30e36a23c89c23568a763065509e4c8">02993</a> <a class="code" href="group__usb__api.html#gab30e36a23c89c23568a763065509e4c8">USBEndpointDataPut</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l02994"></a>02994                    uint8_t *pui8Data, uint32_t ui32Size)
<a name="l02995"></a>02995 {
<a name="l02996"></a>02996     uint32_t ui32FIFO;
<a name="l02997"></a>02997     uint8_t ui8TxPktRdy;
<a name="l02998"></a>02998 
<a name="l02999"></a>02999     <span class="comment">//</span>
<a name="l03000"></a>03000     <span class="comment">// Check the arguments.</span>
<a name="l03001"></a>03001     <span class="comment">//</span>
<a name="l03002"></a>03002     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03003"></a>03003     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03004"></a>03004            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03005"></a>03005            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03006"></a>03006            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03007"></a>03007 
<a name="l03008"></a>03008     <span class="comment">//</span>
<a name="l03009"></a>03009     <span class="comment">// Get the bit position of TxPktRdy based on the endpoint.</span>
<a name="l03010"></a>03010     <span class="comment">//</span>
<a name="l03011"></a>03011     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l03012"></a>03012     {
<a name="l03013"></a>03013         ui8TxPktRdy = <a class="code" href="hw__usb_8h.html#a66cb7a914c02dce1716cb0b6669da104">USB_CSRL0_TXRDY</a>;
<a name="l03014"></a>03014     }
<a name="l03015"></a>03015     <span class="keywordflow">else</span>
<a name="l03016"></a>03016     {
<a name="l03017"></a>03017         ui8TxPktRdy = <a class="code" href="hw__usb_8h.html#a2dee22637008a182c7e810ea6ad2615c">USB_TXCSRL1_TXRDY</a>;
<a name="l03018"></a>03018     }
<a name="l03019"></a>03019 
<a name="l03020"></a>03020     <span class="comment">//</span>
<a name="l03021"></a>03021     <span class="comment">// Don&#39;t allow transmit of data if the TxPktRdy bit is already set.</span>
<a name="l03022"></a>03022     <span class="comment">//</span>
<a name="l03023"></a>03023     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a> + ui32Endpoint) &amp; ui8TxPktRdy)
<a name="l03024"></a>03024     {
<a name="l03025"></a>03025         <span class="keywordflow">return</span>(-1);
<a name="l03026"></a>03026     }
<a name="l03027"></a>03027 
<a name="l03028"></a>03028     <span class="comment">//</span>
<a name="l03029"></a>03029     <span class="comment">// Calculate the FIFO address.</span>
<a name="l03030"></a>03030     <span class="comment">//</span>
<a name="l03031"></a>03031     ui32FIFO = ui32Base + <a class="code" href="hw__usb_8h.html#a2563224a44d17c5767b29eea6f47414a">USB_O_FIFO0</a> + (ui32Endpoint &gt;&gt; 2);
<a name="l03032"></a>03032 
<a name="l03033"></a>03033     <span class="comment">//</span>
<a name="l03034"></a>03034     <span class="comment">// Write the data to the FIFO.</span>
<a name="l03035"></a>03035     <span class="comment">//</span>
<a name="l03036"></a>03036     <span class="keywordflow">for</span>(; ui32Size &gt; 0; ui32Size--)
<a name="l03037"></a>03037     {
<a name="l03038"></a>03038         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32FIFO) = *pui8Data++;
<a name="l03039"></a>03039     }
<a name="l03040"></a>03040 
<a name="l03041"></a>03041     <span class="comment">//</span>
<a name="l03042"></a>03042     <span class="comment">// Success.</span>
<a name="l03043"></a>03043     <span class="comment">//</span>
<a name="l03044"></a>03044     <span class="keywordflow">return</span>(0);
<a name="l03045"></a>03045 }
<a name="l03046"></a>03046 
<a name="l03047"></a>03047 <span class="comment">//*****************************************************************************</span>
<a name="l03048"></a>03048 <span class="comment">//</span>
<a name="l03071"></a>03071 <span class="comment"></span><span class="comment">//</span>
<a name="l03072"></a>03072 <span class="comment">//*****************************************************************************</span>
<a name="l03073"></a>03073 int32_t
<a name="l03074"></a><a class="code" href="group__usb__api.html#ga7097f6c4f044d18964292fbefe45fa9b">03074</a> <a class="code" href="group__usb__api.html#ga7097f6c4f044d18964292fbefe45fa9b">USBEndpointDataSend</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l03075"></a>03075                     uint32_t ui32TransType)
<a name="l03076"></a>03076 {
<a name="l03077"></a>03077     uint32_t ui32TxPktRdy;
<a name="l03078"></a>03078 
<a name="l03079"></a>03079     <span class="comment">//</span>
<a name="l03080"></a>03080     <span class="comment">// Check the arguments.</span>
<a name="l03081"></a>03081     <span class="comment">//</span>
<a name="l03082"></a>03082     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03083"></a>03083     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03084"></a>03084            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03085"></a>03085            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03086"></a>03086            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03087"></a>03087 
<a name="l03088"></a>03088     <span class="comment">//</span>
<a name="l03089"></a>03089     <span class="comment">// Get the bit position of TxPktRdy based on the endpoint.</span>
<a name="l03090"></a>03090     <span class="comment">//</span>
<a name="l03091"></a>03091     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l03092"></a>03092     {
<a name="l03093"></a>03093         <span class="comment">//</span>
<a name="l03094"></a>03094         <span class="comment">// Don&#39;t allow transmit of data if the TxPktRdy bit is already set.</span>
<a name="l03095"></a>03095         <span class="comment">//</span>
<a name="l03096"></a>03096         <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) &amp; <a class="code" href="hw__usb_8h.html#a66cb7a914c02dce1716cb0b6669da104">USB_CSRL0_TXRDY</a>)
<a name="l03097"></a>03097         {
<a name="l03098"></a>03098             <span class="keywordflow">return</span>(-1);
<a name="l03099"></a>03099         }
<a name="l03100"></a>03100 
<a name="l03101"></a>03101         ui32TxPktRdy = ui32TransType &amp; 0xff;
<a name="l03102"></a>03102     }
<a name="l03103"></a>03103     <span class="keywordflow">else</span>
<a name="l03104"></a>03104     {
<a name="l03105"></a>03105         <span class="comment">//</span>
<a name="l03106"></a>03106         <span class="comment">// Don&#39;t allow transmit of data if the TxPktRdy bit is already set.</span>
<a name="l03107"></a>03107         <span class="comment">//</span>
<a name="l03108"></a>03108         <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a> + ui32Endpoint) &amp; <a class="code" href="hw__usb_8h.html#a2dee22637008a182c7e810ea6ad2615c">USB_TXCSRL1_TXRDY</a>)
<a name="l03109"></a>03109         {
<a name="l03110"></a>03110             <span class="keywordflow">return</span>(-1);
<a name="l03111"></a>03111         }
<a name="l03112"></a>03112 
<a name="l03113"></a>03113         ui32TxPktRdy = (ui32TransType &gt;&gt; 8) &amp; 0xff;
<a name="l03114"></a>03114     }
<a name="l03115"></a>03115 
<a name="l03116"></a>03116     <span class="comment">//</span>
<a name="l03117"></a>03117     <span class="comment">// Set TxPktRdy in order to send the data.</span>
<a name="l03118"></a>03118     <span class="comment">//</span>
<a name="l03119"></a>03119     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a> + ui32Endpoint) = ui32TxPktRdy;
<a name="l03120"></a>03120 
<a name="l03121"></a>03121     <span class="comment">//</span>
<a name="l03122"></a>03122     <span class="comment">// Success.</span>
<a name="l03123"></a>03123     <span class="comment">//</span>
<a name="l03124"></a>03124     <span class="keywordflow">return</span>(0);
<a name="l03125"></a>03125 }
<a name="l03126"></a>03126 
<a name="l03127"></a>03127 <span class="comment">//*****************************************************************************</span>
<a name="l03128"></a>03128 <span class="comment">//</span>
<a name="l03141"></a>03141 <span class="comment"></span><span class="comment">//</span>
<a name="l03142"></a>03142 <span class="comment">//*****************************************************************************</span>
<a name="l03143"></a>03143 <span class="keywordtype">void</span>
<a name="l03144"></a><a class="code" href="group__usb__api.html#gaf777132a773a420b29d7a2cde975bc2e">03144</a> <a class="code" href="group__usb__api.html#gaf777132a773a420b29d7a2cde975bc2e">USBFIFOFlush</a>(uint32_t ui32Base, uint32_t ui32Endpoint, uint32_t ui32Flags)
<a name="l03145"></a>03145 {
<a name="l03146"></a>03146     <span class="comment">//</span>
<a name="l03147"></a>03147     <span class="comment">// Check the arguments.</span>
<a name="l03148"></a>03148     <span class="comment">//</span>
<a name="l03149"></a>03149     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03150"></a>03150     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03151"></a>03151            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03152"></a>03152            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03153"></a>03153            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03154"></a>03154 
<a name="l03155"></a>03155     <span class="comment">//</span>
<a name="l03156"></a>03156     <span class="comment">// Endpoint zero has a different register set for FIFO flushing.</span>
<a name="l03157"></a>03157     <span class="comment">//</span>
<a name="l03158"></a>03158     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l03159"></a>03159     {
<a name="l03160"></a>03160         <span class="comment">//</span>
<a name="l03161"></a>03161         <span class="comment">// Nothing in the FIFO if neither of these bits are set.</span>
<a name="l03162"></a>03162         <span class="comment">//</span>
<a name="l03163"></a>03163         <span class="keywordflow">if</span>((<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) &amp;
<a name="l03164"></a>03164             (<a class="code" href="hw__usb_8h.html#aa46f20c660cc47f9b3d8f9feace51914">USB_CSRL0_RXRDY</a> | <a class="code" href="hw__usb_8h.html#a66cb7a914c02dce1716cb0b6669da104">USB_CSRL0_TXRDY</a>)) != 0)
<a name="l03165"></a>03165         {
<a name="l03166"></a>03166             <span class="comment">//</span>
<a name="l03167"></a>03167             <span class="comment">// Hit the Flush FIFO bit.</span>
<a name="l03168"></a>03168             <span class="comment">//</span>
<a name="l03169"></a>03169             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a49559efd3060e084e68662a070eed5c2">USB_O_CSRH0</a>) = <a class="code" href="hw__usb_8h.html#ae6749e9d7f8d7b2afaa90cd3fa1e50ad">USB_CSRH0_FLUSH</a>;
<a name="l03170"></a>03170         }
<a name="l03171"></a>03171     }
<a name="l03172"></a>03172     <span class="keywordflow">else</span>
<a name="l03173"></a>03173     {
<a name="l03174"></a>03174         <span class="comment">//</span>
<a name="l03175"></a>03175         <span class="comment">// Only reset the IN or OUT FIFO.</span>
<a name="l03176"></a>03176         <span class="comment">//</span>
<a name="l03177"></a>03177         <span class="keywordflow">if</span>(ui32Flags &amp; (<a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a> | <a class="code" href="usb_8h.html#a2881e9200f51ae03c0d643e2d6ffa169">USB_EP_DEV_IN</a>))
<a name="l03178"></a>03178         {
<a name="l03179"></a>03179             <span class="comment">//</span>
<a name="l03180"></a>03180             <span class="comment">// Make sure the FIFO is not empty.</span>
<a name="l03181"></a>03181             <span class="comment">//</span>
<a name="l03182"></a>03182             <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;
<a name="l03183"></a>03183                <a class="code" href="hw__usb_8h.html#a2dee22637008a182c7e810ea6ad2615c">USB_TXCSRL1_TXRDY</a>)
<a name="l03184"></a>03184             {
<a name="l03185"></a>03185                 <span class="comment">//</span>
<a name="l03186"></a>03186                 <span class="comment">// Hit the Flush FIFO bit.</span>
<a name="l03187"></a>03187                 <span class="comment">//</span>
<a name="l03188"></a>03188                 <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a66b5ac3ba5d076b8fd632c377db5c09e">USB_O_TXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l03189"></a>03189                     <a class="code" href="hw__usb_8h.html#a3bfc1bfbaa15f17d9f658de533fd33e3">USB_TXCSRL1_FLUSH</a>;
<a name="l03190"></a>03190             }
<a name="l03191"></a>03191         }
<a name="l03192"></a>03192         <span class="keywordflow">else</span>
<a name="l03193"></a>03193         {
<a name="l03194"></a>03194             <span class="comment">//</span>
<a name="l03195"></a>03195             <span class="comment">// Make sure that the FIFO is not empty.</span>
<a name="l03196"></a>03196             <span class="comment">//</span>
<a name="l03197"></a>03197             <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) &amp;
<a name="l03198"></a>03198                <a class="code" href="hw__usb_8h.html#aacc88e8db2bd97c22301ac3544a0d3ce">USB_RXCSRL1_RXRDY</a>)
<a name="l03199"></a>03199             {
<a name="l03200"></a>03200                 <span class="comment">//</span>
<a name="l03201"></a>03201                 <span class="comment">// Hit the Flush FIFO bit.</span>
<a name="l03202"></a>03202                 <span class="comment">//</span>
<a name="l03203"></a>03203                 <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint)) |=
<a name="l03204"></a>03204                     <a class="code" href="hw__usb_8h.html#a1c358f9fcfc75cff2eebd913bc0d0400">USB_RXCSRL1_FLUSH</a>;
<a name="l03205"></a>03205             }
<a name="l03206"></a>03206         }
<a name="l03207"></a>03207     }
<a name="l03208"></a>03208 }
<a name="l03209"></a>03209 
<a name="l03210"></a>03210 <span class="comment">//*****************************************************************************</span>
<a name="l03211"></a>03211 <span class="comment">//</span>
<a name="l03225"></a>03225 <span class="comment"></span><span class="comment">//</span>
<a name="l03226"></a>03226 <span class="comment">//*****************************************************************************</span>
<a name="l03227"></a>03227 <span class="keywordtype">void</span>
<a name="l03228"></a><a class="code" href="group__usb__api.html#ga4b68522ae4b5418b0184654c2db9b708">03228</a> <a class="code" href="group__usb__api.html#ga4b68522ae4b5418b0184654c2db9b708">USBHostRequestIN</a>(uint32_t ui32Base, uint32_t ui32Endpoint)
<a name="l03229"></a>03229 {
<a name="l03230"></a>03230     uint32_t ui32Register;
<a name="l03231"></a>03231 
<a name="l03232"></a>03232     <span class="comment">//</span>
<a name="l03233"></a>03233     <span class="comment">// Check the arguments.</span>
<a name="l03234"></a>03234     <span class="comment">//</span>
<a name="l03235"></a>03235     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03236"></a>03236     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03237"></a>03237            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03238"></a>03238            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03239"></a>03239            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03240"></a>03240 
<a name="l03241"></a>03241     <span class="comment">//</span>
<a name="l03242"></a>03242     <span class="comment">// Endpoint zero uses a different offset than the other endpoints.</span>
<a name="l03243"></a>03243     <span class="comment">//</span>
<a name="l03244"></a>03244     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l03245"></a>03245     {
<a name="l03246"></a>03246         ui32Register = <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>;
<a name="l03247"></a>03247     }
<a name="l03248"></a>03248     <span class="keywordflow">else</span>
<a name="l03249"></a>03249     {
<a name="l03250"></a>03250         ui32Register = <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint);
<a name="l03251"></a>03251     }
<a name="l03252"></a>03252 
<a name="l03253"></a>03253     <span class="comment">//</span>
<a name="l03254"></a>03254     <span class="comment">// Set the request for an IN transaction.</span>
<a name="l03255"></a>03255     <span class="comment">//</span>
<a name="l03256"></a>03256     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + ui32Register) = <a class="code" href="hw__usb_8h.html#ab0c39bc6e00519be3dae6d53610e5156">USB_RXCSRL1_REQPKT</a>;
<a name="l03257"></a>03257 }
<a name="l03258"></a>03258 
<a name="l03259"></a>03259 <span class="comment">//*****************************************************************************</span>
<a name="l03260"></a>03260 <span class="comment">//</span>
<a name="l03275"></a>03275 <span class="comment"></span><span class="comment">//</span>
<a name="l03276"></a>03276 <span class="comment">//*****************************************************************************</span>
<a name="l03277"></a>03277 <span class="keywordtype">void</span>
<a name="l03278"></a><a class="code" href="group__usb__api.html#ga7c0409d4474303eb1b4c2dc50ea7e25e">03278</a> <a class="code" href="group__usb__api.html#ga7c0409d4474303eb1b4c2dc50ea7e25e">USBHostRequestINClear</a>(uint32_t ui32Base, uint32_t ui32Endpoint)
<a name="l03279"></a>03279 {
<a name="l03280"></a>03280     uint32_t ui32Register;
<a name="l03281"></a>03281 
<a name="l03282"></a>03282     <span class="comment">//</span>
<a name="l03283"></a>03283     <span class="comment">// Check the arguments.</span>
<a name="l03284"></a>03284     <span class="comment">//</span>
<a name="l03285"></a>03285     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03286"></a>03286     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03287"></a>03287            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03288"></a>03288            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03289"></a>03289            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03290"></a>03290 
<a name="l03291"></a>03291     <span class="comment">//</span>
<a name="l03292"></a>03292     <span class="comment">// Endpoint zero uses a different offset than the other endpoints.</span>
<a name="l03293"></a>03293     <span class="comment">//</span>
<a name="l03294"></a>03294     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l03295"></a>03295     {
<a name="l03296"></a>03296         ui32Register = <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>;
<a name="l03297"></a>03297     }
<a name="l03298"></a>03298     <span class="keywordflow">else</span>
<a name="l03299"></a>03299     {
<a name="l03300"></a>03300         ui32Register = <a class="code" href="hw__usb_8h.html#a57bc94dcb14fdfc3f27d6320c7de3a86">USB_O_RXCSRL1</a> + <a class="code" href="group__usb__api.html#gaadf74b0caf840f0d3222cb1dc563684c">EP_OFFSET</a>(ui32Endpoint);
<a name="l03301"></a>03301     }
<a name="l03302"></a>03302 
<a name="l03303"></a>03303     <span class="comment">//</span>
<a name="l03304"></a>03304     <span class="comment">// Clear the request for an IN transaction.</span>
<a name="l03305"></a>03305     <span class="comment">//</span>
<a name="l03306"></a>03306     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + ui32Register) &amp;= ~<a class="code" href="hw__usb_8h.html#ab0c39bc6e00519be3dae6d53610e5156">USB_RXCSRL1_REQPKT</a>;
<a name="l03307"></a>03307 }
<a name="l03308"></a>03308 
<a name="l03309"></a>03309 <span class="comment">//*****************************************************************************</span>
<a name="l03310"></a>03310 <span class="comment">//</span>
<a name="l03325"></a>03325 <span class="comment"></span><span class="comment">//</span>
<a name="l03326"></a>03326 <span class="comment">//*****************************************************************************</span>
<a name="l03327"></a>03327 <span class="keywordtype">void</span>
<a name="l03328"></a><a class="code" href="group__usb__api.html#gab86cfa671692d2343d83d38e1b127110">03328</a> <a class="code" href="group__usb__api.html#gab86cfa671692d2343d83d38e1b127110">USBHostRequestStatus</a>(uint32_t ui32Base)
<a name="l03329"></a>03329 {
<a name="l03330"></a>03330     <span class="comment">//</span>
<a name="l03331"></a>03331     <span class="comment">// Check the arguments.</span>
<a name="l03332"></a>03332     <span class="comment">//</span>
<a name="l03333"></a>03333     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03334"></a>03334 
<a name="l03335"></a>03335     <span class="comment">//</span>
<a name="l03336"></a>03336     <span class="comment">// Set the request for a status IN transaction.</span>
<a name="l03337"></a>03337     <span class="comment">//</span>
<a name="l03338"></a>03338     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a095977f9007e9e6af6f00eab8e1f64b1">USB_O_CSRL0</a>) = <a class="code" href="hw__usb_8h.html#a7141119d1f34061a07538d8cec93b05e">USB_CSRL0_REQPKT</a> | <a class="code" href="hw__usb_8h.html#a7bb1082edc6cc4924ee478cfaa4a020f">USB_CSRL0_STATUS</a>;
<a name="l03339"></a>03339 }
<a name="l03340"></a>03340 
<a name="l03341"></a>03341 <span class="comment">//*****************************************************************************</span>
<a name="l03342"></a>03342 <span class="comment">//</span>
<a name="l03360"></a>03360 <span class="comment"></span><span class="comment">//</span>
<a name="l03361"></a>03361 <span class="comment">//*****************************************************************************</span>
<a name="l03362"></a>03362 <span class="keywordtype">void</span>
<a name="l03363"></a><a class="code" href="group__usb__api.html#gab9773f7e195858151afba772a7380cbc">03363</a> <a class="code" href="group__usb__api.html#gab9773f7e195858151afba772a7380cbc">USBHostAddrSet</a>(uint32_t ui32Base, uint32_t ui32Endpoint, uint32_t ui32Addr,
<a name="l03364"></a>03364                uint32_t ui32Flags)
<a name="l03365"></a>03365 {
<a name="l03366"></a>03366     <span class="comment">//</span>
<a name="l03367"></a>03367     <span class="comment">// Check the arguments.</span>
<a name="l03368"></a>03368     <span class="comment">//</span>
<a name="l03369"></a>03369     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03370"></a>03370     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03371"></a>03371            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03372"></a>03372            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03373"></a>03373            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03374"></a>03374 
<a name="l03375"></a>03375     <span class="comment">//</span>
<a name="l03376"></a>03376     <span class="comment">// See if the transmit or receive address is set.</span>
<a name="l03377"></a>03377     <span class="comment">//</span>
<a name="l03378"></a>03378     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a>)
<a name="l03379"></a>03379     {
<a name="l03380"></a>03380         <span class="comment">//</span>
<a name="l03381"></a>03381         <span class="comment">// Set the transmit address.</span>
<a name="l03382"></a>03382         <span class="comment">//</span>
<a name="l03383"></a>03383         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aee4fedfc6a50c965d0cb18a536b0382d">USB_O_TXFUNCADDR0</a> + (ui32Endpoint &gt;&gt; 1)) = ui32Addr;
<a name="l03384"></a>03384     }
<a name="l03385"></a>03385     <span class="keywordflow">else</span>
<a name="l03386"></a>03386     {
<a name="l03387"></a>03387         <span class="comment">//</span>
<a name="l03388"></a>03388         <span class="comment">// Set the receive address.</span>
<a name="l03389"></a>03389         <span class="comment">//</span>
<a name="l03390"></a>03390         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aee4fedfc6a50c965d0cb18a536b0382d">USB_O_TXFUNCADDR0</a> + 4 + (ui32Endpoint &gt;&gt; 1)) =
<a name="l03391"></a>03391             ui32Addr;
<a name="l03392"></a>03392     }
<a name="l03393"></a>03393 }
<a name="l03394"></a>03394 
<a name="l03395"></a>03395 <span class="comment">//*****************************************************************************</span>
<a name="l03396"></a>03396 <span class="comment">//</span>
<a name="l03410"></a>03410 <span class="comment"></span><span class="comment">//</span>
<a name="l03411"></a>03411 <span class="comment">//*****************************************************************************</span>
<a name="l03412"></a>03412 uint32_t
<a name="l03413"></a><a class="code" href="group__usb__api.html#ga34627542f5b991a0e0e21f4bb414756a">03413</a> <a class="code" href="group__usb__api.html#ga34627542f5b991a0e0e21f4bb414756a">USBHostAddrGet</a>(uint32_t ui32Base, uint32_t ui32Endpoint, uint32_t ui32Flags)
<a name="l03414"></a>03414 {
<a name="l03415"></a>03415     <span class="comment">//</span>
<a name="l03416"></a>03416     <span class="comment">// Check the arguments.</span>
<a name="l03417"></a>03417     <span class="comment">//</span>
<a name="l03418"></a>03418     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03419"></a>03419     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03420"></a>03420            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03421"></a>03421            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03422"></a>03422            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03423"></a>03423 
<a name="l03424"></a>03424     <span class="comment">//</span>
<a name="l03425"></a>03425     <span class="comment">// See if the transmit or receive address is returned.</span>
<a name="l03426"></a>03426     <span class="comment">//</span>
<a name="l03427"></a>03427     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a>)
<a name="l03428"></a>03428     {
<a name="l03429"></a>03429         <span class="comment">//</span>
<a name="l03430"></a>03430         <span class="comment">// Return this endpoint&#39;s transmit address.</span>
<a name="l03431"></a>03431         <span class="comment">//</span>
<a name="l03432"></a>03432         <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aee4fedfc6a50c965d0cb18a536b0382d">USB_O_TXFUNCADDR0</a> + (ui32Endpoint &gt;&gt; 1)));
<a name="l03433"></a>03433     }
<a name="l03434"></a>03434     <span class="keywordflow">else</span>
<a name="l03435"></a>03435     {
<a name="l03436"></a>03436         <span class="comment">//</span>
<a name="l03437"></a>03437         <span class="comment">// Return this endpoint&#39;s receive address.</span>
<a name="l03438"></a>03438         <span class="comment">//</span>
<a name="l03439"></a>03439         <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aee4fedfc6a50c965d0cb18a536b0382d">USB_O_TXFUNCADDR0</a> + 4 + (ui32Endpoint &gt;&gt; 1)));
<a name="l03440"></a>03440     }
<a name="l03441"></a>03441 }
<a name="l03442"></a>03442 
<a name="l03443"></a>03443 <span class="comment">//*****************************************************************************</span>
<a name="l03444"></a>03444 <span class="comment">//</span>
<a name="l03464"></a>03464 <span class="comment"></span><span class="comment">//</span>
<a name="l03465"></a>03465 <span class="comment">//*****************************************************************************</span>
<a name="l03466"></a>03466 <span class="keywordtype">void</span>
<a name="l03467"></a><a class="code" href="group__usb__api.html#ga2feb9ed9cfb39b7e18fd8bd41173204b">03467</a> <a class="code" href="group__usb__api.html#ga2feb9ed9cfb39b7e18fd8bd41173204b">USBHostHubAddrSet</a>(uint32_t ui32Base, uint32_t ui32Endpoint, uint32_t ui32Addr,
<a name="l03468"></a>03468                   uint32_t ui32Flags)
<a name="l03469"></a>03469 {
<a name="l03470"></a>03470     <span class="comment">//</span>
<a name="l03471"></a>03471     <span class="comment">// Check the arguments.</span>
<a name="l03472"></a>03472     <span class="comment">//</span>
<a name="l03473"></a>03473     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03474"></a>03474     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03475"></a>03475            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03476"></a>03476            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03477"></a>03477            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03478"></a>03478 
<a name="l03479"></a>03479     <span class="comment">//</span>
<a name="l03480"></a>03480     <span class="comment">// See if the hub transmit or receive address is being set.</span>
<a name="l03481"></a>03481     <span class="comment">//</span>
<a name="l03482"></a>03482     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a>)
<a name="l03483"></a>03483     {
<a name="l03484"></a>03484         <span class="comment">//</span>
<a name="l03485"></a>03485         <span class="comment">// Set the hub transmit address and port number for this endpoint.</span>
<a name="l03486"></a>03486         <span class="comment">//</span>
<a name="l03487"></a>03487         <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a78c890fa962c4d6c74d1b518ab55c099">USB_O_TXHUBADDR0</a> + (ui32Endpoint &gt;&gt; 1)) = ui32Addr;
<a name="l03488"></a>03488     }
<a name="l03489"></a>03489     <span class="keywordflow">else</span>
<a name="l03490"></a>03490     {
<a name="l03491"></a>03491         <span class="comment">//</span>
<a name="l03492"></a>03492         <span class="comment">// Set the hub receive address and port number for this endpoint.</span>
<a name="l03493"></a>03493         <span class="comment">//</span>
<a name="l03494"></a>03494         <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a78c890fa962c4d6c74d1b518ab55c099">USB_O_TXHUBADDR0</a> + 4 + (ui32Endpoint &gt;&gt; 1)) =
<a name="l03495"></a>03495             ui32Addr;
<a name="l03496"></a>03496     }
<a name="l03497"></a>03497 
<a name="l03498"></a>03498     <span class="comment">//</span>
<a name="l03499"></a>03499     <span class="comment">// Set the speed of communication for endpoint 0.  This configuration is</span>
<a name="l03500"></a>03500     <span class="comment">// done here because it changes on a transaction-by-transaction basis for</span>
<a name="l03501"></a>03501     <span class="comment">// EP0.  For other endpoints, this is set in USBHostEndpointConfig().</span>
<a name="l03502"></a>03502     <span class="comment">//</span>
<a name="l03503"></a>03503     <span class="keywordflow">if</span>(ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>)
<a name="l03504"></a>03504     {
<a name="l03505"></a>03505         <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a45b104ecc0673dc778e652ca88ec45a1">USB_EP_SPEED_FULL</a>)
<a name="l03506"></a>03506         {
<a name="l03507"></a>03507             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae968897d93669d85a774c00bdc5553fb">USB_O_TYPE0</a>) = <a class="code" href="hw__usb_8h.html#ad75009234bcb791c90f83a6eba56558e">USB_TYPE0_SPEED_FULL</a>;
<a name="l03508"></a>03508         }
<a name="l03509"></a>03509         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a83597dac986079e006ae113acce82ccb">USB_EP_SPEED_HIGH</a>)
<a name="l03510"></a>03510         {
<a name="l03511"></a>03511             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae968897d93669d85a774c00bdc5553fb">USB_O_TYPE0</a>) = <a class="code" href="hw__usb_8h.html#a4c332d0768cf2ec5bf7c64ecfa3d72c9">USB_TYPE0_SPEED_HIGH</a>;
<a name="l03512"></a>03512         }
<a name="l03513"></a>03513         <span class="keywordflow">else</span>
<a name="l03514"></a>03514         {
<a name="l03515"></a>03515             <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae968897d93669d85a774c00bdc5553fb">USB_O_TYPE0</a>) = <a class="code" href="hw__usb_8h.html#a2c11924120fbb14d0f29521e30c31264">USB_TYPE0_SPEED_LOW</a>;
<a name="l03516"></a>03516         }
<a name="l03517"></a>03517     }
<a name="l03518"></a>03518 }
<a name="l03519"></a>03519 
<a name="l03520"></a>03520 <span class="comment">//*****************************************************************************</span>
<a name="l03521"></a>03521 <span class="comment">//</span>
<a name="l03536"></a>03536 <span class="comment"></span><span class="comment">//</span>
<a name="l03537"></a>03537 <span class="comment">//*****************************************************************************</span>
<a name="l03538"></a>03538 uint32_t
<a name="l03539"></a><a class="code" href="group__usb__api.html#ga60b492df8f7282997281a43aaaef8ede">03539</a> <a class="code" href="group__usb__api.html#ga60b492df8f7282997281a43aaaef8ede">USBHostHubAddrGet</a>(uint32_t ui32Base, uint32_t ui32Endpoint, uint32_t ui32Flags)
<a name="l03540"></a>03540 {
<a name="l03541"></a>03541     <span class="comment">//</span>
<a name="l03542"></a>03542     <span class="comment">// Check the arguments.</span>
<a name="l03543"></a>03543     <span class="comment">//</span>
<a name="l03544"></a>03544     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03545"></a>03545     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a17438a2055fa93adc8baabd84a697246">USB_EP_0</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) ||
<a name="l03546"></a>03546            (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) ||
<a name="l03547"></a>03547            (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) ||
<a name="l03548"></a>03548            (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03549"></a>03549 
<a name="l03550"></a>03550     <span class="comment">//</span>
<a name="l03551"></a>03551     <span class="comment">// See if the hub transmit or receive address is returned.</span>
<a name="l03552"></a>03552     <span class="comment">//</span>
<a name="l03553"></a>03553     <span class="keywordflow">if</span>(ui32Flags &amp; <a class="code" href="usb_8h.html#a16d74e6681181962aff08fac4ff7176b">USB_EP_HOST_OUT</a>)
<a name="l03554"></a>03554     {
<a name="l03555"></a>03555         <span class="comment">//</span>
<a name="l03556"></a>03556         <span class="comment">// Return the hub transmit address for this endpoint.</span>
<a name="l03557"></a>03557         <span class="comment">//</span>
<a name="l03558"></a>03558         <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a78c890fa962c4d6c74d1b518ab55c099">USB_O_TXHUBADDR0</a> + (ui32Endpoint &gt;&gt; 1)));
<a name="l03559"></a>03559     }
<a name="l03560"></a>03560     <span class="keywordflow">else</span>
<a name="l03561"></a>03561     {
<a name="l03562"></a>03562         <span class="comment">//</span>
<a name="l03563"></a>03563         <span class="comment">// Return the hub receive address for this endpoint.</span>
<a name="l03564"></a>03564         <span class="comment">//</span>
<a name="l03565"></a>03565         <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a78c890fa962c4d6c74d1b518ab55c099">USB_O_TXHUBADDR0</a> + 4 + (ui32Endpoint &gt;&gt; 1)));
<a name="l03566"></a>03566     }
<a name="l03567"></a>03567 }
<a name="l03568"></a>03568 
<a name="l03569"></a>03569 <span class="comment">//*****************************************************************************</span>
<a name="l03570"></a>03570 <span class="comment">//</span>
<a name="l03625"></a>03625 <span class="comment"></span><span class="comment">//</span>
<a name="l03626"></a>03626 <span class="comment">//*****************************************************************************</span>
<a name="l03627"></a>03627 <span class="keywordtype">void</span>
<a name="l03628"></a><a class="code" href="group__usb__api.html#ga90735e34d119913552eaed9a158fd5e8">03628</a> <a class="code" href="group__usb__api.html#ga90735e34d119913552eaed9a158fd5e8">USBHostPwrConfig</a>(uint32_t ui32Base, uint32_t ui32Flags)
<a name="l03629"></a>03629 {
<a name="l03630"></a>03630     <span class="comment">//</span>
<a name="l03631"></a>03631     <span class="comment">// Check the arguments.</span>
<a name="l03632"></a>03632     <span class="comment">//</span>
<a name="l03633"></a>03633     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03634"></a>03634     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Flags &amp; ~(<a class="code" href="usb_8h.html#a16ad6e64e1cc6c4ed48a7e62afc6f9cd">USB_HOST_PWREN_FILTER</a> | <a class="code" href="hw__usb_8h.html#aed171996d72a2bb546a0067e89301cef">USB_EPC_PFLTACT_M</a> |
<a name="l03635"></a>03635                           <a class="code" href="hw__usb_8h.html#a3c680d055c02a8f8e5b5e89225db71e9">USB_EPC_PFLTAEN</a> | <a class="code" href="hw__usb_8h.html#aca06e6970f593ca44a34b4657266ec71">USB_EPC_PFLTSEN_HIGH</a> |
<a name="l03636"></a>03636                           <a class="code" href="hw__usb_8h.html#a60fa9b6198e4b97826d9e2595922aace">USB_EPC_EPEN_M</a>)) == 0);
<a name="l03637"></a>03637 
<a name="l03638"></a>03638     <span class="comment">//</span>
<a name="l03639"></a>03639     <span class="comment">// If requested, enable VBUS droop detection on parts that support this</span>
<a name="l03640"></a>03640     <span class="comment">// feature.</span>
<a name="l03641"></a>03641     <span class="comment">//</span>
<a name="l03642"></a>03642     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a81194dfefc4e736715892aabfe53dcf6">USB_O_VDC</a>) = ui32Flags &gt;&gt; 16;
<a name="l03643"></a>03643 
<a name="l03644"></a>03644     <span class="comment">//</span>
<a name="l03645"></a>03645     <span class="comment">// Set the power fault configuration as specified.  This configuration</span>
<a name="l03646"></a>03646     <span class="comment">// does not change whether fault detection is enabled or not.</span>
<a name="l03647"></a>03647     <span class="comment">//</span>
<a name="l03648"></a>03648     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa5e2fae55d43161846c2bfc9ea0d0c67">USB_O_EPC</a>) =
<a name="l03649"></a>03649         (ui32Flags | (<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa5e2fae55d43161846c2bfc9ea0d0c67">USB_O_EPC</a>) &amp;
<a name="l03650"></a>03650                       ~(<a class="code" href="hw__usb_8h.html#aed171996d72a2bb546a0067e89301cef">USB_EPC_PFLTACT_M</a> | <a class="code" href="hw__usb_8h.html#a3c680d055c02a8f8e5b5e89225db71e9">USB_EPC_PFLTAEN</a> |
<a name="l03651"></a>03651                         <a class="code" href="hw__usb_8h.html#aca06e6970f593ca44a34b4657266ec71">USB_EPC_PFLTSEN_HIGH</a> | <a class="code" href="hw__usb_8h.html#a60fa9b6198e4b97826d9e2595922aace">USB_EPC_EPEN_M</a>)));
<a name="l03652"></a>03652 }
<a name="l03653"></a>03653 
<a name="l03654"></a>03654 <span class="comment">//*****************************************************************************</span>
<a name="l03655"></a>03655 <span class="comment">//</span>
<a name="l03666"></a>03666 <span class="comment"></span><span class="comment">//</span>
<a name="l03667"></a>03667 <span class="comment">//*****************************************************************************</span>
<a name="l03668"></a>03668 <span class="keywordtype">void</span>
<a name="l03669"></a><a class="code" href="group__usb__api.html#ga1b5c7a9f4113a0d441f4783cf45ea4dd">03669</a> <a class="code" href="group__usb__api.html#ga1b5c7a9f4113a0d441f4783cf45ea4dd">USBHostPwrFaultEnable</a>(uint32_t ui32Base)
<a name="l03670"></a>03670 {
<a name="l03671"></a>03671     <span class="comment">//</span>
<a name="l03672"></a>03672     <span class="comment">// Check the arguments.</span>
<a name="l03673"></a>03673     <span class="comment">//</span>
<a name="l03674"></a>03674     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03675"></a>03675 
<a name="l03676"></a>03676     <span class="comment">//</span>
<a name="l03677"></a>03677     <span class="comment">// Enable power fault input.</span>
<a name="l03678"></a>03678     <span class="comment">//</span>
<a name="l03679"></a>03679     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa5e2fae55d43161846c2bfc9ea0d0c67">USB_O_EPC</a>) |= <a class="code" href="hw__usb_8h.html#a6c0d02d16edcc61571ec3da089f004ab">USB_EPC_PFLTEN</a>;
<a name="l03680"></a>03680 }
<a name="l03681"></a>03681 
<a name="l03682"></a>03682 <span class="comment">//*****************************************************************************</span>
<a name="l03683"></a>03683 <span class="comment">//</span>
<a name="l03693"></a>03693 <span class="comment"></span><span class="comment">//</span>
<a name="l03694"></a>03694 <span class="comment">//*****************************************************************************</span>
<a name="l03695"></a>03695 <span class="keywordtype">void</span>
<a name="l03696"></a><a class="code" href="group__usb__api.html#ga4e50f9b8b9a7216f380c49d25ae8a33a">03696</a> <a class="code" href="group__usb__api.html#ga4e50f9b8b9a7216f380c49d25ae8a33a">USBHostPwrFaultDisable</a>(uint32_t ui32Base)
<a name="l03697"></a>03697 {
<a name="l03698"></a>03698     <span class="comment">//</span>
<a name="l03699"></a>03699     <span class="comment">// Check the arguments.</span>
<a name="l03700"></a>03700     <span class="comment">//</span>
<a name="l03701"></a>03701     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03702"></a>03702 
<a name="l03703"></a>03703     <span class="comment">//</span>
<a name="l03704"></a>03704     <span class="comment">// Enable power fault input.</span>
<a name="l03705"></a>03705     <span class="comment">//</span>
<a name="l03706"></a>03706     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa5e2fae55d43161846c2bfc9ea0d0c67">USB_O_EPC</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a6c0d02d16edcc61571ec3da089f004ab">USB_EPC_PFLTEN</a>;
<a name="l03707"></a>03707 }
<a name="l03708"></a>03708 
<a name="l03709"></a>03709 <span class="comment">//*****************************************************************************</span>
<a name="l03710"></a>03710 <span class="comment">//</span>
<a name="l03721"></a>03721 <span class="comment"></span><span class="comment">//</span>
<a name="l03722"></a>03722 <span class="comment">//*****************************************************************************</span>
<a name="l03723"></a>03723 <span class="keywordtype">void</span>
<a name="l03724"></a><a class="code" href="group__usb__api.html#ga4b05c7e12cf63f6f142f62accc3afed0">03724</a> <a class="code" href="group__usb__api.html#ga4b05c7e12cf63f6f142f62accc3afed0">USBHostPwrEnable</a>(uint32_t ui32Base)
<a name="l03725"></a>03725 {
<a name="l03726"></a>03726     <span class="comment">//</span>
<a name="l03727"></a>03727     <span class="comment">// Check the arguments.</span>
<a name="l03728"></a>03728     <span class="comment">//</span>
<a name="l03729"></a>03729     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03730"></a>03730 
<a name="l03731"></a>03731     <span class="comment">//</span>
<a name="l03732"></a>03732     <span class="comment">// Enable the external power supply enable signal.</span>
<a name="l03733"></a>03733     <span class="comment">//</span>
<a name="l03734"></a>03734     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa5e2fae55d43161846c2bfc9ea0d0c67">USB_O_EPC</a>) |= <a class="code" href="hw__usb_8h.html#ae24165a61d2fd18719e01fe9877fd3bd">USB_EPC_EPENDE</a>;
<a name="l03735"></a>03735 }
<a name="l03736"></a>03736 
<a name="l03737"></a>03737 <span class="comment">//*****************************************************************************</span>
<a name="l03738"></a>03738 <span class="comment">//</span>
<a name="l03749"></a>03749 <span class="comment"></span><span class="comment">//</span>
<a name="l03750"></a>03750 <span class="comment">//*****************************************************************************</span>
<a name="l03751"></a>03751 <span class="keywordtype">void</span>
<a name="l03752"></a><a class="code" href="group__usb__api.html#ga146f4ef7b4cf29088c54ec55e0974cda">03752</a> <a class="code" href="group__usb__api.html#ga146f4ef7b4cf29088c54ec55e0974cda">USBHostPwrDisable</a>(uint32_t ui32Base)
<a name="l03753"></a>03753 {
<a name="l03754"></a>03754     <span class="comment">//</span>
<a name="l03755"></a>03755     <span class="comment">// Check the arguments.</span>
<a name="l03756"></a>03756     <span class="comment">//</span>
<a name="l03757"></a>03757     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03758"></a>03758 
<a name="l03759"></a>03759     <span class="comment">//</span>
<a name="l03760"></a>03760     <span class="comment">// Disable the external power supply enable signal.</span>
<a name="l03761"></a>03761     <span class="comment">//</span>
<a name="l03762"></a>03762     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa5e2fae55d43161846c2bfc9ea0d0c67">USB_O_EPC</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#ae24165a61d2fd18719e01fe9877fd3bd">USB_EPC_EPENDE</a>;
<a name="l03763"></a>03763 }
<a name="l03764"></a>03764 
<a name="l03765"></a>03765 <span class="comment">//*****************************************************************************</span>
<a name="l03766"></a>03766 <span class="comment">//</span>
<a name="l03774"></a>03774 <span class="comment"></span><span class="comment">//</span>
<a name="l03775"></a>03775 <span class="comment">//*****************************************************************************</span>
<a name="l03776"></a>03776 uint32_t
<a name="l03777"></a><a class="code" href="group__usb__api.html#ga30c2dc9dcfaac025b60fcaf00c57097f">03777</a> <a class="code" href="group__usb__api.html#ga30c2dc9dcfaac025b60fcaf00c57097f">USBFrameNumberGet</a>(uint32_t ui32Base)
<a name="l03778"></a>03778 {
<a name="l03779"></a>03779     <span class="comment">//</span>
<a name="l03780"></a>03780     <span class="comment">// Check the arguments.</span>
<a name="l03781"></a>03781     <span class="comment">//</span>
<a name="l03782"></a>03782     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03783"></a>03783 
<a name="l03784"></a>03784     <span class="comment">//</span>
<a name="l03785"></a>03785     <span class="comment">// Return the most recent frame number.</span>
<a name="l03786"></a>03786     <span class="comment">//</span>
<a name="l03787"></a>03787     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aa81ad3c7c37834be12f59f25eaf24207">USB_O_FRAME</a>));
<a name="l03788"></a>03788 }
<a name="l03789"></a>03789 
<a name="l03790"></a>03790 <span class="comment">//*****************************************************************************</span>
<a name="l03791"></a>03791 <span class="comment">//</span>
<a name="l03802"></a>03802 <span class="comment"></span><span class="comment">//</span>
<a name="l03803"></a>03803 <span class="comment">//*****************************************************************************</span>
<a name="l03804"></a>03804 <span class="keywordtype">void</span>
<a name="l03805"></a><a class="code" href="group__usb__api.html#ga85df919e2dd18076d86458974f996637">03805</a> <a class="code" href="group__usb__api.html#ga85df919e2dd18076d86458974f996637">USBOTGSessionRequest</a>(uint32_t ui32Base, <span class="keywordtype">bool</span> bStart)
<a name="l03806"></a>03806 {
<a name="l03807"></a>03807     <span class="comment">//</span>
<a name="l03808"></a>03808     <span class="comment">// Check the arguments.</span>
<a name="l03809"></a>03809     <span class="comment">//</span>
<a name="l03810"></a>03810     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03811"></a>03811 
<a name="l03812"></a>03812     <span class="comment">//</span>
<a name="l03813"></a>03813     <span class="comment">// Start or end the session as directed.</span>
<a name="l03814"></a>03814     <span class="comment">//</span>
<a name="l03815"></a>03815     <span class="keywordflow">if</span>(bStart)
<a name="l03816"></a>03816     {
<a name="l03817"></a>03817         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5fc89d07656f2fbb1d14dd7f05279dcd">USB_O_DEVCTL</a>) |= <a class="code" href="hw__usb_8h.html#a707749eaf6fa16e4ec6145193938eec5">USB_DEVCTL_SESSION</a>;
<a name="l03818"></a>03818     }
<a name="l03819"></a>03819     <span class="keywordflow">else</span>
<a name="l03820"></a>03820     {
<a name="l03821"></a>03821         <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5fc89d07656f2fbb1d14dd7f05279dcd">USB_O_DEVCTL</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a707749eaf6fa16e4ec6145193938eec5">USB_DEVCTL_SESSION</a>;
<a name="l03822"></a>03822     }
<a name="l03823"></a>03823 }
<a name="l03824"></a>03824 
<a name="l03825"></a>03825 <span class="comment">//*****************************************************************************</span>
<a name="l03826"></a>03826 <span class="comment">//</span>
<a name="l03840"></a>03840 <span class="comment"></span><span class="comment">//</span>
<a name="l03841"></a>03841 <span class="comment">//*****************************************************************************</span>
<a name="l03842"></a>03842 uint32_t
<a name="l03843"></a><a class="code" href="group__usb__api.html#ga944d0d00849b464a25e5ebdf567770ba">03843</a> <a class="code" href="group__usb__api.html#ga944d0d00849b464a25e5ebdf567770ba">USBFIFOAddrGet</a>(uint32_t ui32Base, uint32_t ui32Endpoint)
<a name="l03844"></a>03844 {
<a name="l03845"></a>03845     <span class="comment">//</span>
<a name="l03846"></a>03846     <span class="comment">// Return the FIFO address for this endpoint.</span>
<a name="l03847"></a>03847     <span class="comment">//</span>
<a name="l03848"></a>03848     <span class="keywordflow">return</span>(ui32Base + <a class="code" href="hw__usb_8h.html#a2563224a44d17c5767b29eea6f47414a">USB_O_FIFO0</a> + (ui32Endpoint &gt;&gt; 2));
<a name="l03849"></a>03849 }
<a name="l03850"></a>03850 
<a name="l03851"></a>03851 <span class="comment">//*****************************************************************************</span>
<a name="l03852"></a>03852 <span class="comment">//</span>
<a name="l03895"></a>03895 <span class="comment"></span><span class="comment">//</span>
<a name="l03896"></a>03896 <span class="comment">//*****************************************************************************</span>
<a name="l03897"></a>03897 uint32_t
<a name="l03898"></a><a class="code" href="group__usb__api.html#ga2b6e9d96726ca645ea7a6c441d68448a">03898</a> <a class="code" href="group__usb__api.html#ga2b6e9d96726ca645ea7a6c441d68448a">USBModeGet</a>(uint32_t ui32Base)
<a name="l03899"></a>03899 {
<a name="l03900"></a>03900     <span class="comment">//</span>
<a name="l03901"></a>03901     <span class="comment">// Check the arguments.</span>
<a name="l03902"></a>03902     <span class="comment">//</span>
<a name="l03903"></a>03903     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03904"></a>03904 
<a name="l03905"></a>03905     <span class="comment">//</span>
<a name="l03906"></a>03906     <span class="comment">// Checks the current mode in the USB_O_DEVCTL and returns the current</span>
<a name="l03907"></a>03907     <span class="comment">// mode.</span>
<a name="l03908"></a>03908     <span class="comment">//</span>
<a name="l03909"></a>03909     <span class="comment">// USB_OTG_MODE_ASIDE_HOST:  USB_DEVCTL_HOST | USB_DEVCTL_SESSION</span>
<a name="l03910"></a>03910     <span class="comment">// USB_OTG_MODE_ASIDE_DEV:   USB_DEVCTL_SESSION</span>
<a name="l03911"></a>03911     <span class="comment">// USB_OTG_MODE_BSIDE_HOST:  USB_DEVCTL_DEV | USB_DEVCTL_SESSION |</span>
<a name="l03912"></a>03912     <span class="comment">//                           USB_DEVCTL_HOST</span>
<a name="l03913"></a>03913     <span class="comment">// USB_OTG_MODE_BSIDE_DEV:   USB_DEVCTL_DEV | USB_DEVCTL_SESSION</span>
<a name="l03914"></a>03914     <span class="comment">// USB_OTG_MODE_NONE:        USB_DEVCTL_DEV</span>
<a name="l03915"></a>03915     <span class="comment">//</span>
<a name="l03916"></a>03916     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5fc89d07656f2fbb1d14dd7f05279dcd">USB_O_DEVCTL</a>) &amp;
<a name="l03917"></a>03917            (<a class="code" href="hw__usb_8h.html#acce0cfc6452c14814e625c7b3f97de08">USB_DEVCTL_DEV</a> | <a class="code" href="hw__usb_8h.html#a93a1f0f40862a7514f85e803658af660">USB_DEVCTL_HOST</a> | <a class="code" href="hw__usb_8h.html#a707749eaf6fa16e4ec6145193938eec5">USB_DEVCTL_SESSION</a> |
<a name="l03918"></a>03918             <a class="code" href="hw__usb_8h.html#a36b225f3c5c97d06991d3967b10fcafd">USB_DEVCTL_VBUS_M</a>));
<a name="l03919"></a>03919 }
<a name="l03920"></a>03920 
<a name="l03921"></a>03921 <span class="comment">//*****************************************************************************</span>
<a name="l03922"></a>03922 <span class="comment">//</span>
<a name="l03942"></a>03942 <span class="comment"></span><span class="comment">//*****************************************************************************</span>
<a name="l03943"></a>03943 <span class="keywordtype">void</span>
<a name="l03944"></a><a class="code" href="group__usb__api.html#ga4ad24e5522d0548200961944c3c16f38">03944</a> <a class="code" href="group__usb__api.html#ga4ad24e5522d0548200961944c3c16f38">USBEndpointDMAChannel</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l03945"></a>03945                       uint32_t ui32Channel)
<a name="l03946"></a>03946 {
<a name="l03947"></a>03947     uint32_t ui32Mask;
<a name="l03948"></a>03948 
<a name="l03949"></a>03949     <span class="comment">//</span>
<a name="l03950"></a>03950     <span class="comment">// Check the arguments.</span>
<a name="l03951"></a>03951     <span class="comment">//</span>
<a name="l03952"></a>03952     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l03953"></a>03953     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint == <a class="code" href="usb_8h.html#a4e39f33c6467bddfb7d3e92a2ea5b789">USB_EP_1</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a13cce6caa2ecdaa333ae6a9fe5869e32">USB_EP_2</a>) ||
<a name="l03954"></a>03954            (ui32Endpoint == <a class="code" href="usb_8h.html#ab0f7986e9b00a278f0d9546e1d646440">USB_EP_3</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a8e177910552fb7eeb3c11ef9e35d7439">USB_EP_4</a>) ||
<a name="l03955"></a>03955            (ui32Endpoint == <a class="code" href="usb_8h.html#a73892b0ca4c30f38c7fef4d7d6fd2caf">USB_EP_5</a>) || (ui32Endpoint == <a class="code" href="usb_8h.html#a4a0a3d355ece777a24c1fcfc192a7ef7">USB_EP_6</a>) ||
<a name="l03956"></a>03956            (ui32Endpoint == <a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>));
<a name="l03957"></a>03957     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt;= <a class="code" href="udma_8h.html#a4cd73135ca5ff7901ee122dc07ff96d9">UDMA_CHANNEL_USBEP3TX</a>);
<a name="l03958"></a>03958 
<a name="l03959"></a>03959     <span class="comment">//</span>
<a name="l03960"></a>03960     <span class="comment">// The input select mask must be shifted into the correct position</span>
<a name="l03961"></a>03961     <span class="comment">// based on the channel.</span>
<a name="l03962"></a>03962     <span class="comment">//</span>
<a name="l03963"></a>03963     ui32Mask = 0xf &lt;&lt; (ui32Channel * 4);
<a name="l03964"></a>03964 
<a name="l03965"></a>03965     <span class="comment">//</span>
<a name="l03966"></a>03966     <span class="comment">// Clear out the current selection for the channel.</span>
<a name="l03967"></a>03967     <span class="comment">//</span>
<a name="l03968"></a>03968     ui32Mask = <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a814839d7a87428b4948b3e988759b5b8">USB_O_DMASEL</a>) &amp; (~ui32Mask);
<a name="l03969"></a>03969 
<a name="l03970"></a>03970     <span class="comment">//</span>
<a name="l03971"></a>03971     <span class="comment">// The input select is now shifted into the correct position based on the</span>
<a name="l03972"></a>03972     <span class="comment">// channel.</span>
<a name="l03973"></a>03973     <span class="comment">//</span>
<a name="l03974"></a>03974     ui32Mask |= (<a class="code" href="usb_8h.html#a0b593946928f1a9c4c75ac78ee6d6f89">USBEPToIndex</a>(ui32Endpoint)) &lt;&lt; (ui32Channel * 4);
<a name="l03975"></a>03975 
<a name="l03976"></a>03976     <span class="comment">//</span>
<a name="l03977"></a>03977     <span class="comment">// Write the value out to the register.</span>
<a name="l03978"></a>03978     <span class="comment">//</span>
<a name="l03979"></a>03979     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a814839d7a87428b4948b3e988759b5b8">USB_O_DMASEL</a>) = ui32Mask;
<a name="l03980"></a>03980 }
<a name="l03981"></a>03981 
<a name="l03982"></a>03982 <span class="comment">//*****************************************************************************</span>
<a name="l03983"></a>03983 <span class="comment">//</span>
<a name="l03994"></a>03994 <span class="comment"></span><span class="comment">//</span>
<a name="l03995"></a>03995 <span class="comment">//*****************************************************************************</span>
<a name="l03996"></a>03996 <span class="keywordtype">void</span>
<a name="l03997"></a><a class="code" href="group__usb__api.html#gadaafef23f5f494492e13c3da006066eb">03997</a> <a class="code" href="group__usb__api.html#gadaafef23f5f494492e13c3da006066eb">USBHostMode</a>(uint32_t ui32Base)
<a name="l03998"></a>03998 {
<a name="l03999"></a>03999     <span class="comment">//</span>
<a name="l04000"></a>04000     <span class="comment">// Check the arguments.</span>
<a name="l04001"></a>04001     <span class="comment">//</span>
<a name="l04002"></a>04002     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04003"></a>04003 
<a name="l04004"></a>04004     <span class="comment">//</span>
<a name="l04005"></a>04005     <span class="comment">// Force mode in OTG parts that support forcing USB controller mode.</span>
<a name="l04006"></a>04006     <span class="comment">// This bit is not writable in USB controllers that do not support</span>
<a name="l04007"></a>04007     <span class="comment">// forcing the mode.  Not setting the USB_GPCS_DEVMOD bit makes this a</span>
<a name="l04008"></a>04008     <span class="comment">// force of host mode.</span>
<a name="l04009"></a>04009     <span class="comment">//</span>
<a name="l04010"></a>04010     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a0568c2f09d0f22e71ad9a3c6360e8821">USB_O_GPCS</a>) = <a class="code" href="hw__usb_8h.html#a467fa0289a46bdbcbcda85c553711814">USB_GPCS_DEVMODOTG</a>;
<a name="l04011"></a>04011 }
<a name="l04012"></a>04012 
<a name="l04013"></a>04013 <span class="comment">//*****************************************************************************</span>
<a name="l04014"></a>04014 <span class="comment">//</span>
<a name="l04025"></a>04025 <span class="comment"></span><span class="comment">//</span>
<a name="l04026"></a>04026 <span class="comment">//*****************************************************************************</span>
<a name="l04027"></a>04027 <span class="keywordtype">void</span>
<a name="l04028"></a><a class="code" href="group__usb__api.html#ga70dd112775656bd83ad8dc75ed5c53cb">04028</a> <a class="code" href="group__usb__api.html#ga70dd112775656bd83ad8dc75ed5c53cb">USBDevMode</a>(uint32_t ui32Base)
<a name="l04029"></a>04029 {
<a name="l04030"></a>04030     <span class="comment">//</span>
<a name="l04031"></a>04031     <span class="comment">// Check the arguments.</span>
<a name="l04032"></a>04032     <span class="comment">//</span>
<a name="l04033"></a>04033     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04034"></a>04034 
<a name="l04035"></a>04035     <span class="comment">//</span>
<a name="l04036"></a>04036     <span class="comment">// Set the USB controller mode to device.</span>
<a name="l04037"></a>04037     <span class="comment">//</span>
<a name="l04038"></a>04038     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a0568c2f09d0f22e71ad9a3c6360e8821">USB_O_GPCS</a>) = <a class="code" href="hw__usb_8h.html#a467fa0289a46bdbcbcda85c553711814">USB_GPCS_DEVMODOTG</a> | <a class="code" href="hw__usb_8h.html#aa24a563ec3bead6428c72b6c632571a3">USB_GPCS_DEVMOD</a>;
<a name="l04039"></a>04039 }
<a name="l04040"></a>04040 
<a name="l04041"></a>04041 <span class="comment">//*****************************************************************************</span>
<a name="l04042"></a>04042 <span class="comment">//</span>
<a name="l04051"></a>04051 <span class="comment"></span><span class="comment">//</span>
<a name="l04052"></a>04052 <span class="comment">//*****************************************************************************</span>
<a name="l04053"></a>04053 <span class="keywordtype">void</span>
<a name="l04054"></a><a class="code" href="group__usb__api.html#ga5328494d85a3f61060e56808c0087658">04054</a> <a class="code" href="group__usb__api.html#ga5328494d85a3f61060e56808c0087658">USBOTGMode</a>(uint32_t ui32Base)
<a name="l04055"></a>04055 {
<a name="l04056"></a>04056     <span class="comment">//</span>
<a name="l04057"></a>04057     <span class="comment">// Check the arguments.</span>
<a name="l04058"></a>04058     <span class="comment">//</span>
<a name="l04059"></a>04059     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04060"></a>04060 
<a name="l04061"></a>04061     <span class="comment">//</span>
<a name="l04062"></a>04062     <span class="comment">// Disable the override of the USB controller mode when running on an OTG</span>
<a name="l04063"></a>04063     <span class="comment">// device.</span>
<a name="l04064"></a>04064     <span class="comment">//</span>
<a name="l04065"></a>04065     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a0568c2f09d0f22e71ad9a3c6360e8821">USB_O_GPCS</a>) = 0;
<a name="l04066"></a>04066 }
<a name="l04067"></a>04067 
<a name="l04068"></a>04068 <span class="comment">//*****************************************************************************</span>
<a name="l04069"></a>04069 <span class="comment">//</span>
<a name="l04114"></a>04114 <span class="comment"></span><span class="comment">//</span>
<a name="l04115"></a>04115 <span class="comment">//*****************************************************************************</span>
<a name="l04116"></a>04116 <span class="keywordtype">void</span>
<a name="l04117"></a><a class="code" href="group__usb__api.html#ga59f7d3338ddae125835a82d309ef1afb">04117</a> <a class="code" href="group__usb__api.html#ga59f7d3338ddae125835a82d309ef1afb">USBModeConfig</a>(uint32_t ui32Base, uint32_t ui32Mode)
<a name="l04118"></a>04118 {
<a name="l04119"></a>04119     <span class="comment">//</span>
<a name="l04120"></a>04120     <span class="comment">// Check the arguments.</span>
<a name="l04121"></a>04121     <span class="comment">//</span>
<a name="l04122"></a>04122     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04123"></a>04123 
<a name="l04124"></a>04124     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a0568c2f09d0f22e71ad9a3c6360e8821">USB_O_GPCS</a>) = ui32Mode;
<a name="l04125"></a>04125 }
<a name="l04126"></a>04126 
<a name="l04127"></a>04127 <span class="comment">//*****************************************************************************</span>
<a name="l04128"></a>04128 <span class="comment">//</span>
<a name="l04138"></a>04138 <span class="comment"></span><span class="comment">//</span>
<a name="l04139"></a>04139 <span class="comment">//*****************************************************************************</span>
<a name="l04140"></a>04140 <span class="keywordtype">void</span>
<a name="l04141"></a><a class="code" href="group__usb__api.html#gabeb297785befec9754fb8b7631f6cff2">04141</a> <a class="code" href="group__usb__api.html#gabeb297785befec9754fb8b7631f6cff2">USBPHYPowerOff</a>(uint32_t ui32Base)
<a name="l04142"></a>04142 {
<a name="l04143"></a>04143     <span class="comment">//</span>
<a name="l04144"></a>04144     <span class="comment">// Set the PWRDNPHY bit in the PHY, putting it into its low power mode.</span>
<a name="l04145"></a>04145     <span class="comment">//</span>
<a name="l04146"></a>04146     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) |= <a class="code" href="hw__usb_8h.html#a173a03da0b3497bbce7301e0a41c06f5">USB_POWER_PWRDNPHY</a>;
<a name="l04147"></a>04147 }
<a name="l04148"></a>04148 
<a name="l04149"></a>04149 <span class="comment">//*****************************************************************************</span>
<a name="l04150"></a>04150 <span class="comment">//</span>
<a name="l04160"></a>04160 <span class="comment"></span><span class="comment">//</span>
<a name="l04161"></a>04161 <span class="comment">//*****************************************************************************</span>
<a name="l04162"></a>04162 <span class="keywordtype">void</span>
<a name="l04163"></a><a class="code" href="group__usb__api.html#ga6e6796f56dcd3b3ad2d1bece227a24fa">04163</a> <a class="code" href="group__usb__api.html#ga6e6796f56dcd3b3ad2d1bece227a24fa">USBPHYPowerOn</a>(uint32_t ui32Base)
<a name="l04164"></a>04164 {
<a name="l04165"></a>04165     <span class="comment">//</span>
<a name="l04166"></a>04166     <span class="comment">// Clear the PWRDNPHY bit in the PHY, putting it into normal operating</span>
<a name="l04167"></a>04167     <span class="comment">// mode.</span>
<a name="l04168"></a>04168     <span class="comment">//</span>
<a name="l04169"></a>04169     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ad3a1c8e8c4a2a78d507c6590aa4d2019">USB_O_POWER</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a173a03da0b3497bbce7301e0a41c06f5">USB_POWER_PWRDNPHY</a>;
<a name="l04170"></a>04170 }
<a name="l04171"></a>04171 
<a name="l04172"></a>04172 <span class="comment">//*****************************************************************************</span>
<a name="l04173"></a>04173 <span class="comment">//</span>
<a name="l04189"></a>04189 <span class="comment"></span><span class="comment">//</span>
<a name="l04190"></a>04190 <span class="comment">//*****************************************************************************</span>
<a name="l04191"></a>04191 <span class="keywordtype">void</span>
<a name="l04192"></a><a class="code" href="group__usb__api.html#gaf9b6a832b2d6b92b57b82410067f7c9c">04192</a> <a class="code" href="group__usb__api.html#gaf9b6a832b2d6b92b57b82410067f7c9c">USBEndpointPacketCountSet</a>(uint32_t ui32Base, uint32_t ui32Endpoint,
<a name="l04193"></a>04193                           uint32_t ui32Count)
<a name="l04194"></a>04194 {
<a name="l04195"></a>04195     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a1c68374ef3668fd18095e421b47a7990">USB_O_RQPKTCOUNT1</a> +
<a name="l04196"></a>04196           (0x4 * (<a class="code" href="usb_8h.html#a0b593946928f1a9c4c75ac78ee6d6f89">USBEPToIndex</a>(ui32Endpoint) - 1))) = ui32Count;
<a name="l04197"></a>04197 }
<a name="l04198"></a>04198 
<a name="l04199"></a>04199 <span class="comment">//*****************************************************************************</span>
<a name="l04200"></a>04200 <span class="comment">//</span>
<a name="l04212"></a>04212 <span class="comment"></span><span class="comment">//</span>
<a name="l04213"></a>04213 <span class="comment">//*****************************************************************************</span>
<a name="l04214"></a>04214 uint32_t
<a name="l04215"></a><a class="code" href="group__usb__api.html#gaaf870f0f6bb1916492437ea94c29ae06">04215</a> <a class="code" href="group__usb__api.html#gaaf870f0f6bb1916492437ea94c29ae06">USBNumEndpointsGet</a>(uint32_t ui32Base)
<a name="l04216"></a>04216 {
<a name="l04217"></a>04217     <span class="comment">//</span>
<a name="l04218"></a>04218     <span class="comment">// Read the number of endpoints from the hardware.  The number of TX and</span>
<a name="l04219"></a>04219     <span class="comment">// RX endpoints are always the same.</span>
<a name="l04220"></a>04220     <span class="comment">//</span>
<a name="l04221"></a>04221     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5b7f83e1c157af402a094777cd830ad6">USB_O_EPINFO</a>) &amp; <a class="code" href="hw__usb_8h.html#aeaf762596c934d61fdb3513f9f7dd25e">USB_EPINFO_TXEP_M</a>);
<a name="l04222"></a>04222 }
<a name="l04223"></a>04223 
<a name="l04224"></a>04224 <span class="comment">//*****************************************************************************</span>
<a name="l04225"></a>04225 <span class="comment">//</span>
<a name="l04253"></a>04253 <span class="comment"></span><span class="comment">//</span>
<a name="l04254"></a>04254 <span class="comment">//*****************************************************************************</span>
<a name="l04255"></a>04255 uint32_t
<a name="l04256"></a><a class="code" href="group__usb__api.html#ga9177418f61b680b2b639a1d7e05f7254">04256</a> <a class="code" href="group__usb__api.html#ga9177418f61b680b2b639a1d7e05f7254">USBControllerVersion</a>(uint32_t ui32Base)
<a name="l04257"></a>04257 {
<a name="l04258"></a>04258     <span class="comment">//</span>
<a name="l04259"></a>04259     <span class="comment">// Return the type field of the peripheral properties.  This returns</span>
<a name="l04260"></a>04260     <span class="comment">// zero for all parts that did not have a peripheral property.</span>
<a name="l04261"></a>04261     <span class="comment">//</span>
<a name="l04262"></a>04262     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#abb422006624a234dda1433802a36329e">USB_O_PP</a>) &amp; <a class="code" href="hw__usb_8h.html#a6c45bd00d8c917a15203ca46dde74089">USB_PP_TYPE_M</a>);
<a name="l04263"></a>04263 }
<a name="l04264"></a>04264 
<a name="l04265"></a>04265 <span class="comment">//*****************************************************************************</span>
<a name="l04266"></a>04266 <span class="comment">//</span>
<a name="l04307"></a>04307 <span class="comment"></span><span class="comment">//</span>
<a name="l04308"></a>04308 <span class="comment">//*****************************************************************************</span>
<a name="l04309"></a>04309 <span class="keywordtype">void</span>
<a name="l04310"></a><a class="code" href="group__usb__api.html#ga60145c2e06aa8d7cce86daf655a29e15">04310</a> <a class="code" href="group__usb__api.html#ga60145c2e06aa8d7cce86daf655a29e15">USBClockEnable</a>(uint32_t ui32Base, uint32_t ui32Div, uint32_t ui32Flags)
<a name="l04311"></a>04311 {
<a name="l04312"></a>04312     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04313"></a>04313 
<a name="l04314"></a>04314     <span class="comment">//</span>
<a name="l04315"></a>04315     <span class="comment">// Configure and enable the USB clock input.</span>
<a name="l04316"></a>04316     <span class="comment">//</span>
<a name="l04317"></a>04317     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5d6af4b989fa2dab80cf5841e6dbd2ea">USB_O_CC</a>) = (ui32Div - 1) | ui32Flags;
<a name="l04318"></a>04318 }
<a name="l04319"></a>04319 
<a name="l04320"></a>04320 <span class="comment">//*****************************************************************************</span>
<a name="l04321"></a>04321 <span class="comment">//</span>
<a name="l04343"></a>04343 <span class="comment"></span><span class="comment">//</span>
<a name="l04344"></a>04344 <span class="comment">//*****************************************************************************</span>
<a name="l04345"></a>04345 <span class="keywordtype">void</span>
<a name="l04346"></a><a class="code" href="group__usb__api.html#ga4237d0e76267e32db07a091b9ee1a7d7">04346</a> <a class="code" href="group__usb__api.html#ga4237d0e76267e32db07a091b9ee1a7d7">USBClockDisable</a>(uint32_t ui32Base)
<a name="l04347"></a>04347 {
<a name="l04348"></a>04348     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04349"></a>04349 
<a name="l04350"></a>04350     <span class="comment">//</span>
<a name="l04351"></a>04351     <span class="comment">// Disable the USB clock input.</span>
<a name="l04352"></a>04352     <span class="comment">//</span>
<a name="l04353"></a>04353     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a5d6af4b989fa2dab80cf5841e6dbd2ea">USB_O_CC</a>) = 0;
<a name="l04354"></a>04354 }
<a name="l04355"></a>04355 
<a name="l04356"></a>04356 <span class="comment">//*****************************************************************************</span>
<a name="l04357"></a>04357 <span class="comment">//</span>
<a name="l04358"></a>04358 <span class="comment">// Close the Doxygen group.</span>
<a name="l04360"></a>04360 <span class="comment"></span><span class="comment">//</span>
<a name="l04361"></a>04361 <span class="comment">//*****************************************************************************</span>
<a name="l04362"></a>04362 <span class="comment">//*****************************************************************************</span>
<a name="l04363"></a>04363 <span class="comment">//</span>
<a name="l04366"></a>04366 <span class="comment"></span><span class="comment">//</span>
<a name="l04367"></a>04367 <span class="comment">//*****************************************************************************</span>
<a name="l04368"></a>04368 
<a name="l04369"></a>04369 <span class="comment">//*****************************************************************************</span>
<a name="l04370"></a>04370 <span class="comment">//</span>
<a name="l04395"></a>04395 <span class="comment"></span><span class="comment">//</span>
<a name="l04396"></a>04396 <span class="comment">//*****************************************************************************</span>
<a name="l04397"></a>04397 <span class="keywordtype">void</span>
<a name="l04398"></a><a class="code" href="group__usb__dma.html#ga77aee9e364edc04344e1fc6f71b14713">04398</a> <a class="code" href="group__usb__dma.html#ga77aee9e364edc04344e1fc6f71b14713">USBDMAChannelIntEnable</a>(uint32_t ui32Base, uint32_t ui32Channel)
<a name="l04399"></a>04399 {
<a name="l04400"></a>04400     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04401"></a>04401     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04402"></a>04402 
<a name="l04403"></a>04403     <span class="comment">//</span>
<a name="l04404"></a>04404     <span class="comment">// Enable the specified DMA channel interrupts.</span>
<a name="l04405"></a>04405     <span class="comment">//</span>
<a name="l04406"></a>04406     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) |= <a class="code" href="hw__usb_8h.html#a2d8552602d86ce8638f1d78fdf8056d0">USB_DMACTL0_IE</a>;
<a name="l04407"></a>04407 }
<a name="l04408"></a>04408 
<a name="l04409"></a>04409 <span class="comment">//*****************************************************************************</span>
<a name="l04410"></a>04410 <span class="comment">//</span>
<a name="l04434"></a>04434 <span class="comment"></span><span class="comment">//</span>
<a name="l04435"></a>04435 <span class="comment">//*****************************************************************************</span>
<a name="l04436"></a>04436 <span class="keywordtype">void</span>
<a name="l04437"></a><a class="code" href="group__usb__dma.html#ga415862e2d4ee3232df0f73a699f05579">04437</a> <a class="code" href="group__usb__dma.html#ga415862e2d4ee3232df0f73a699f05579">USBDMAChannelIntDisable</a>(uint32_t ui32Base, uint32_t ui32Channel)
<a name="l04438"></a>04438 {
<a name="l04439"></a>04439     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04440"></a>04440     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04441"></a>04441 
<a name="l04442"></a>04442     <span class="comment">//</span>
<a name="l04443"></a>04443     <span class="comment">// Enable the specified DMA channel interrupts.</span>
<a name="l04444"></a>04444     <span class="comment">//</span>
<a name="l04445"></a>04445     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) &amp;= ~<a class="code" href="hw__usb_8h.html#a2d8552602d86ce8638f1d78fdf8056d0">USB_DMACTL0_IE</a>;
<a name="l04446"></a>04446 }
<a name="l04447"></a>04447 
<a name="l04448"></a>04448 <span class="comment">//*****************************************************************************</span>
<a name="l04449"></a>04449 <span class="comment">//</span>
<a name="l04474"></a>04474 <span class="comment"></span><span class="comment">//</span>
<a name="l04475"></a>04475 <span class="comment">//*****************************************************************************</span>
<a name="l04476"></a>04476 uint32_t
<a name="l04477"></a><a class="code" href="group__usb__dma.html#gae8f15a6a4020e0ad1c035195590f89bb">04477</a> <a class="code" href="group__usb__dma.html#gae8f15a6a4020e0ad1c035195590f89bb">USBDMAChannelIntStatus</a>(uint32_t ui32Base)
<a name="l04478"></a>04478 {
<a name="l04479"></a>04479     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04480"></a>04480 
<a name="l04481"></a>04481     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a008b9375778621639c6c9de2e68b0055">USB_O_DMAINTR</a>));
<a name="l04482"></a>04482 }
<a name="l04483"></a>04483 
<a name="l04484"></a>04484 <span class="comment">//*****************************************************************************</span>
<a name="l04485"></a>04485 <span class="comment">//</span>
<a name="l04509"></a>04509 <span class="comment"></span><span class="comment">//</span>
<a name="l04510"></a>04510 <span class="comment">//*****************************************************************************</span>
<a name="l04511"></a>04511 <span class="keywordtype">void</span>
<a name="l04512"></a><a class="code" href="group__usb__dma.html#ga2b4d71ab71f41973357eb39e51afbdc4">04512</a> <a class="code" href="group__usb__dma.html#ga2b4d71ab71f41973357eb39e51afbdc4">USBDMAChannelEnable</a>(uint32_t ui32Base, uint32_t ui32Channel)
<a name="l04513"></a>04513 {
<a name="l04514"></a>04514     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04515"></a>04515     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04516"></a>04516 
<a name="l04517"></a>04517     <span class="comment">//</span>
<a name="l04518"></a>04518     <span class="comment">// Enable the USB DMA channel.</span>
<a name="l04519"></a>04519     <span class="comment">//</span>
<a name="l04520"></a>04520     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) |=
<a name="l04521"></a>04521         <a class="code" href="hw__usb_8h.html#abda37d2b8022d9b961c9e68ed48a0c19">USB_DMACTL0_ENABLE</a>;
<a name="l04522"></a>04522 }
<a name="l04523"></a>04523 
<a name="l04524"></a>04524 <span class="comment">//*****************************************************************************</span>
<a name="l04525"></a>04525 <span class="comment">//</span>
<a name="l04549"></a>04549 <span class="comment"></span><span class="comment">//</span>
<a name="l04550"></a>04550 <span class="comment">//*****************************************************************************</span>
<a name="l04551"></a>04551 <span class="keywordtype">void</span>
<a name="l04552"></a><a class="code" href="group__usb__dma.html#ga212f4984eca6132f375753e2736ae442">04552</a> <a class="code" href="group__usb__dma.html#ga212f4984eca6132f375753e2736ae442">USBDMAChannelDisable</a>(uint32_t ui32Base, uint32_t ui32Channel)
<a name="l04553"></a>04553 {
<a name="l04554"></a>04554     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04555"></a>04555     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04556"></a>04556 
<a name="l04557"></a>04557     <span class="comment">//</span>
<a name="l04558"></a>04558     <span class="comment">// Disable the USB DMA channel.</span>
<a name="l04559"></a>04559     <span class="comment">//</span>
<a name="l04560"></a>04560     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) &amp;=
<a name="l04561"></a>04561         ~<a class="code" href="hw__usb_8h.html#abda37d2b8022d9b961c9e68ed48a0c19">USB_DMACTL0_ENABLE</a>;
<a name="l04562"></a>04562 }
<a name="l04563"></a>04563 
<a name="l04564"></a>04564 <span class="comment">//*****************************************************************************</span>
<a name="l04565"></a>04565 <span class="comment">//</span>
<a name="l04626"></a>04626 <span class="comment"></span><span class="comment">//</span>
<a name="l04627"></a>04627 <span class="comment">//*****************************************************************************</span>
<a name="l04628"></a>04628 <span class="keywordtype">void</span>
<a name="l04629"></a><a class="code" href="group__usb__dma.html#gacdabf76f4d39f03ecfe50dcd0677bc1f">04629</a> <a class="code" href="group__usb__dma.html#gacdabf76f4d39f03ecfe50dcd0677bc1f">USBDMAChannelConfigSet</a>(uint32_t ui32Base, uint32_t ui32Channel,
<a name="l04630"></a>04630                        uint32_t ui32Endpoint, uint32_t ui32Config)
<a name="l04631"></a>04631 {
<a name="l04632"></a>04632     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04633"></a>04633     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04634"></a>04634     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>((ui32Endpoint &amp; ~<a class="code" href="usb_8h.html#a78dcce1706922dc17a6baf4e8f37150d">USB_EP_7</a>) == 0);
<a name="l04635"></a>04635 
<a name="l04636"></a>04636     <span class="comment">//</span>
<a name="l04637"></a>04637     <span class="comment">// Reset this USB DMA channel.</span>
<a name="l04638"></a>04638     <span class="comment">//</span>
<a name="l04639"></a>04639     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) = 0;
<a name="l04640"></a>04640 
<a name="l04641"></a>04641     <span class="comment">//</span>
<a name="l04642"></a>04642     <span class="comment">// Set the configuration of the requested channel.</span>
<a name="l04643"></a>04643     <span class="comment">//</span>
<a name="l04644"></a>04644     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) =
<a name="l04645"></a>04645         ui32Config | ui32Endpoint;
<a name="l04646"></a>04646 }
<a name="l04647"></a>04647 
<a name="l04648"></a>04648 <span class="comment">//*****************************************************************************</span>
<a name="l04649"></a>04649 <span class="comment">//</span>
<a name="l04676"></a>04676 <span class="comment"></span><span class="comment">//</span>
<a name="l04677"></a>04677 <span class="comment">//*****************************************************************************</span>
<a name="l04678"></a>04678 uint32_t
<a name="l04679"></a><a class="code" href="group__usb__dma.html#gae03dabbb5362185a713f3f312022a444">04679</a> <a class="code" href="group__usb__dma.html#gae03dabbb5362185a713f3f312022a444">USBDMAChannelStatus</a>(uint32_t ui32Base, uint32_t ui32Channel)
<a name="l04680"></a>04680 {
<a name="l04681"></a>04681     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04682"></a>04682     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04683"></a>04683 
<a name="l04684"></a>04684     <span class="comment">//</span>
<a name="l04685"></a>04685     <span class="comment">// Return a non-zero value if there is a pending error condition.</span>
<a name="l04686"></a>04686     <span class="comment">//</span>
<a name="l04687"></a>04687     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) &amp;
<a name="l04688"></a>04688            <a class="code" href="hw__usb_8h.html#a2aa0d9059966cc72cee8a4aa076b5994">USB_DMACTL0_ERR</a>);
<a name="l04689"></a>04689 }
<a name="l04690"></a>04690 
<a name="l04691"></a>04691 <span class="comment">//*****************************************************************************</span>
<a name="l04692"></a>04692 <span class="comment">//</span>
<a name="l04719"></a>04719 <span class="comment"></span><span class="comment">//</span>
<a name="l04720"></a>04720 <span class="comment">//*****************************************************************************</span>
<a name="l04721"></a>04721 <span class="keywordtype">void</span>
<a name="l04722"></a><a class="code" href="group__usb__dma.html#ga73f68ad10c5e6c3146c63210c0c1f959">04722</a> <a class="code" href="group__usb__dma.html#ga73f68ad10c5e6c3146c63210c0c1f959">USBDMAChannelStatusClear</a>(uint32_t ui32Base, uint32_t ui32Channel,
<a name="l04723"></a>04723                          uint32_t ui32Status)
<a name="l04724"></a>04724 {
<a name="l04725"></a>04725     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04726"></a>04726     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04727"></a>04727 
<a name="l04728"></a>04728     <span class="comment">//</span>
<a name="l04729"></a>04729     <span class="comment">// The only status is the error bit.</span>
<a name="l04730"></a>04730     <span class="comment">//</span>
<a name="l04731"></a>04731     ui32Status &amp;= <a class="code" href="hw__usb_8h.html#a2aa0d9059966cc72cee8a4aa076b5994">USB_DMACTL0_ERR</a>;
<a name="l04732"></a>04732 
<a name="l04733"></a>04733     <span class="comment">//</span>
<a name="l04734"></a>04734     <span class="comment">// Clear the specified error condition.</span>
<a name="l04735"></a>04735     <span class="comment">//</span>
<a name="l04736"></a>04736     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a361cb2df4492fbf667c0f287d50ed1db">USB_O_DMACTL0</a> + (0x10 * ui32Channel)) &amp;= ~ui32Status;
<a name="l04737"></a>04737 }
<a name="l04738"></a>04738 
<a name="l04739"></a>04739 <span class="comment">//*****************************************************************************</span>
<a name="l04740"></a>04740 <span class="comment">//</span>
<a name="l04772"></a>04772 <span class="comment"></span><span class="comment">//</span>
<a name="l04773"></a>04773 <span class="comment">//*****************************************************************************</span>
<a name="l04774"></a>04774 <span class="keywordtype">void</span>
<a name="l04775"></a><a class="code" href="group__usb__dma.html#ga692a82ab7842c5d384a5b80b628d89ab">04775</a> <a class="code" href="group__usb__dma.html#ga692a82ab7842c5d384a5b80b628d89ab">USBDMAChannelAddressSet</a>(uint32_t ui32Base, uint32_t ui32Channel,
<a name="l04776"></a>04776                         <span class="keywordtype">void</span> *pvAddress)
<a name="l04777"></a>04777 {
<a name="l04778"></a>04778     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04779"></a>04779     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04780"></a>04780 
<a name="l04781"></a>04781     <span class="comment">//</span>
<a name="l04782"></a>04782     <span class="comment">// Set the DMA address.</span>
<a name="l04783"></a>04783     <span class="comment">//</span>
<a name="l04784"></a>04784     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a2df7cb40a911b7d12b533792aaa285ef">USB_O_DMAADDR0</a> + (0x10 * ui32Channel)) =
<a name="l04785"></a>04785         (uint32_t)pvAddress;
<a name="l04786"></a>04786 }
<a name="l04787"></a>04787 
<a name="l04788"></a>04788 <span class="comment">//*****************************************************************************</span>
<a name="l04789"></a>04789 <span class="comment">//</span>
<a name="l04818"></a>04818 <span class="comment"></span><span class="comment">//</span>
<a name="l04819"></a>04819 <span class="comment">//*****************************************************************************</span>
<a name="l04820"></a>04820 <span class="keywordtype">void</span> *
<a name="l04821"></a><a class="code" href="group__usb__dma.html#gae03a26fb7be0eb5488ac17907a66cf3c">04821</a> <a class="code" href="group__usb__dma.html#gae03a26fb7be0eb5488ac17907a66cf3c">USBDMAChannelAddressGet</a>(uint32_t ui32Base, uint32_t ui32Channel)
<a name="l04822"></a>04822 {
<a name="l04823"></a>04823     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04824"></a>04824     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04825"></a>04825 
<a name="l04826"></a>04826     <span class="comment">//</span>
<a name="l04827"></a>04827     <span class="comment">// Return the current DMA address.</span>
<a name="l04828"></a>04828     <span class="comment">//</span>
<a name="l04829"></a>04829     <span class="keywordflow">return</span>((<span class="keywordtype">void</span> *)<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a2df7cb40a911b7d12b533792aaa285ef">USB_O_DMAADDR0</a> + (0x10 * ui32Channel)));
<a name="l04830"></a>04830 }
<a name="l04831"></a>04831 
<a name="l04832"></a>04832 <span class="comment">//*****************************************************************************</span>
<a name="l04833"></a>04833 <span class="comment">//</span>
<a name="l04858"></a>04858 <span class="comment"></span><span class="comment">//</span>
<a name="l04859"></a>04859 <span class="comment">//*****************************************************************************</span>
<a name="l04860"></a>04860 <span class="keywordtype">void</span>
<a name="l04861"></a><a class="code" href="group__usb__dma.html#ga3f4f180a5bd20893fd402b0b4d7b7886">04861</a> <a class="code" href="group__usb__dma.html#ga3f4f180a5bd20893fd402b0b4d7b7886">USBDMAChannelCountSet</a>(uint32_t ui32Base, uint32_t ui32Channel,
<a name="l04862"></a>04862                       uint32_t ui32Count)
<a name="l04863"></a>04863 {
<a name="l04864"></a>04864     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04865"></a>04865     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04866"></a>04866 
<a name="l04867"></a>04867     <span class="comment">//</span>
<a name="l04868"></a>04868     <span class="comment">// Set the USB DMA count for the channel.</span>
<a name="l04869"></a>04869     <span class="comment">//</span>
<a name="l04870"></a>04870     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a7dbffb6b71dfe8897702b751a25f4771">USB_O_DMACOUNT0</a> + (0x10 * ui32Channel)) = ui32Count;
<a name="l04871"></a>04871 }
<a name="l04872"></a>04872 
<a name="l04873"></a>04873 <span class="comment">//*****************************************************************************</span>
<a name="l04874"></a>04874 <span class="comment">//</span>
<a name="l04900"></a>04900 <span class="comment"></span><span class="comment">//</span>
<a name="l04901"></a>04901 <span class="comment">//*****************************************************************************</span>
<a name="l04902"></a>04902 uint32_t
<a name="l04903"></a><a class="code" href="group__usb__dma.html#gacf4864fa2f90e5cea107cc0447c4c167">04903</a> <a class="code" href="group__usb__dma.html#gacf4864fa2f90e5cea107cc0447c4c167">USBDMAChannelCountGet</a>(uint32_t ui32Base, uint32_t ui32Channel)
<a name="l04904"></a>04904 {
<a name="l04905"></a>04905     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04906"></a>04906     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Channel &lt; 8);
<a name="l04907"></a>04907 
<a name="l04908"></a>04908     <span class="comment">//</span>
<a name="l04909"></a>04909     <span class="comment">// Return the current DMA count.</span>
<a name="l04910"></a>04910     <span class="comment">//</span>
<a name="l04911"></a>04911     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a7dbffb6b71dfe8897702b751a25f4771">USB_O_DMACOUNT0</a> + (0x10 * ui32Channel)));
<a name="l04912"></a>04912 }
<a name="l04913"></a>04913 
<a name="l04914"></a>04914 <span class="comment">//*****************************************************************************</span>
<a name="l04915"></a>04915 <span class="comment">//</span>
<a name="l04937"></a>04937 <span class="comment"></span><span class="comment">//</span>
<a name="l04938"></a>04938 <span class="comment">//*****************************************************************************</span>
<a name="l04939"></a>04939 uint32_t
<a name="l04940"></a><a class="code" href="group__usb__dma.html#ga3b47c1c961ea1b8f7757e3ad47076586">04940</a> <a class="code" href="group__usb__dma.html#ga3b47c1c961ea1b8f7757e3ad47076586">USBDMANumChannels</a>(uint32_t ui32Base)
<a name="l04941"></a>04941 {
<a name="l04942"></a>04942     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l04943"></a>04943 
<a name="l04944"></a>04944     <span class="comment">//</span>
<a name="l04945"></a>04945     <span class="comment">// Return the number of DMA channels for the integrated DMA controller.</span>
<a name="l04946"></a>04946     <span class="comment">//</span>
<a name="l04947"></a>04947     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a2cd33bd2d0a8f3eaba895455fb46c82a">USB_O_RAMINFO</a>) &gt;&gt; <a class="code" href="hw__usb_8h.html#a7385095daf3f8ccb2a113a180801b3d8">USB_RAMINFO_DMACHAN_S</a>);
<a name="l04948"></a>04948 }
<a name="l04949"></a>04949 <span class="comment">//*****************************************************************************</span>
<a name="l04950"></a>04950 <span class="comment">//</span>
<a name="l04951"></a>04951 <span class="comment">// Close the Doxygen group.</span>
<a name="l04953"></a>04953 <span class="comment"></span><span class="comment">//</span>
<a name="l04954"></a>04954 <span class="comment">//*****************************************************************************</span>
<a name="l04955"></a>04955 <span class="comment">//*****************************************************************************</span>
<a name="l04956"></a>04956 <span class="comment">//</span>
<a name="l04959"></a>04959 <span class="comment"></span><span class="comment">//</span>
<a name="l04960"></a>04960 <span class="comment">//*****************************************************************************</span>
<a name="l04961"></a>04961 
<a name="l04962"></a>04962 <span class="comment">//*****************************************************************************</span>
<a name="l04963"></a>04963 <span class="comment">//</span>
<a name="l04992"></a>04992 <span class="comment"></span><span class="comment">//</span>
<a name="l04993"></a>04993 <span class="comment">//*****************************************************************************</span>
<a name="l04994"></a>04994 <span class="keywordtype">void</span>
<a name="l04995"></a><a class="code" href="group__usb__ulpi.html#gaf2c3a968afb73b74105295bea778aaa8">04995</a> <a class="code" href="group__usb__ulpi.html#gaf2c3a968afb73b74105295bea778aaa8">USBULPIConfig</a>(uint32_t ui32Base, uint32_t ui32Config)
<a name="l04996"></a>04996 {
<a name="l04997"></a>04997     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a4692c04ec3700870ce679f95cae8cd45">USB_O_ULPIVBUSCTL</a>) = (uint8_t)ui32Config;
<a name="l04998"></a>04998 }
<a name="l04999"></a>04999 
<a name="l05000"></a>05000 <span class="comment">//*****************************************************************************</span>
<a name="l05001"></a>05001 <span class="comment">//</span>
<a name="l05023"></a>05023 <span class="comment"></span><span class="comment">//</span>
<a name="l05024"></a>05024 <span class="comment">//*****************************************************************************</span>
<a name="l05025"></a>05025 <span class="keywordtype">void</span>
<a name="l05026"></a><a class="code" href="group__usb__ulpi.html#gadbceed99f796a20718ee0d2657bda388">05026</a> <a class="code" href="group__usb__ulpi.html#gadbceed99f796a20718ee0d2657bda388">USBULPIEnable</a>(uint32_t ui32Base)
<a name="l05027"></a>05027 {
<a name="l05028"></a>05028     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a760a6fb3204bc35b94800863d54f4508">USB_O_PC</a>) |= <a class="code" href="hw__usb_8h.html#a1579d208382ab4985a1a4ebf2d146efc">USB_PC_ULPIEN</a>;
<a name="l05029"></a>05029 }
<a name="l05030"></a>05030 
<a name="l05031"></a>05031 <span class="comment">//*****************************************************************************</span>
<a name="l05032"></a>05032 <span class="comment">//</span>
<a name="l05055"></a>05055 <span class="comment"></span><span class="comment">//</span>
<a name="l05056"></a>05056 <span class="comment">//*****************************************************************************</span>
<a name="l05057"></a>05057 <span class="keywordtype">void</span>
<a name="l05058"></a><a class="code" href="group__usb__ulpi.html#ga638fdb6535be496974139d21c5a236ea">05058</a> <a class="code" href="group__usb__ulpi.html#ga638fdb6535be496974139d21c5a236ea">USBULPIDisable</a>(uint32_t ui32Base)
<a name="l05059"></a>05059 {
<a name="l05060"></a>05060     <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a760a6fb3204bc35b94800863d54f4508">USB_O_PC</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a1579d208382ab4985a1a4ebf2d146efc">USB_PC_ULPIEN</a>;
<a name="l05061"></a>05061 }
<a name="l05062"></a>05062 
<a name="l05063"></a>05063 <span class="comment">//*****************************************************************************</span>
<a name="l05064"></a>05064 <span class="comment">//</span>
<a name="l05091"></a>05091 <span class="comment"></span><span class="comment">//</span>
<a name="l05092"></a>05092 <span class="comment">//*****************************************************************************</span>
<a name="l05093"></a>05093 uint8_t
<a name="l05094"></a><a class="code" href="group__usb__ulpi.html#ga842391b4ee166c0f600b150ad9c94dce">05094</a> <a class="code" href="group__usb__ulpi.html#ga842391b4ee166c0f600b150ad9c94dce">USBULPIRegRead</a>(uint32_t ui32Base, uint8_t ui8Reg)
<a name="l05095"></a>05095 {
<a name="l05096"></a>05096     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05097"></a>05097 
<a name="l05098"></a>05098     <span class="comment">//</span>
<a name="l05099"></a>05099     <span class="comment">// Set the register address and initiate a read access.</span>
<a name="l05100"></a>05100     <span class="comment">//</span>
<a name="l05101"></a>05101     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ab1c98e3b082a0aa7929df9dc3588aa50">USB_O_ULPIREGADDR</a>) = ui8Reg;
<a name="l05102"></a>05102     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ac2a5492ee957c88ac7c2995954d7516b">USB_O_ULPIREGCTL</a>) =
<a name="l05103"></a>05103         <a class="code" href="hw__usb_8h.html#ad1ce6d2fe2c451a80bb73ab22020fa40">USB_ULPIREGCTL_RDWR</a> | <a class="code" href="hw__usb_8h.html#a408194fdc03ba99939b154f79a48d6fc">USB_ULPIREGCTL_REGACC</a>;
<a name="l05104"></a>05104 
<a name="l05105"></a>05105     <span class="comment">//</span>
<a name="l05106"></a>05106     <span class="comment">// Wait for the access to complete.</span>
<a name="l05107"></a>05107     <span class="comment">//</span>
<a name="l05108"></a>05108     <span class="keywordflow">while</span>((<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ac2a5492ee957c88ac7c2995954d7516b">USB_O_ULPIREGCTL</a>) &amp; <a class="code" href="hw__usb_8h.html#a48a3127e7040fbdfcee8626ead215ec8">USB_ULPIREGCTL_REGCMPLT</a>) == 0)
<a name="l05109"></a>05109     {
<a name="l05110"></a>05110     }
<a name="l05111"></a>05111 
<a name="l05112"></a>05112     <span class="comment">//</span>
<a name="l05113"></a>05113     <span class="comment">// Clear the register access complete flag.</span>
<a name="l05114"></a>05114     <span class="comment">//</span>
<a name="l05115"></a>05115     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ac2a5492ee957c88ac7c2995954d7516b">USB_O_ULPIREGCTL</a>) = 0;
<a name="l05116"></a>05116 
<a name="l05117"></a>05117     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aabf156d8b7e51422db3b6768c31bc1c2">USB_O_ULPIREGDATA</a>));
<a name="l05118"></a>05118 }
<a name="l05119"></a>05119 
<a name="l05120"></a>05120 <span class="comment">//*****************************************************************************</span>
<a name="l05121"></a>05121 <span class="comment">//</span>
<a name="l05148"></a>05148 <span class="comment"></span><span class="comment">//</span>
<a name="l05149"></a>05149 <span class="comment">//*****************************************************************************</span>
<a name="l05150"></a>05150 <span class="keywordtype">void</span>
<a name="l05151"></a><a class="code" href="group__usb__ulpi.html#ga521f82634dfde3f98e96d789b4ea7008">05151</a> <a class="code" href="group__usb__ulpi.html#ga521f82634dfde3f98e96d789b4ea7008">USBULPIRegWrite</a>(uint32_t ui32Base, uint8_t ui8Reg, uint8_t ui8Data)
<a name="l05152"></a>05152 {
<a name="l05153"></a>05153     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05154"></a>05154 
<a name="l05155"></a>05155     <span class="comment">//</span>
<a name="l05156"></a>05156     <span class="comment">// Set the register address and initiate a read access.</span>
<a name="l05157"></a>05157     <span class="comment">//</span>
<a name="l05158"></a>05158     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ab1c98e3b082a0aa7929df9dc3588aa50">USB_O_ULPIREGADDR</a>) = ui8Reg;
<a name="l05159"></a>05159     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#aabf156d8b7e51422db3b6768c31bc1c2">USB_O_ULPIREGDATA</a>) = ui8Data;
<a name="l05160"></a>05160     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ac2a5492ee957c88ac7c2995954d7516b">USB_O_ULPIREGCTL</a>) = <a class="code" href="hw__usb_8h.html#a408194fdc03ba99939b154f79a48d6fc">USB_ULPIREGCTL_REGACC</a>;
<a name="l05161"></a>05161 
<a name="l05162"></a>05162     <span class="comment">//</span>
<a name="l05163"></a>05163     <span class="comment">// Wait for the access to complete.</span>
<a name="l05164"></a>05164     <span class="comment">//</span>
<a name="l05165"></a>05165     <span class="keywordflow">while</span>((<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ac2a5492ee957c88ac7c2995954d7516b">USB_O_ULPIREGCTL</a>) &amp; <a class="code" href="hw__usb_8h.html#a48a3127e7040fbdfcee8626ead215ec8">USB_ULPIREGCTL_REGCMPLT</a>) == 0)
<a name="l05166"></a>05166     {
<a name="l05167"></a>05167     }
<a name="l05168"></a>05168 
<a name="l05169"></a>05169     <span class="comment">//</span>
<a name="l05170"></a>05170     <span class="comment">// Clear the register access complete flag.</span>
<a name="l05171"></a>05171     <span class="comment">//</span>
<a name="l05172"></a>05172     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ac2a5492ee957c88ac7c2995954d7516b">USB_O_ULPIREGCTL</a>) = 0;
<a name="l05173"></a>05173 }
<a name="l05174"></a>05174 
<a name="l05175"></a>05175 <span class="comment">//*****************************************************************************</span>
<a name="l05176"></a>05176 <span class="comment">//</span>
<a name="l05177"></a>05177 <span class="comment">// Close the Doxygen group.</span>
<a name="l05179"></a>05179 <span class="comment"></span><span class="comment">//</span>
<a name="l05180"></a>05180 <span class="comment">//*****************************************************************************</span>
<a name="l05181"></a>05181 <span class="comment">//*****************************************************************************</span>
<a name="l05182"></a>05182 <span class="comment">//</span>
<a name="l05185"></a>05185 <span class="comment"></span><span class="comment">//</span>
<a name="l05186"></a>05186 <span class="comment">//*****************************************************************************</span>
<a name="l05187"></a>05187 
<a name="l05188"></a>05188 <span class="comment">//*****************************************************************************</span>
<a name="l05189"></a>05189 <span class="comment">//</span>
<a name="l05221"></a>05221 <span class="comment"></span><span class="comment">//</span>
<a name="l05222"></a>05222 <span class="comment">//*****************************************************************************</span>
<a name="l05223"></a>05223 <span class="keywordtype">void</span>
<a name="l05224"></a><a class="code" href="group__usb__lpm.html#ga93fca23ee70d3c315aad72edb35a71d5">05224</a> <a class="code" href="group__usb__lpm.html#ga93fca23ee70d3c315aad72edb35a71d5">USBHostLPMSend</a>(uint32_t ui32Base, uint32_t ui32Address, uint32_t ui32Endpoint)
<a name="l05225"></a>05225 {
<a name="l05226"></a>05226     uint32_t ui32Reg;
<a name="l05227"></a>05227 
<a name="l05228"></a>05228     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05229"></a>05229     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Address &lt; 127);
<a name="l05230"></a>05230 
<a name="l05231"></a>05231     <span class="comment">//</span>
<a name="l05232"></a>05232     <span class="comment">// Set the address and endpoint.</span>
<a name="l05233"></a>05233     <span class="comment">//</span>
<a name="l05234"></a>05234     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ab32ef99011ab550e784c893000a6ca81">USB_O_LPMFADDR</a>) = ui32Address;
<a name="l05235"></a>05235 
<a name="l05236"></a>05236     ui32Reg = <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a69c76a0345ed482ad9d7f1030b9a0df6">USB_O_LPMATTR</a>) &amp; ~<a class="code" href="hw__usb_8h.html#a0e38ef4e1b1619f1164fd5d0b439d88e">USB_LPMATTR_ENDPT_M</a>;
<a name="l05237"></a>05237     ui32Reg |= (<a class="code" href="usb_8h.html#a0b593946928f1a9c4c75ac78ee6d6f89">USBEPToIndex</a>(ui32Endpoint) &lt;&lt; <a class="code" href="hw__usb_8h.html#ae371fb6b2cafdd3e50e1d1acdfac4d76">USB_LPMATTR_ENDPT_S</a>);
<a name="l05238"></a>05238 
<a name="l05239"></a>05239     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a69c76a0345ed482ad9d7f1030b9a0df6">USB_O_LPMATTR</a>) = ui32Reg;
<a name="l05240"></a>05240 
<a name="l05241"></a>05241     <span class="comment">//</span>
<a name="l05242"></a>05242     <span class="comment">// Send the LPM transaction.</span>
<a name="l05243"></a>05243     <span class="comment">//</span>
<a name="l05244"></a>05244     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae98433d378890fc680a2e810982259c9">USB_O_LPMCNTRL</a>) |= <a class="code" href="hw__usb_8h.html#a78a4722c5b4364c20f2b95ccac8df621">USB_LPMCNTRL_TXLPM</a>;
<a name="l05245"></a>05245 }
<a name="l05246"></a>05246 
<a name="l05247"></a>05247 <span class="comment">//*****************************************************************************</span>
<a name="l05248"></a>05248 <span class="comment">//</span>
<a name="l05287"></a>05287 <span class="comment"></span><span class="comment">//</span>
<a name="l05288"></a>05288 <span class="comment">//*****************************************************************************</span>
<a name="l05289"></a>05289 <span class="keywordtype">void</span>
<a name="l05290"></a><a class="code" href="group__usb__lpm.html#gab2da4122a53a783a3bdd447a3f5f4eec">05290</a> <a class="code" href="group__usb__lpm.html#gab2da4122a53a783a3bdd447a3f5f4eec">USBHostLPMConfig</a>(uint32_t ui32Base, uint32_t ui32ResumeTime,
<a name="l05291"></a>05291                  uint32_t ui32Config)
<a name="l05292"></a>05292 {
<a name="l05293"></a>05293     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05294"></a>05294     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32ResumeTime &lt;= 1175);
<a name="l05295"></a>05295     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32ResumeTime &gt;= 50);
<a name="l05296"></a>05296 
<a name="l05297"></a>05297     <span class="comment">//</span>
<a name="l05298"></a>05298     <span class="comment">// Set the Host Initiated Resume Duration, Remote wake and Suspend mode.</span>
<a name="l05299"></a>05299     <span class="comment">//</span>
<a name="l05300"></a>05300     <a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a69c76a0345ed482ad9d7f1030b9a0df6">USB_O_LPMATTR</a>) =
<a name="l05301"></a>05301         ui32Config | ((ui32ResumeTime - 50) / 75) &lt;&lt; <a class="code" href="hw__usb_8h.html#a1eb557a32b14fc6c4ce11417c207c3a0">USB_LPMATTR_HIRD_S</a>;
<a name="l05302"></a>05302 }
<a name="l05303"></a>05303 
<a name="l05304"></a>05304 <span class="comment">//*****************************************************************************</span>
<a name="l05305"></a>05305 <span class="comment">//</span>
<a name="l05330"></a>05330 <span class="comment"></span><span class="comment">//</span>
<a name="l05331"></a>05331 <span class="comment">//*****************************************************************************</span>
<a name="l05332"></a>05332 <span class="keywordtype">void</span>
<a name="l05333"></a><a class="code" href="group__usb__lpm.html#gaf40115d2a71ba29bb764721105d07711">05333</a> <a class="code" href="group__usb__lpm.html#gaf40115d2a71ba29bb764721105d07711">USBHostLPMResume</a>(uint32_t ui32Base)
<a name="l05334"></a>05334 {
<a name="l05335"></a>05335     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05336"></a>05336 
<a name="l05337"></a>05337     <span class="comment">//</span>
<a name="l05338"></a>05338     <span class="comment">// Send Resume signaling.</span>
<a name="l05339"></a>05339     <span class="comment">//</span>
<a name="l05340"></a>05340     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae98433d378890fc680a2e810982259c9">USB_O_LPMCNTRL</a>) |= <a class="code" href="hw__usb_8h.html#a06b0a7b0a3ee017fead4140eb1fadf34">USB_LPMCNTRL_RES</a>;
<a name="l05341"></a>05341 }
<a name="l05342"></a>05342 
<a name="l05343"></a>05343 <span class="comment">//*****************************************************************************</span>
<a name="l05344"></a>05344 <span class="comment">//</span>
<a name="l05368"></a>05368 <span class="comment"></span><span class="comment">//</span>
<a name="l05369"></a>05369 <span class="comment">//*****************************************************************************</span>
<a name="l05370"></a>05370 <span class="keywordtype">void</span>
<a name="l05371"></a><a class="code" href="group__usb__lpm.html#ga092f417e2a297be6e426aa3ecfb63615">05371</a> <a class="code" href="group__usb__lpm.html#ga092f417e2a297be6e426aa3ecfb63615">USBDevLPMRemoteWake</a>(uint32_t ui32Base)
<a name="l05372"></a>05372 {
<a name="l05373"></a>05373     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05374"></a>05374 
<a name="l05375"></a>05375     <span class="comment">//</span>
<a name="l05376"></a>05376     <span class="comment">// Send remote wake signaling.</span>
<a name="l05377"></a>05377     <span class="comment">//</span>
<a name="l05378"></a>05378     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae98433d378890fc680a2e810982259c9">USB_O_LPMCNTRL</a>) |= <a class="code" href="hw__usb_8h.html#a06b0a7b0a3ee017fead4140eb1fadf34">USB_LPMCNTRL_RES</a>;
<a name="l05379"></a>05379 }
<a name="l05380"></a>05380 
<a name="l05381"></a>05381 <span class="comment">//*****************************************************************************</span>
<a name="l05382"></a>05382 <span class="comment">//</span>
<a name="l05426"></a>05426 <span class="comment"></span><span class="comment">//</span>
<a name="l05427"></a>05427 <span class="comment">//*****************************************************************************</span>
<a name="l05428"></a>05428 <span class="keywordtype">void</span>
<a name="l05429"></a><a class="code" href="group__usb__lpm.html#ga5c0c08c6d3c193f6db2eda268b46dc42">05429</a> <a class="code" href="group__usb__lpm.html#ga5c0c08c6d3c193f6db2eda268b46dc42">USBDevLPMConfig</a>(uint32_t ui32Base, uint32_t ui32Config)
<a name="l05430"></a>05430 {
<a name="l05431"></a>05431     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05432"></a>05432 
<a name="l05433"></a>05433     <span class="comment">//</span>
<a name="l05434"></a>05434     <span class="comment">// Set the device LPM configuration.</span>
<a name="l05435"></a>05435     <span class="comment">//</span>
<a name="l05436"></a>05436     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae98433d378890fc680a2e810982259c9">USB_O_LPMCNTRL</a>) = ui32Config;
<a name="l05437"></a>05437 }
<a name="l05438"></a>05438 
<a name="l05439"></a>05439 <span class="comment">//*****************************************************************************</span>
<a name="l05440"></a>05440 <span class="comment">//</span>
<a name="l05470"></a>05470 <span class="comment"></span><span class="comment">//</span>
<a name="l05471"></a>05471 <span class="comment">//*****************************************************************************</span>
<a name="l05472"></a>05472 <span class="keywordtype">void</span>
<a name="l05473"></a><a class="code" href="group__usb__lpm.html#ga2b9bf534386fa02ad13b0ada5e9d822a">05473</a> <a class="code" href="group__usb__lpm.html#ga2b9bf534386fa02ad13b0ada5e9d822a">USBDevLPMEnable</a>(uint32_t ui32Base)
<a name="l05474"></a>05474 {
<a name="l05475"></a>05475     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05476"></a>05476 
<a name="l05477"></a>05477     <span class="comment">//</span>
<a name="l05478"></a>05478     <span class="comment">// Enable L1 mode on the next LPM transaction.</span>
<a name="l05479"></a>05479     <span class="comment">//</span>
<a name="l05480"></a>05480     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae98433d378890fc680a2e810982259c9">USB_O_LPMCNTRL</a>) |=
<a name="l05481"></a>05481         <a class="code" href="hw__usb_8h.html#a8be32d3576e40d7a584c1ad7f609aeaa">USB_LPMCNTRL_EN_LPMEXT</a> | <a class="code" href="hw__usb_8h.html#a78a4722c5b4364c20f2b95ccac8df621">USB_LPMCNTRL_TXLPM</a>;
<a name="l05482"></a>05482 }
<a name="l05483"></a>05483 
<a name="l05484"></a>05484 <span class="comment">//*****************************************************************************</span>
<a name="l05485"></a>05485 <span class="comment">//</span>
<a name="l05514"></a>05514 <span class="comment"></span><span class="comment">//</span>
<a name="l05515"></a>05515 <span class="comment">//*****************************************************************************</span>
<a name="l05516"></a>05516 <span class="keywordtype">void</span>
<a name="l05517"></a><a class="code" href="group__usb__lpm.html#ga4b59342a0637a1760e907f0ba8d7fb0b">05517</a> <a class="code" href="group__usb__lpm.html#ga4b59342a0637a1760e907f0ba8d7fb0b">USBDevLPMDisable</a>(uint32_t ui32Base)
<a name="l05518"></a>05518 {
<a name="l05519"></a>05519     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05520"></a>05520 
<a name="l05521"></a>05521     <span class="comment">//</span>
<a name="l05522"></a>05522     <span class="comment">// Disable auto entering L1 mode on LPM transactions.</span>
<a name="l05523"></a>05523     <span class="comment">//</span>
<a name="l05524"></a>05524     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#ae98433d378890fc680a2e810982259c9">USB_O_LPMCNTRL</a>) &amp;= ~<a class="code" href="hw__usb_8h.html#a78a4722c5b4364c20f2b95ccac8df621">USB_LPMCNTRL_TXLPM</a>;
<a name="l05525"></a>05525 }
<a name="l05526"></a>05526 
<a name="l05527"></a>05527 <span class="comment">//*****************************************************************************</span>
<a name="l05528"></a>05528 <span class="comment">//</span>
<a name="l05572"></a>05572 <span class="comment"></span><span class="comment">//</span>
<a name="l05573"></a>05573 <span class="comment">//*****************************************************************************</span>
<a name="l05574"></a>05574 uint32_t
<a name="l05575"></a><a class="code" href="group__usb__lpm.html#ga87af42a42cd5926ba7bd8a82946ebf9c">05575</a> <a class="code" href="group__usb__lpm.html#ga87af42a42cd5926ba7bd8a82946ebf9c">USBLPMLinkStateGet</a>(uint32_t ui32Base)
<a name="l05576"></a>05576 {
<a name="l05577"></a>05577     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05578"></a>05578 
<a name="l05579"></a>05579     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a69c76a0345ed482ad9d7f1030b9a0df6">USB_O_LPMATTR</a>) &amp; <a class="code" href="hw__usb_8h.html#ae40e97322df492108fce440b0e187443">USB_LPMATTR_LS_M</a>);
<a name="l05580"></a>05580 }
<a name="l05581"></a>05581 
<a name="l05582"></a>05582 <span class="comment">//*****************************************************************************</span>
<a name="l05583"></a>05583 <span class="comment">//</span>
<a name="l05615"></a>05615 <span class="comment"></span><span class="comment">//</span>
<a name="l05616"></a>05616 <span class="comment">//*****************************************************************************</span>
<a name="l05617"></a>05617 uint32_t
<a name="l05618"></a><a class="code" href="group__usb__lpm.html#ga0df1f20eccf05dc7c7b46f8b30467d83">05618</a> <a class="code" href="group__usb__lpm.html#ga0df1f20eccf05dc7c7b46f8b30467d83">USBLPMEndpointGet</a>(uint32_t ui32Base)
<a name="l05619"></a>05619 {
<a name="l05620"></a>05620     uint32_t ui32Endpoint;
<a name="l05621"></a>05621 
<a name="l05622"></a>05622     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05623"></a>05623 
<a name="l05624"></a>05624     ui32Endpoint = (<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a69c76a0345ed482ad9d7f1030b9a0df6">USB_O_LPMATTR</a>) &amp; <a class="code" href="hw__usb_8h.html#a0e38ef4e1b1619f1164fd5d0b439d88e">USB_LPMATTR_ENDPT_M</a>) &gt;&gt;
<a name="l05625"></a>05625                    <a class="code" href="hw__usb_8h.html#ae371fb6b2cafdd3e50e1d1acdfac4d76">USB_LPMATTR_ENDPT_S</a>;
<a name="l05626"></a>05626 
<a name="l05627"></a>05627     <span class="keywordflow">return</span>(<a class="code" href="usb_8h.html#adc2152c0042517fba5f98f9a77a56e33">IndexToUSBEP</a>(ui32Endpoint));
<a name="l05628"></a>05628 }
<a name="l05629"></a>05629 
<a name="l05630"></a>05630 <span class="comment">//*****************************************************************************</span>
<a name="l05631"></a>05631 <span class="comment">//</span>
<a name="l05659"></a>05659 <span class="comment"></span><span class="comment">//</span>
<a name="l05660"></a>05660 <span class="comment">//*****************************************************************************</span>
<a name="l05661"></a>05661 <span class="keywordtype">bool</span>
<a name="l05662"></a><a class="code" href="group__usb__lpm.html#ga56ea1183888f99d9b9b6e6660821bfa9">05662</a> <a class="code" href="group__usb__lpm.html#ga56ea1183888f99d9b9b6e6660821bfa9">USBLPMRemoteWakeEnabled</a>(uint32_t ui32Base)
<a name="l05663"></a>05663 {
<a name="l05664"></a>05664     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05665"></a>05665 
<a name="l05666"></a>05666     <span class="keywordflow">if</span>(<a class="code" href="hw__types_8h.html#ac664ac49fa3d7c414f67572e522a74fb">HWREGH</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a69c76a0345ed482ad9d7f1030b9a0df6">USB_O_LPMATTR</a>) &amp; <a class="code" href="hw__usb_8h.html#abfdeb7f32fee83af7f486e9c1f4699a6">USB_LPMATTR_RMTWAK</a>)
<a name="l05667"></a>05667     {
<a name="l05668"></a>05668         <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l05669"></a>05669     }
<a name="l05670"></a>05670     <span class="keywordflow">return</span>(<span class="keyword">false</span>);
<a name="l05671"></a>05671 }
<a name="l05672"></a>05672 
<a name="l05673"></a>05673 <span class="comment">//*****************************************************************************</span>
<a name="l05674"></a>05674 <span class="comment">//</span>
<a name="l05746"></a>05746 <span class="comment"></span><span class="comment">//</span>
<a name="l05747"></a>05747 <span class="comment">//*****************************************************************************</span>
<a name="l05748"></a>05748 uint32_t
<a name="l05749"></a><a class="code" href="group__usb__lpm.html#ga87c3f4c04d94b649bdeea78b73abdddf">05749</a> <a class="code" href="group__usb__lpm.html#ga87c3f4c04d94b649bdeea78b73abdddf">USBLPMIntStatus</a>(uint32_t ui32Base)
<a name="l05750"></a>05750 {
<a name="l05751"></a>05751     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05752"></a>05752 
<a name="l05753"></a>05753     <span class="comment">//</span>
<a name="l05754"></a>05754     <span class="comment">// Return the current raw interrupt status.</span>
<a name="l05755"></a>05755     <span class="comment">//</span>
<a name="l05756"></a>05756     <span class="keywordflow">return</span>(<a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a1bca65e59cc1cc7397c477a2ec596f10">USB_O_LPMRIS</a>));
<a name="l05757"></a>05757 }
<a name="l05758"></a>05758 
<a name="l05759"></a>05759 <span class="comment">//*****************************************************************************</span>
<a name="l05760"></a>05760 <span class="comment">//</span>
<a name="l05819"></a>05819 <span class="comment"></span><span class="comment">//</span>
<a name="l05820"></a>05820 <span class="comment">//*****************************************************************************</span>
<a name="l05821"></a>05821 <span class="keywordtype">void</span>
<a name="l05822"></a><a class="code" href="group__usb__lpm.html#gabf62f681f8c921f40458b10997e7e527">05822</a> <a class="code" href="group__usb__lpm.html#gabf62f681f8c921f40458b10997e7e527">USBLPMIntEnable</a>(uint32_t ui32Base, uint32_t ui32Ints)
<a name="l05823"></a>05823 {
<a name="l05824"></a>05824     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05825"></a>05825 
<a name="l05826"></a>05826     <span class="comment">//</span>
<a name="l05827"></a>05827     <span class="comment">// Enable the requested interrupts.</span>
<a name="l05828"></a>05828     <span class="comment">//</span>
<a name="l05829"></a>05829     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a9e93500adfcbeb3b9c510050bd8fecec">USB_O_LPMIM</a>) |= ui32Ints;
<a name="l05830"></a>05830 }
<a name="l05831"></a>05831 
<a name="l05832"></a>05832 <span class="comment">//*****************************************************************************</span>
<a name="l05833"></a>05833 <span class="comment">//</span>
<a name="l05891"></a>05891 <span class="comment"></span><span class="comment">//</span>
<a name="l05892"></a>05892 <span class="comment">//*****************************************************************************</span>
<a name="l05893"></a>05893 <span class="keywordtype">void</span>
<a name="l05894"></a><a class="code" href="group__usb__lpm.html#gaff597fd519bd421030a7bdcf401a335b">05894</a> <a class="code" href="group__usb__lpm.html#gaff597fd519bd421030a7bdcf401a335b">USBLPMIntDisable</a>(uint32_t ui32Base, uint32_t ui32Ints)
<a name="l05895"></a>05895 {
<a name="l05896"></a>05896     <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Base == <a class="code" href="hw__memmap_8h.html#aa47acf4992407a85e79d911ca1055d17">USB0_BASE</a>);
<a name="l05897"></a>05897 
<a name="l05898"></a>05898     <span class="comment">//</span>
<a name="l05899"></a>05899     <span class="comment">// Disable the requested interrupts.</span>
<a name="l05900"></a>05900     <span class="comment">//</span>
<a name="l05901"></a>05901     <a class="code" href="hw__types_8h.html#a084083ee12e5262f8e54bb56c15ac8c7">HWREGB</a>(ui32Base + <a class="code" href="hw__usb_8h.html#a9e93500adfcbeb3b9c510050bd8fecec">USB_O_LPMIM</a>) &amp;= ~ui32Ints;
<a name="l05902"></a>05902 }
<a name="l05903"></a>05903 
<a name="l05904"></a>05904 <span class="comment">//*****************************************************************************</span>
<a name="l05905"></a>05905 <span class="comment">//</span>
<a name="l05906"></a>05906 <span class="comment">// Close the Doxygen group.</span>
<a name="l05908"></a>05908 <span class="comment"></span><span class="comment">//</span>
<a name="l05909"></a>05909 <span class="comment">//*****************************************************************************</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="usb_8c.html">usb.c</a>      </li>

    <li class="footer">Generated on Tue Jan 27 2015 21:33:56 for My Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
