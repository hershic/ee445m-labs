#!/usr/bin/octave

filter_ideal = filter_gen(128,200,15000);
signal_ideal = signal_gen([300], 512, 15000);

subplot(2,1,1);
hold on;
plot(conv(filter_ideal, signal_ideal));
title "ideal filtered data";
hold off;

filter_scaled = int32((filter_ideal) * 4096);
adc = [377, 355, 359, 383, 435, 507, 603, 715, 848, 993, 1157, 1329, 1509, 1699, 1889, 2077, 2267, 2448, 2624, 2785, 2934, 3069, 3180, 3275, 3344, 3390, 3411, 3407, 3377, 3322, 3239, 3139, 3015, 2873, 2718, 2548, 2371, 2188, 2000, 1813, 1624, 1443, 1267, 1103, 946, 806, 685, 575, 489, 423, 378, 357, 359, 385, 436, 507, 603, 717, 848, 995, 1159, 1335, 1514, 1701, 1893, 2083, 2272, 2451, 2625, 2788, 2937, 3067, 3184, 3277, 3344, 3392, 3412, 3407, 3377, 3319, 3239, 3139, 3012, 2871, 2717, 2546, 2368, 2185, 1996, 1809, 1621, 1442, 1264, 1097, 942, 803, 677, 575, 488, 423, 377, 359, 359, 385, 435, 509, 601, 719, 851, 1001, 1161, 1333, 1517, 1704, 1891, 2085, 2275, 2455, 2629, 2791, 2939, 3071, 3184, 3277, 3347, 3393, 3413, 3407, 3376, 3319, 3237, 3135, 3011, 2869, 2713, 2542, 2366, 2182, 1995, 1803, 1619, 1439, 1261, 1097, 943, 801, 679, 572, 487, 421, 379, 359, 360, 387, 435, 509, 603, 721, 853, 1003, 1168, 1339, 1520, 1707, 1897, 2089, 2274, 2457, 2631, 2795, 2941, 3075, 3186, 3279, 3347, 3393, 3413, 3408, 3376, 3319, 3237, 3131, 3008, 2866, 2710, 2540, 2365, 2179, 1991, 1801, 1616, 1431, 1259, 1093, 939, 801, 679, 571, 487, 420, 377, 355, 360, 387, 437, 511, 608, 721, 857, 1003, 1168, 1344, 1523, 1711, 1901, 2091, 2279, 2460, 2633, 2796, 2943, 3077, 3189, 3280, 3348, 3394, 3412, 3405, 3374, 3318, 3235, 3132, 3007, 2864, 2705, 2537, 2361, 2175, 1987, 1799, 1611, 1429, 1255, 1089, 935, 797, 675, 569, 483, 417, 377, 357, 359, 387, 439, 513, 610, 727, 859, 1005, 1169, 1341, 1525, 1713, 1904, 2093, 2282, 2462, 2637, 2799, 2946, 3079, 3190, 3283, 3349, 3394, 3411, 3407, 3373, 3315, 3234, 3131, 3003, 2861, 2704, 2536, 2355, 2171, 1985, 1797, 1611, 1429, 1251, 1087, 935, 795, 670, 567, 483, 421, 376, 355, 359, 389, 440, 513, 612, 725, 859, 1011, 1173, 1345, 1527, 1715, 1907, 2097, 2287, 2466, 2639, 2800, 2947, 3079, 3191, 3281, 3351, 3393, 3414, 3405, 3371, 3314, 3232, 3127, 3001, 2858, 2703, 2533, 2355, 2169, 1983, 1791, 1608, 1427, 1251, 1085, 931, 793, 672, 567, 481, 417, 376, 359, 359, 389, 439, 517, 611, 727, 861, 1013, 1175, 1351, 1531, 1719, 1909, 2099, 2289, 2469, 2643, 2805, 2951, 3080, 3193, 3283, 3350, 3394, 3412, 3405, 3371, 3313, 3231, 3125, 2999, 2855, 2699, 2529, 2353, 2165, 1979, 1791, 1605, 1423, 1249, 1083, 929, 791, 672, 565, 482, 417, 375, 355, 361, 391, 441, 515, 613, 731, 865, 1015, 1179, 1351, 1535, 1723, 1913, 2103, 2291, 2471, 2645, 2807, 2953, 3083, 3195, 3285, 3351, 3394, 3413, 3403, 3371, 3312, 3229, 3123, 2998, 2855, 2698, 2527, 2349, 2163, 1975, 1787, 1601, 1419, 1247, 1079, 928, 789, 667, 565, 480, 416, 375, 355, 363, 391, 443, 519, 615, 733, 867, 1017, 1183, 1355, 1537, 1725, 1915, 2105, 2293, 2475, 2647, 2807, 2955, 3085, 3198, 3286, 3353, 3395, 3413, 3404, 3371, 3310, 3228, 3121, 2995, 2851, 2693, 2523, 2345, 2161, 1971, 1783, 1598, 1415, 1241, 1077, 927, 787, 665, 563, 477, 416, 375, 355, 361, 391, 443, 519, 617, 733, 869, 1019, 1184, 1355];
adc_scaled = adc-2048;

subplot(2,1,2);
hold on;
plot(conv(filter_scaled, adc_scaled)/4096);
title "scaled filtered data";
hold off;
