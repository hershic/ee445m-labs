<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>EE445M RTOS: Spi_flash_api</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EE445M RTOS
   </div>
   <div id="projectbrief">Taken at the University of Texas Spring 2015</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__spi__flash__api.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Spi_flash_api</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The state structure used when performing non-blocking SPI flash operations.  <a href="structt_s_p_i_flash_state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gacf9ec38b37caa1223e957bba6058f626"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gacf9ec38b37caa1223e957bba6058f626">CMD_WRSR</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="separator:gacf9ec38b37caa1223e957bba6058f626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2543fca56aeb170a41cc9f4d9b24c4cf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:ga2543fca56aeb170a41cc9f4d9b24c4cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c953a6c538020e644127ee080608021"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga9c953a6c538020e644127ee080608021">CMD_READ</a>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:ga9c953a6c538020e644127ee080608021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa98eb90657f02a0b7a4634174081799e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaa98eb90657f02a0b7a4634174081799e">CMD_WRDI</a>&#160;&#160;&#160;0x04</td></tr>
<tr class="separator:gaa98eb90657f02a0b7a4634174081799e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf36d3b85d64c03760c6b76e916b443c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaf36d3b85d64c03760c6b76e916b443c1">CMD_RDSR</a>&#160;&#160;&#160;0x05</td></tr>
<tr class="separator:gaf36d3b85d64c03760c6b76e916b443c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga233ab2b77759d1d35814743f08c96347"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga233ab2b77759d1d35814743f08c96347">CMD_WREN</a>&#160;&#160;&#160;0x06</td></tr>
<tr class="separator:ga233ab2b77759d1d35814743f08c96347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95f7567ee4d9880eb6bcdacc88e0bdf9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga95f7567ee4d9880eb6bcdacc88e0bdf9">CMD_FREAD</a>&#160;&#160;&#160;0x0b</td></tr>
<tr class="separator:ga95f7567ee4d9880eb6bcdacc88e0bdf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab108a0bca1eff44cfc82862a6931b04f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gab108a0bca1eff44cfc82862a6931b04f">CMD_SE</a>&#160;&#160;&#160;0x20</td></tr>
<tr class="separator:gab108a0bca1eff44cfc82862a6931b04f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7464fa85e0f285f4f293e4a5109b88a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gac7464fa85e0f285f4f293e4a5109b88a">CMD_DREAD</a>&#160;&#160;&#160;0x3b</td></tr>
<tr class="separator:gac7464fa85e0f285f4f293e4a5109b88a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c5cce6b9a2f31616e9421737feb2f51"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga4c5cce6b9a2f31616e9421737feb2f51">CMD_BE32</a>&#160;&#160;&#160;0x52</td></tr>
<tr class="separator:ga4c5cce6b9a2f31616e9421737feb2f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaccf40d95b8aa697f4023b4ff334b61fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaccf40d95b8aa697f4023b4ff334b61fa">CMD_QREAD</a>&#160;&#160;&#160;0x6b</td></tr>
<tr class="separator:gaccf40d95b8aa697f4023b4ff334b61fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7dcce537746ff1c0c717f6ac1f4af57b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga7dcce537746ff1c0c717f6ac1f4af57b">CMD_RDID</a>&#160;&#160;&#160;0x9f</td></tr>
<tr class="separator:ga7dcce537746ff1c0c717f6ac1f4af57b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90f680398020583fafb3d1a9c03a2aeb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga90f680398020583fafb3d1a9c03a2aeb">CMD_CE</a>&#160;&#160;&#160;0xc7</td></tr>
<tr class="separator:ga90f680398020583fafb3d1a9c03a2aeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e6d2d790472ab4751450307d668fc6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga2e6d2d790472ab4751450307d668fc6a">CMD_BE64</a>&#160;&#160;&#160;0xd8</td></tr>
<tr class="separator:ga2e6d2d790472ab4751450307d668fc6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafff27c7165f059a969fe60fee51f683"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaafff27c7165f059a969fe60fee51f683">STATE_IDLE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:gaafff27c7165f059a969fe60fee51f683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88c4e00f812e9b6becece01b8f60d678"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga88c4e00f812e9b6becece01b8f60d678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga24066dd67ecabc27f87c908010002988"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga24066dd67ecabc27f87c908010002988">STATE_ADDR1</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga24066dd67ecabc27f87c908010002988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga37df3bc5709b8a9c3658aa65175e04d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga37df3bc5709b8a9c3658aa65175e04d8">STATE_ADDR2</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ga37df3bc5709b8a9c3658aa65175e04d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b7208a6ce8258ad8bf6160d2ea35b2f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga3b7208a6ce8258ad8bf6160d2ea35b2f">STATE_ADDR3</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ga3b7208a6ce8258ad8bf6160d2ea35b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2044cfac78a38212abe959061b73b93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaa2044cfac78a38212abe959061b73b93">STATE_READ_DUMMY</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:gaa2044cfac78a38212abe959061b73b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a38e584b3df3a826f3e3604b59f1341"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga8a38e584b3df3a826f3e3604b59f1341">STATE_READ_DATA_SETUP</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:ga8a38e584b3df3a826f3e3604b59f1341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad5e20feb263b09e1be1f48394fdb50a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaad5e20feb263b09e1be1f48394fdb50a">STATE_READ_DATA</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:gaad5e20feb263b09e1be1f48394fdb50a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga91b29ddde291ec8eb0a75b7d1aa119f9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga91b29ddde291ec8eb0a75b7d1aa119f9">STATE_READ_DATA_DMA</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:ga91b29ddde291ec8eb0a75b7d1aa119f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0a0a8dfd33eacde71dfa36beccd55673"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga0a0a8dfd33eacde71dfa36beccd55673">STATE_READ_DATA_END</a>&#160;&#160;&#160;9</td></tr>
<tr class="separator:ga0a0a8dfd33eacde71dfa36beccd55673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75f5fdfe876583fac9954464e1bdacae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga75f5fdfe876583fac9954464e1bdacae">STATE_WRITE_DATA_SETUP</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ga75f5fdfe876583fac9954464e1bdacae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76d26adac52cf8bd900415b001591008"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga76d26adac52cf8bd900415b001591008">STATE_WRITE_DATA</a>&#160;&#160;&#160;11</td></tr>
<tr class="separator:ga76d26adac52cf8bd900415b001591008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a54f197080ab88952cb98579bf86d9e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga2a54f197080ab88952cb98579bf86d9e">STATE_WRITE_DATA_DMA</a>&#160;&#160;&#160;12</td></tr>
<tr class="separator:ga2a54f197080ab88952cb98579bf86d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b1d1c61ab08460db62fe8441f7882ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga6b1d1c61ab08460db62fe8441f7882ee">STATE_WRITE_DATA_END</a>&#160;&#160;&#160;13</td></tr>
<tr class="separator:ga6b1d1c61ab08460db62fe8441f7882ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0d56c3c7817caa138af5f48be143f0f5"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler</a> (<a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *pState)</td></tr>
<tr class="separator:ga0d56c3c7817caa138af5f48be143f0f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39a63f47dbd0d32d90990b2010684c13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga39a63f47dbd0d32d90990b2010684c13">SPIFlashInit</a> (uint32_t ui32Base, uint32_t ui32Clock, uint32_t ui32BitRate)</td></tr>
<tr class="separator:ga39a63f47dbd0d32d90990b2010684c13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga901b800fe1f8a373dcc1e269f4f40e04"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga901b800fe1f8a373dcc1e269f4f40e04">SPIFlashWriteStatus</a> (uint32_t ui32Base, uint8_t ui8Status)</td></tr>
<tr class="separator:ga901b800fe1f8a373dcc1e269f4f40e04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1bd70e866ded923d10aee1a43bc2b349"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga1bd70e866ded923d10aee1a43bc2b349">SPIFlashPageProgram</a> (uint32_t ui32Base, uint32_t ui32Addr, const uint8_t *pui8Data, uint32_t ui32Count)</td></tr>
<tr class="separator:ga1bd70e866ded923d10aee1a43bc2b349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab47e95a2c22ec3d0eafe80e8fad1e84f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gab47e95a2c22ec3d0eafe80e8fad1e84f">SPIFlashPageProgramNonBlocking</a> (<a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *pState, uint32_t ui32Base, uint32_t ui32Addr, const uint8_t *pui8Data, uint32_t ui32Count, bool bUseDMA, uint32_t ui32TxChannel)</td></tr>
<tr class="separator:gab47e95a2c22ec3d0eafe80e8fad1e84f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3dbb731a043f828f04867ff9146b07a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gad3dbb731a043f828f04867ff9146b07a">SPIFlashRead</a> (uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count)</td></tr>
<tr class="separator:gad3dbb731a043f828f04867ff9146b07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8c7a404794d8d63406154471c73540f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaf8c7a404794d8d63406154471c73540f">SPIFlashReadNonBlocking</a> (<a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *pState, uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count, bool bUseDMA, uint32_t ui32TxChannel, uint32_t ui32RxChannel)</td></tr>
<tr class="separator:gaf8c7a404794d8d63406154471c73540f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86346f2b25c46fb16acdb7a0315f68c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga86346f2b25c46fb16acdb7a0315f68c9">SPIFlashWriteDisable</a> (uint32_t ui32Base)</td></tr>
<tr class="separator:ga86346f2b25c46fb16acdb7a0315f68c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb1bf43047839456adfc4c6e484585a6"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gabb1bf43047839456adfc4c6e484585a6">SPIFlashReadStatus</a> (uint32_t ui32Base)</td></tr>
<tr class="separator:gabb1bf43047839456adfc4c6e484585a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd97a4e0bcaa224283744a64c10a701c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gadd97a4e0bcaa224283744a64c10a701c">SPIFlashWriteEnable</a> (uint32_t ui32Base)</td></tr>
<tr class="separator:gadd97a4e0bcaa224283744a64c10a701c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga550aa252bfb93bfe45061f4aa73683b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga550aa252bfb93bfe45061f4aa73683b9">SPIFlashFastRead</a> (uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count)</td></tr>
<tr class="separator:ga550aa252bfb93bfe45061f4aa73683b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf27b3eebe2782b3986e0a4603ce9c5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaaf27b3eebe2782b3986e0a4603ce9c5b">SPIFlashFastReadNonBlocking</a> (<a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *pState, uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count, bool bUseDMA, uint32_t ui32TxChannel, uint32_t ui32RxChannel)</td></tr>
<tr class="separator:gaaf27b3eebe2782b3986e0a4603ce9c5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga058368211f1723e85295eb32b637360e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga058368211f1723e85295eb32b637360e">SPIFlashSectorErase</a> (uint32_t ui32Base, uint32_t ui32Addr)</td></tr>
<tr class="separator:ga058368211f1723e85295eb32b637360e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d1b036b4baa2af303faaffb33bd2657"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga5d1b036b4baa2af303faaffb33bd2657">SPIFlashDualRead</a> (uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count)</td></tr>
<tr class="separator:ga5d1b036b4baa2af303faaffb33bd2657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d18eb28e1f73b8dc45b564dbb422a67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga3d18eb28e1f73b8dc45b564dbb422a67">SPIFlashDualReadNonBlocking</a> (<a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *pState, uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count, bool bUseDMA, uint32_t ui32TxChannel, uint32_t ui32RxChannel)</td></tr>
<tr class="separator:ga3d18eb28e1f73b8dc45b564dbb422a67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa67db81dbf7cbe97458c24dd3945bfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gafa67db81dbf7cbe97458c24dd3945bfb">SPIFlashBlockErase32</a> (uint32_t ui32Base, uint32_t ui32Addr)</td></tr>
<tr class="separator:gafa67db81dbf7cbe97458c24dd3945bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae88d59957feec85adc1801777157b578"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gae88d59957feec85adc1801777157b578">SPIFlashQuadRead</a> (uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count)</td></tr>
<tr class="separator:gae88d59957feec85adc1801777157b578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4ef70354c42d9ed4a78583e46c16ccd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gaa4ef70354c42d9ed4a78583e46c16ccd">SPIFlashQuadReadNonBlocking</a> (<a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *pState, uint32_t ui32Base, uint32_t ui32Addr, uint8_t *pui8Data, uint32_t ui32Count, bool bUseDMA, uint32_t ui32TxChannel, uint32_t ui32RxChannel)</td></tr>
<tr class="separator:gaa4ef70354c42d9ed4a78583e46c16ccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d594d8bdd9e5f553ed8f626a118ed7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#ga8d594d8bdd9e5f553ed8f626a118ed7c">SPIFlashReadID</a> (uint32_t ui32Base, uint8_t *pui8ManufacturerID, uint16_t *pui16DeviceID)</td></tr>
<tr class="separator:ga8d594d8bdd9e5f553ed8f626a118ed7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9d54a0cd51fcd2f310ef08bff6c8541"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gac9d54a0cd51fcd2f310ef08bff6c8541">SPIFlashChipErase</a> (uint32_t ui32Base)</td></tr>
<tr class="separator:gac9d54a0cd51fcd2f310ef08bff6c8541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5901f8570e88ba3b56d7b9748180dbd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__flash__api.html#gad5901f8570e88ba3b56d7b9748180dbd">SPIFlashBlockErase64</a> (uint32_t ui32Base, uint32_t ui32Addr)</td></tr>
<tr class="separator:gad5901f8570e88ba3b56d7b9748180dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga4c5cce6b9a2f31616e9421737feb2f51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_BE32&#160;&#160;&#160;0x52</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00060">60</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l02120">SPIFlashBlockErase32()</a>.</p>

</div>
</div>
<a class="anchor" id="ga2e6d2d790472ab4751450307d668fc6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_BE64&#160;&#160;&#160;0xd8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00064">64</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l02458">SPIFlashBlockErase64()</a>.</p>

</div>
</div>
<a class="anchor" id="ga90f680398020583fafb3d1a9c03a2aeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_CE&#160;&#160;&#160;0xc7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00063">63</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l02427">SPIFlashChipErase()</a>.</p>

</div>
</div>
<a class="anchor" id="gac7464fa85e0f285f4f293e4a5109b88a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_DREAD&#160;&#160;&#160;0x3b</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00059">59</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l01921">SPIFlashDualRead()</a>, <a class="el" href="spi__flash_8c_source.html#l02065">SPIFlashDualReadNonBlocking()</a>, and <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga95f7567ee4d9880eb6bcdacc88e0bdf9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_FREAD&#160;&#160;&#160;0x0b</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00057">57</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l01681">SPIFlashFastRead()</a>, and <a class="el" href="spi__flash_8c_source.html#l01827">SPIFlashFastReadNonBlocking()</a>.</p>

</div>
</div>
<a class="anchor" id="ga2543fca56aeb170a41cc9f4d9b24c4cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_PP&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00052">52</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>, <a class="el" href="spi__flash_8c_source.html#l01248">SPIFlashPageProgram()</a>, and <a class="el" href="spi__flash_8c_source.html#l01327">SPIFlashPageProgramNonBlocking()</a>.</p>

</div>
</div>
<a class="anchor" id="gaccf40d95b8aa697f4023b4ff334b61fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_QREAD&#160;&#160;&#160;0x6b</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00061">61</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>, <a class="el" href="spi__flash_8c_source.html#l02159">SPIFlashQuadRead()</a>, and <a class="el" href="spi__flash_8c_source.html#l02303">SPIFlashQuadReadNonBlocking()</a>.</p>

</div>
</div>
<a class="anchor" id="ga7dcce537746ff1c0c717f6ac1f4af57b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_RDID&#160;&#160;&#160;0x9f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00062">62</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l02362">SPIFlashReadID()</a>.</p>

</div>
</div>
<a class="anchor" id="gaf36d3b85d64c03760c6b76e916b443c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_RDSR&#160;&#160;&#160;0x05</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00055">55</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l01587">SPIFlashReadStatus()</a>.</p>

</div>
</div>
<a class="anchor" id="ga9c953a6c538020e644127ee080608021"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_READ&#160;&#160;&#160;0x03</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00053">53</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>, <a class="el" href="spi__flash_8c_source.html#l01372">SPIFlashRead()</a>, and <a class="el" href="spi__flash_8c_source.html#l01510">SPIFlashReadNonBlocking()</a>.</p>

</div>
</div>
<a class="anchor" id="gab108a0bca1eff44cfc82862a6931b04f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_SE&#160;&#160;&#160;0x20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00058">58</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l01882">SPIFlashSectorErase()</a>.</p>

</div>
</div>
<a class="anchor" id="gaa98eb90657f02a0b7a4634174081799e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_WRDI&#160;&#160;&#160;0x04</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00054">54</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l01560">SPIFlashWriteDisable()</a>.</p>

</div>
</div>
<a class="anchor" id="ga233ab2b77759d1d35814743f08c96347"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_WREN&#160;&#160;&#160;0x06</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00056">56</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l01647">SPIFlashWriteEnable()</a>.</p>

</div>
</div>
<a class="anchor" id="gacf9ec38b37caa1223e957bba6058f626"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_WRSR&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00051">51</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l01212">SPIFlashWriteStatus()</a>.</p>

</div>
</div>
<a class="anchor" id="ga24066dd67ecabc27f87c908010002988"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_ADDR1&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00073">73</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga37df3bc5709b8a9c3658aa65175e04d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_ADDR2&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00074">74</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga3b7208a6ce8258ad8bf6160d2ea35b2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_ADDR3&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00075">75</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga88c4e00f812e9b6becece01b8f60d678"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_CMD&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00072">72</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l02065">SPIFlashDualReadNonBlocking()</a>, <a class="el" href="spi__flash_8c_source.html#l01827">SPIFlashFastReadNonBlocking()</a>, <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>, <a class="el" href="spi__flash_8c_source.html#l01327">SPIFlashPageProgramNonBlocking()</a>, <a class="el" href="spi__flash_8c_source.html#l02303">SPIFlashQuadReadNonBlocking()</a>, and <a class="el" href="spi__flash_8c_source.html#l01510">SPIFlashReadNonBlocking()</a>.</p>

</div>
</div>
<a class="anchor" id="gaafff27c7165f059a969fe60fee51f683"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_IDLE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00071">71</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="gaad5e20feb263b09e1be1f48394fdb50a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_READ_DATA&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00078">78</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga91b29ddde291ec8eb0a75b7d1aa119f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_READ_DATA_DMA&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00079">79</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga0a0a8dfd33eacde71dfa36beccd55673"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_READ_DATA_END&#160;&#160;&#160;9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00080">80</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga8a38e584b3df3a826f3e3604b59f1341"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_READ_DATA_SETUP&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00077">77</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="gaa2044cfac78a38212abe959061b73b93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_READ_DUMMY&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00076">76</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga76d26adac52cf8bd900415b001591008"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_WRITE_DATA&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00082">82</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga2a54f197080ab88952cb98579bf86d9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_WRITE_DATA_DMA&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00083">83</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga6b1d1c61ab08460db62fe8441f7882ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_WRITE_DATA_END&#160;&#160;&#160;13</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00084">84</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<a class="anchor" id="ga75f5fdfe876583fac9954464e1bdacae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_WRITE_DATA_SETUP&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00081">81</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>Referenced by <a class="el" href="spi__flash_8c_source.html#l00103">SPIFlashIntHandler()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gafa67db81dbf7cbe97458c24dd3945bfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashBlockErase32 </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Erases a 32 KB block of the SPI flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to erase.</td></tr>
  </table>
  </dd>
</dl>
<p>This function erases a 32 KB block of the SPI flash. Each 32 KB block has a 32 KB alignment; the SPI flash will ignore the lower 15 bits of the address provided. The 32 KB block erase command is issued by this function; <a class="el" href="group__spi__flash__api.html#gabb1bf43047839456adfc4c6e484585a6">SPIFlashReadStatus()</a> must be used to query the SPI flash to determine when the 32 KB block erase operation has completed. This uses the 0x52 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l02120">2120</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00060">CMD_BE32</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;{</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="comment">// Send the 32 KB block erase command command.</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga4c5cce6b9a2f31616e9421737feb2f51">CMD_BE32</a>);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="comment">// Send the address of the 32 KB block to be erased, marking the last byte</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="comment">// of the address as the end of the frame.</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga4c5cce6b9a2f31616e9421737feb2f51"><div class="ttname"><a href="group__spi__flash__api.html#ga4c5cce6b9a2f31616e9421737feb2f51">CMD_BE32</a></div><div class="ttdeci">#define CMD_BE32</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00060">spi_flash.c:60</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad5901f8570e88ba3b56d7b9748180dbd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashBlockErase64 </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Erases a 64 KB block of the SPI flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to erase.</td></tr>
  </table>
  </dd>
</dl>
<p>This function erases a 64 KB block of the SPI flash. Each 64 KB block has a 64 KB alignment; the SPI flash will ignore the lower 16 bits of the address provided. The 64 KB block erase command is issued by this function; <a class="el" href="group__spi__flash__api.html#gabb1bf43047839456adfc4c6e484585a6">SPIFlashReadStatus()</a> must be used to query the SPI flash to determine when the 64 KB block erase operation has completed. This uses the 0xd8 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l02458">2458</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00064">CMD_BE64</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;{</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="comment">// Send the 64 KB block erase command command.</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga2e6d2d790472ab4751450307d668fc6a">CMD_BE64</a>);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="comment">// Send the address of the 64 KB block to be erased, marking the last byte</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    <span class="comment">// of the address as the end of the frame.</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga2e6d2d790472ab4751450307d668fc6a"><div class="ttname"><a href="group__spi__flash__api.html#ga2e6d2d790472ab4751450307d668fc6a">CMD_BE64</a></div><div class="ttdeci">#define CMD_BE64</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00064">spi_flash.c:64</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac9d54a0cd51fcd2f310ef08bff6c8541"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashChipErase </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Erases the entire SPI flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address.</td></tr>
  </table>
  </dd>
</dl>
<p>This command erase the entire SPI flash. The chip erase command is issued by this function; <a class="el" href="group__spi__flash__api.html#gabb1bf43047839456adfc4c6e484585a6">SPIFlashReadStatus()</a> must be used to query the SPI flash to determine when the chip erase operation has completed. This uses the 0xc7 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l02427">2427</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00063">CMD_CE</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;{</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="comment">// Send the chip erase command, marking this byte as the end of the frame.</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga90f680398020583fafb3d1a9c03a2aeb">CMD_CE</a>);</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga90f680398020583fafb3d1a9c03a2aeb"><div class="ttname"><a href="group__spi__flash__api.html#ga90f680398020583fafb3d1a9c03a2aeb">CMD_CE</a></div><div class="ttdeci">#define CMD_CE</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00063">spi_flash.c:63</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5d1b036b4baa2af303faaffb33bd2657"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashDualRead </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash using Bi-SPI.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash with Bi-SPI, using PIO mode. This function will not return until the read has completed. This uses the 0x3b SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01921">1921</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00059">CMD_DREAD</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04328">MAP_SSIDataGet</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, <a class="el" href="ssi_8h_source.html#l00109">SSI_ADV_MODE_BI_READ</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;{</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    {</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    }</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="comment">// Send the dual read command.</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#gac7464fa85e0f285f4f293e4a5109b88a">CMD_DREAD</a>);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="comment">// Send the address of the first byte to read.</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="comment">// Send a dummy byte.</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">// Set the SSI module into Bi-SPI read mode.  In this mode, dummy writes</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">// are required in order to make the transfer occur; the SSI module will</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">// ignore the data (the SPI flash will never see the dummy data since</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">// Bi-SPI read mode is a uni-directional input mode).</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#a0d3b574fbf3d0b60970d6f3357ac13bd">SSI_ADV_MODE_BI_READ</a>);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">// See if there is a single byte to be read.</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span>(ui32Count == 1)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="comment">// Perform a single dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="comment">// Perform a dummy write to prime the loop.</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="comment">// Loop while there is more than one byte left to be read.</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="keywordflow">while</span>(--ui32Count != 1)</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            <span class="comment">// Perform a dummy write to keep the transmit FIFO from going</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <span class="comment">// empty.</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="comment">// Read the next data byte from the receive FIFO and place it into</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <span class="comment">// the data buffer.</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="comment">// Perform the final dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="comment">// Read the next data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="comment">// Read the final data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;}</div>
<div class="ttc" id="group__spi__flash__api_html_gac7464fa85e0f285f4f293e4a5109b88a"><div class="ttname"><a href="group__spi__flash__api.html#gac7464fa85e0f285f4f293e4a5109b88a">CMD_DREAD</a></div><div class="ttdeci">#define CMD_DREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00059">spi_flash.c:59</a></div></div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8f9f9fa6cc04e29027eaa0531d308ff1"><div class="ttname"><a href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a></div><div class="ttdeci">#define MAP_SSIDataGet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04328">rom_map.h:4328</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="ssi_8h_html_a0d3b574fbf3d0b60970d6f3357ac13bd"><div class="ttname"><a href="ssi_8h.html#a0d3b574fbf3d0b60970d6f3357ac13bd">SSI_ADV_MODE_BI_READ</a></div><div class="ttdeci">#define SSI_ADV_MODE_BI_READ</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00109">ssi.h:109</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3d18eb28e1f73b8dc45b564dbb422a67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashDualReadNonBlocking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bUseDMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32TxChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32RxChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash using Bi-SPI in the background.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pState</td><td>is a pointer to the SPI flash state structure. </td></tr>
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read. </td></tr>
    <tr><td class="paramname">bUseDMA</td><td>is <b>true</b> if uDMA should be used and <b>false</b> otherwise. </td></tr>
    <tr><td class="paramname">ui32TxChannel</td><td>is the uDMA channel to be used for writing to the SSI module. </td></tr>
    <tr><td class="paramname">ui32RxChannel</td><td>is the uDMA channel to be used for reading from the SSI module.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash with Bi-SPI, using either interrupts or uDMA to transfer the data. This function will return immediately and read the data in the background. In order for this to complete successfully, several conditions must be satisfied:</p>
<ul>
<li>Prior to calling this function:<ul>
<li>The SSI module must be enabled in SysCtl.</li>
<li>The SSI pins must be configured for use by the SSI module.</li>
<li>The SSI module interrupt must be enabled in NVIC.</li>
<li>The uDMA module must be enabled in SysCtl and the control table set (if using uDMA).</li>
<li>The uDMA channels must be assigned to the SSI module.</li>
</ul>
</li>
<li>After calling this function:<ul>
<li>The interrupt handler for the SSI module must call <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a>, passing the same pState structure pointer that was supplied to this function.</li>
<li>No other SPI flash operation can be called until this operation has completed.</li>
</ul>
</li>
</ul>
<p>Completion of the read operation is indicated when <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a> returns <b>SPI_FLASH_DONE</b>.</p>
<p>Like SPIFLashDualRead(), this uses the 0x3b SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l02065">2065</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8h_source.html#l00080">tSPIFlashState::bUseDMA</a>, <a class="el" href="spi__flash_8c_source.html#l00059">CMD_DREAD</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="spi__flash_8h_source.html#l00065">tSPIFlashState::pui8Buffer</a>, <a class="el" href="hw__ssi_8h_source.html#l00200">SSI_ICR_DMARXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00199">SSI_ICR_DMATXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00148">SSI_IM_RTIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00147">SSI_IM_RXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00146">SSI_IM_TXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00056">SSI_O_ICR</a>, <a class="el" href="hw__ssi_8h_source.html#l00053">SSI_O_IM</a>, <a class="el" href="spi__flash_8c_source.html#l00072">STATE_CMD</a>, <a class="el" href="spi__flash_8h_source.html#l00050">tSPIFlashState::ui16Cmd</a>, <a class="el" href="spi__flash_8h_source.html#l00055">tSPIFlashState::ui16State</a>, <a class="el" href="spi__flash_8h_source.html#l00060">tSPIFlashState::ui32Addr</a>, <a class="el" href="spi__flash_8h_source.html#l00045">tSPIFlashState::ui32Base</a>, <a class="el" href="spi__flash_8h_source.html#l00070">tSPIFlashState::ui32ReadCount</a>, <a class="el" href="spi__flash_8h_source.html#l00091">tSPIFlashState::ui32RxChannel</a>, <a class="el" href="spi__flash_8h_source.html#l00086">tSPIFlashState::ui32TxChannel</a>, and <a class="el" href="spi__flash_8h_source.html#l00075">tSPIFlashState::ui32WriteCount</a>.</p>
<div class="fragment"><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;{</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    }</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="comment">// Save the parameters of this read operation to the state structure.</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> = ui32Base;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> = <a class="code" href="group__spi__flash__api.html#gac7464fa85e0f285f4f293e4a5109b88a">CMD_DREAD</a>;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a>;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> = ui32Addr;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> = pui8Data;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> = ui32Count;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> = ui32Count;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = bUseDMA;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a> = ui32TxChannel &amp; 0x1f;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a> = ui32RxChannel &amp; 0x1f;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="comment">// Enable the SSI transmit and receive interrupts.  This will start the</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="comment">// transfer.  If uDMA is being used, the uDMA-related interrupts will be</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="comment">// enabled at the appropriate time by the interrupt handler.</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a> | <a class="code" href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a>;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a> | <a class="code" href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a> | <a class="code" href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a>;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;}</div>
<div class="ttc" id="group__spi__flash__api_html_gac7464fa85e0f285f4f293e4a5109b88a"><div class="ttname"><a href="group__spi__flash__api.html#gac7464fa85e0f285f4f293e4a5109b88a">CMD_DREAD</a></div><div class="ttdeci">#define CMD_DREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00059">spi_flash.c:59</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ade82e929a6d52eb542fe1d34ee210764"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">tSPIFlashState::ui32ReadCount</a></div><div class="ttdeci">uint32_t ui32ReadCount</div><div class="ttdoc">The count of bytes left to be read. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00070">spi_flash.h:70</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a3bb98b66624f93e28338d954d3fd9032"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">tSPIFlashState::ui32TxChannel</a></div><div class="ttdeci">uint32_t ui32TxChannel</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00086">spi_flash.h:86</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_aa47658e72d6edfdebf29fd87a368c23e"><div class="ttname"><a href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">tSPIFlashState::ui32RxChannel</a></div><div class="ttdeci">uint32_t ui32RxChannel</div><div class="ttdoc">The uDMA channel to use for receiving when using uDMA for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00091">spi_flash.h:91</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_afa5492f2bf96fc487cb9c6e89ee75dbf"><div class="ttname"><a href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">tSPIFlashState::ui32Base</a></div><div class="ttdeci">uint32_t ui32Base</div><div class="ttdoc">The base address of the SSI module that is being used. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00045">spi_flash.h:45</a></div></div>
<div class="ttc" id="hw__types_8h_html_ac9660181819fceac0b5abcd67d76ca6e"><div class="ttname"><a href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a></div><div class="ttdeci">#define HWREG(x)</div><div class="ttdef"><b>Definition:</b> <a href="hw__types_8h_source.html#l00048">hw_types.h:48</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a0c839fa56316268d9d3c1a6338d5b9a8"><div class="ttname"><a href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a></div><div class="ttdeci">#define SSI_O_IM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00053">hw_ssi.h:53</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a2bc8ac2fab0bc4c2a47f207c976ba875"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">tSPIFlashState::pui8Buffer</a></div><div class="ttdeci">uint8_t * pui8Buffer</div><div class="ttdoc">A pointer to the data buffer that is being read or written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00065">spi_flash.h:65</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aaf63879f2c29b6fd6d9903153dd4271a"><div class="ttname"><a href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a></div><div class="ttdeci">#define SSI_O_ICR</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00056">hw_ssi.h:56</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga88c4e00f812e9b6becece01b8f60d678"><div class="ttname"><a href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a></div><div class="ttdeci">#define STATE_CMD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00072">spi_flash.c:72</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ab33983a1783bc5f7593f60ebf8975645"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">tSPIFlashState::bUseDMA</a></div><div class="ttdeci">bool bUseDMA</div><div class="ttdoc">A flag that is true if uDMA used be used for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00080">spi_flash.h:80</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a31ff9833643e984d1fd9e48d7a851a6b"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">tSPIFlashState::ui32WriteCount</a></div><div class="ttdeci">uint32_t ui32WriteCount</div><div class="ttdoc">The count of bytes left to be written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00075">spi_flash.h:75</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a074f5ab3f6e39f06334bf7ce875c8027"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">tSPIFlashState::ui16Cmd</a></div><div class="ttdeci">uint16_t ui16Cmd</div><div class="ttdoc">The command that is being send to the SPI flash. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00050">spi_flash.h:50</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a991109b454b7f2a294ce9dd2b523f378"><div class="ttname"><a href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a></div><div class="ttdeci">#define SSI_IM_RXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00147">hw_ssi.h:147</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_afd3ac990370ed4a0100b719fc1c7da7f"><div class="ttname"><a href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a></div><div class="ttdeci">#define SSI_IM_RTIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00148">hw_ssi.h:148</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a22cc1ee908ec15a4ae5cec1f77195b53"><div class="ttname"><a href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a></div><div class="ttdeci">#define SSI_IM_TXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00146">hw_ssi.h:146</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a954860482fa17ad95cd0d4cb44fda84b"><div class="ttname"><a href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a></div><div class="ttdeci">#define SSI_ICR_DMARXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00200">hw_ssi.h:200</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a873e573501798cee815d0e810979e579"><div class="ttname"><a href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a></div><div class="ttdeci">#define SSI_ICR_DMATXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00199">hw_ssi.h:199</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a13617645ea59a89666b09faca56d5e83"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">tSPIFlashState::ui16State</a></div><div class="ttdeci">uint16_t ui16State</div><div class="ttdoc">The current state of the SPI flash state machine. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00055">spi_flash.h:55</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a14849eb4c3631e87c93d6bc2ed7c5a9d"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">tSPIFlashState::ui32Addr</a></div><div class="ttdeci">uint32_t ui32Addr</div><div class="ttdoc">The SPI flash address associated with the command. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00060">spi_flash.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga550aa252bfb93bfe45061f4aa73683b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashFastRead </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash using the fast read command.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash with the fast read command, using PIO mode. The fast read command allows the SPI flash to be read at a higher SPI clock rate because of the addition of a dummy cycle during the command setup. This function will not return until the read has completed. This uses the 0x0b SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01681">1681</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00057">CMD_FREAD</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04328">MAP_SSIDataGet</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, <a class="el" href="ssi_8h_source.html#l00107">SSI_ADV_MODE_READ_WRITE</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;{</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="comment">// Send the fast read command.</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga95f7567ee4d9880eb6bcdacc88e0bdf9">CMD_FREAD</a>);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="comment">// Send the address of the first byte to read.</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="comment">// Send a dummy byte.</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="comment">// Set the SSI module into read/write mode.  In this mode, dummy writes are</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">// required in order to make the transfer occur; the SPI flash will ignore</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="comment">// the data.</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a>);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="comment">// See if there is a single byte to be read.</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordflow">if</span>(ui32Count == 1)</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="comment">// Perform a single dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="comment">// Perform a dummy write to prime the loop.</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <span class="comment">// Loop while there is more than one byte left to be read.</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="keywordflow">while</span>(--ui32Count != 1)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            <span class="comment">// Perform a dummy write to keep the transmit FIFO from going</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            <span class="comment">// empty.</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            <span class="comment">// Read the next data byte from the receive FIFO and place it into</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            <span class="comment">// the data buffer.</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <span class="comment">// Perform the final dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        <span class="comment">// Read the next data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    }</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="comment">// Read the final data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8f9f9fa6cc04e29027eaa0531d308ff1"><div class="ttname"><a href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a></div><div class="ttdeci">#define MAP_SSIDataGet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04328">rom_map.h:4328</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga95f7567ee4d9880eb6bcdacc88e0bdf9"><div class="ttname"><a href="group__spi__flash__api.html#ga95f7567ee4d9880eb6bcdacc88e0bdf9">CMD_FREAD</a></div><div class="ttdeci">#define CMD_FREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00057">spi_flash.c:57</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="ssi_8h_html_a3b381e1d2c940e29363b2e12591f9a0b"><div class="ttname"><a href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_READ_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00107">ssi.h:107</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaaf27b3eebe2782b3986e0a4603ce9c5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashFastReadNonBlocking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bUseDMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32TxChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32RxChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash using the fast read command in the background.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pState</td><td>is a pointer to the SPI flash state structure. </td></tr>
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read. </td></tr>
    <tr><td class="paramname">bUseDMA</td><td>is <b>true</b> if uDMA should be used and <b>false</b> otherwise. </td></tr>
    <tr><td class="paramname">ui32TxChannel</td><td>is the uDMA channel to be used for writing to the SSI module. </td></tr>
    <tr><td class="paramname">ui32RxChannel</td><td>is the uDMA channel to be used for reading from the SSI module.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash with the fast read command, using either interrupts or uDMA to transfer the data. The fast read command allows the SPI flash to be read at a higher SPI clock rate because of the addition of a dummy cycle during the command setup. This function will return immediately and read the data in the background. In order for this to complete successfully, several conditions must be satisfied:</p>
<ul>
<li>Prior to calling this function:<ul>
<li>The SSI module must be enabled in SysCtl.</li>
<li>The SSI pins must be configured for use by the SSI module.</li>
<li>The SSI module interrupt must be enabled in NVIC.</li>
<li>The uDMA module must be enabled in SysCtl and the control table set (if using uDMA).</li>
<li>The uDMA channels must be assigned to the SSI module.</li>
</ul>
</li>
<li>After calling this function:<ul>
<li>The interrupt handler for the SSI module must call <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a>, passing the same pState structure pointer that was supplied to this function.</li>
<li>No other SPI flash operation can be called until this operation has completed.</li>
</ul>
</li>
</ul>
<p>Completion of the read operation is indicated when <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a> returns <b>SPI_FLASH_DONE</b>.</p>
<p>Like <a class="el" href="group__spi__flash__api.html#ga550aa252bfb93bfe45061f4aa73683b9">SPIFlashFastRead()</a>, this uses the 0x0b SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01827">1827</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8h_source.html#l00080">tSPIFlashState::bUseDMA</a>, <a class="el" href="spi__flash_8c_source.html#l00057">CMD_FREAD</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="spi__flash_8h_source.html#l00065">tSPIFlashState::pui8Buffer</a>, <a class="el" href="hw__ssi_8h_source.html#l00200">SSI_ICR_DMARXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00199">SSI_ICR_DMATXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00148">SSI_IM_RTIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00147">SSI_IM_RXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00146">SSI_IM_TXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00056">SSI_O_ICR</a>, <a class="el" href="hw__ssi_8h_source.html#l00053">SSI_O_IM</a>, <a class="el" href="spi__flash_8c_source.html#l00072">STATE_CMD</a>, <a class="el" href="spi__flash_8h_source.html#l00050">tSPIFlashState::ui16Cmd</a>, <a class="el" href="spi__flash_8h_source.html#l00055">tSPIFlashState::ui16State</a>, <a class="el" href="spi__flash_8h_source.html#l00060">tSPIFlashState::ui32Addr</a>, <a class="el" href="spi__flash_8h_source.html#l00045">tSPIFlashState::ui32Base</a>, <a class="el" href="spi__flash_8h_source.html#l00070">tSPIFlashState::ui32ReadCount</a>, <a class="el" href="spi__flash_8h_source.html#l00091">tSPIFlashState::ui32RxChannel</a>, <a class="el" href="spi__flash_8h_source.html#l00086">tSPIFlashState::ui32TxChannel</a>, and <a class="el" href="spi__flash_8h_source.html#l00075">tSPIFlashState::ui32WriteCount</a>.</p>
<div class="fragment"><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;{</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="comment">// Save the parameters of this read operation to the state structure.</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> = ui32Base;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> = <a class="code" href="group__spi__flash__api.html#ga95f7567ee4d9880eb6bcdacc88e0bdf9">CMD_FREAD</a>;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a>;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> = ui32Addr;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> = pui8Data;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> = ui32Count;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> = ui32Count;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = bUseDMA;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a> = ui32TxChannel &amp; 0x1f;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a> = ui32RxChannel &amp; 0x1f;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="comment">// Enable the SSI transmit and receive interrupts.  This will start the</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">// transfer.  If uDMA is being used, the uDMA-related interrupts will be</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">// enabled at the appropriate time by the interrupt handler.</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a> | <a class="code" href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a>;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a> | <a class="code" href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a> | <a class="code" href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;}</div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ade82e929a6d52eb542fe1d34ee210764"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">tSPIFlashState::ui32ReadCount</a></div><div class="ttdeci">uint32_t ui32ReadCount</div><div class="ttdoc">The count of bytes left to be read. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00070">spi_flash.h:70</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a3bb98b66624f93e28338d954d3fd9032"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">tSPIFlashState::ui32TxChannel</a></div><div class="ttdeci">uint32_t ui32TxChannel</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00086">spi_flash.h:86</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_aa47658e72d6edfdebf29fd87a368c23e"><div class="ttname"><a href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">tSPIFlashState::ui32RxChannel</a></div><div class="ttdeci">uint32_t ui32RxChannel</div><div class="ttdoc">The uDMA channel to use for receiving when using uDMA for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00091">spi_flash.h:91</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_afa5492f2bf96fc487cb9c6e89ee75dbf"><div class="ttname"><a href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">tSPIFlashState::ui32Base</a></div><div class="ttdeci">uint32_t ui32Base</div><div class="ttdoc">The base address of the SSI module that is being used. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00045">spi_flash.h:45</a></div></div>
<div class="ttc" id="hw__types_8h_html_ac9660181819fceac0b5abcd67d76ca6e"><div class="ttname"><a href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a></div><div class="ttdeci">#define HWREG(x)</div><div class="ttdef"><b>Definition:</b> <a href="hw__types_8h_source.html#l00048">hw_types.h:48</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a0c839fa56316268d9d3c1a6338d5b9a8"><div class="ttname"><a href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a></div><div class="ttdeci">#define SSI_O_IM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00053">hw_ssi.h:53</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a2bc8ac2fab0bc4c2a47f207c976ba875"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">tSPIFlashState::pui8Buffer</a></div><div class="ttdeci">uint8_t * pui8Buffer</div><div class="ttdoc">A pointer to the data buffer that is being read or written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00065">spi_flash.h:65</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aaf63879f2c29b6fd6d9903153dd4271a"><div class="ttname"><a href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a></div><div class="ttdeci">#define SSI_O_ICR</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00056">hw_ssi.h:56</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga88c4e00f812e9b6becece01b8f60d678"><div class="ttname"><a href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a></div><div class="ttdeci">#define STATE_CMD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00072">spi_flash.c:72</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ab33983a1783bc5f7593f60ebf8975645"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">tSPIFlashState::bUseDMA</a></div><div class="ttdeci">bool bUseDMA</div><div class="ttdoc">A flag that is true if uDMA used be used for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00080">spi_flash.h:80</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a31ff9833643e984d1fd9e48d7a851a6b"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">tSPIFlashState::ui32WriteCount</a></div><div class="ttdeci">uint32_t ui32WriteCount</div><div class="ttdoc">The count of bytes left to be written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00075">spi_flash.h:75</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a074f5ab3f6e39f06334bf7ce875c8027"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">tSPIFlashState::ui16Cmd</a></div><div class="ttdeci">uint16_t ui16Cmd</div><div class="ttdoc">The command that is being send to the SPI flash. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00050">spi_flash.h:50</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a991109b454b7f2a294ce9dd2b523f378"><div class="ttname"><a href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a></div><div class="ttdeci">#define SSI_IM_RXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00147">hw_ssi.h:147</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_afd3ac990370ed4a0100b719fc1c7da7f"><div class="ttname"><a href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a></div><div class="ttdeci">#define SSI_IM_RTIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00148">hw_ssi.h:148</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a22cc1ee908ec15a4ae5cec1f77195b53"><div class="ttname"><a href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a></div><div class="ttdeci">#define SSI_IM_TXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00146">hw_ssi.h:146</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a954860482fa17ad95cd0d4cb44fda84b"><div class="ttname"><a href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a></div><div class="ttdeci">#define SSI_ICR_DMARXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00200">hw_ssi.h:200</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga95f7567ee4d9880eb6bcdacc88e0bdf9"><div class="ttname"><a href="group__spi__flash__api.html#ga95f7567ee4d9880eb6bcdacc88e0bdf9">CMD_FREAD</a></div><div class="ttdeci">#define CMD_FREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00057">spi_flash.c:57</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a873e573501798cee815d0e810979e579"><div class="ttname"><a href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a></div><div class="ttdeci">#define SSI_ICR_DMATXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00199">hw_ssi.h:199</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a13617645ea59a89666b09faca56d5e83"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">tSPIFlashState::ui16State</a></div><div class="ttdeci">uint16_t ui16State</div><div class="ttdoc">The current state of the SPI flash state machine. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00055">spi_flash.h:55</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a14849eb4c3631e87c93d6bc2ed7c5a9d"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">tSPIFlashState::ui32Addr</a></div><div class="ttdeci">uint32_t ui32Addr</div><div class="ttdoc">The SPI flash address associated with the command. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00060">spi_flash.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga39a63f47dbd0d32d90990b2010684c13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashInit </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Clock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32BitRate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the SPI flash driver.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Clock</td><td>is the rate of the clock supplied to the SSI module. </td></tr>
    <tr><td class="paramname">ui32BitRate</td><td>is the SPI clock rate.</td></tr>
  </table>
  </dd>
</dl>
<p>This function configures the SSI module for use by the SPI flash driver. The SSI module will be placed into the correct mode of operation to allow communication with the SPI flash. This function must be called prior to calling the remaining SPI flash driver APIs. It can be called at a later point to reconfigure the SSI module, such as to increase the SPI clock rate once it has been determined that it is safe to use a higher speed clock.</p>
<p>It is the responsibility of the caller to enable the SSI module and configure the pins that it will utilize.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01174">1174</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="rom__map_8h_source.html#l04398">MAP_SSIAdvFrameHoldEnable</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04272">MAP_SSIConfigSetExpClk</a>, <a class="el" href="rom__map_8h_source.html#l04279">MAP_SSIEnable</a>, <a class="el" href="ssi_8h_source.html#l00107">SSI_ADV_MODE_READ_WRITE</a>, <a class="el" href="ssi_8h_source.html#l00073">SSI_FRF_MOTO_MODE_0</a>, and <a class="el" href="ssi_8h_source.html#l00080">SSI_MODE_MASTER</a>.</p>
<div class="fragment"><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;{</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// Configure the SPI module.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="rom__map_8h.html#a8b3859fa774e2ad6f31aad1f8644c03d">MAP_SSIConfigSetExpClk</a>(ui32Base, ui32Clock, <a class="code" href="ssi_8h.html#a510fb7c5fbaa13005b174e144eb29260">SSI_FRF_MOTO_MODE_0</a>,</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                           <a class="code" href="ssi_8h.html#a56dae2de51b66a6533a27e858bc76fe9">SSI_MODE_MASTER</a>, ui32BitRate, 8);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">// Enable the advanced mode of operation, defaulting to read/write mode.</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a>);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="comment">// Enable the frame hold feature.</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="rom__map_8h.html#a565341d92d0eaebda9f9d911602688ce">MAP_SSIAdvFrameHoldEnable</a>(ui32Base);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">// Enable the SPI module.</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="rom__map_8h.html#ab92ada8d1854704fdf4c8b58ac687f2a">MAP_SSIEnable</a>(ui32Base);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;}</div>
<div class="ttc" id="rom__map_8h_html_ab92ada8d1854704fdf4c8b58ac687f2a"><div class="ttname"><a href="rom__map_8h.html#ab92ada8d1854704fdf4c8b58ac687f2a">MAP_SSIEnable</a></div><div class="ttdeci">#define MAP_SSIEnable</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04279">rom_map.h:4279</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="ssi_8h_html_a510fb7c5fbaa13005b174e144eb29260"><div class="ttname"><a href="ssi_8h.html#a510fb7c5fbaa13005b174e144eb29260">SSI_FRF_MOTO_MODE_0</a></div><div class="ttdeci">#define SSI_FRF_MOTO_MODE_0</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00073">ssi.h:73</a></div></div>
<div class="ttc" id="rom__map_8h_html_a565341d92d0eaebda9f9d911602688ce"><div class="ttname"><a href="rom__map_8h.html#a565341d92d0eaebda9f9d911602688ce">MAP_SSIAdvFrameHoldEnable</a></div><div class="ttdeci">#define MAP_SSIAdvFrameHoldEnable</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04398">rom_map.h:4398</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8b3859fa774e2ad6f31aad1f8644c03d"><div class="ttname"><a href="rom__map_8h.html#a8b3859fa774e2ad6f31aad1f8644c03d">MAP_SSIConfigSetExpClk</a></div><div class="ttdeci">#define MAP_SSIConfigSetExpClk</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04272">rom_map.h:4272</a></div></div>
<div class="ttc" id="ssi_8h_html_a3b381e1d2c940e29363b2e12591f9a0b"><div class="ttname"><a href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_READ_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00107">ssi.h:107</a></div></div>
<div class="ttc" id="ssi_8h_html_a56dae2de51b66a6533a27e858bc76fe9"><div class="ttname"><a href="ssi_8h.html#a56dae2de51b66a6533a27e858bc76fe9">SSI_MODE_MASTER</a></div><div class="ttdeci">#define SSI_MODE_MASTER</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00080">ssi.h:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0d56c3c7817caa138af5f48be143f0f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t SPIFlashIntHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *&#160;</td>
          <td class="paramname"><em>pState</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handles SSI module interrupts for the SPI flash driver.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pState</td><td>is a pointer to the SPI flash driver instance data.</td></tr>
  </table>
  </dd>
</dl>
<p>This function handles SSI module interrupts that are generated as a result of SPI flash driver operations. This must be called by the application in response to the SSI module interrupt when using the SPIFlashxxxNonBlocking APIs.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <b>SPI_FLASH_IDLE</b> if there is no transfer in progress, <b>SPI_FLASH_WORKING</b> is the requested transfer is still in progress, or <b>SPI_FLASH_DONE</b> if the requested transfer has completed. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l00103">103</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8h_source.html#l00080">tSPIFlashState::bUseDMA</a>, <a class="el" href="spi__flash_8c_source.html#l00059">CMD_DREAD</a>, <a class="el" href="spi__flash_8c_source.html#l00052">CMD_PP</a>, <a class="el" href="spi__flash_8c_source.html#l00061">CMD_QREAD</a>, <a class="el" href="spi__flash_8c_source.html#l00053">CMD_READ</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="rom__map_8h_source.html#l04391">MAP_SSIAdvDataPutFrameEndNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04321">MAP_SSIDataPutNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04349">MAP_SSIDMADisable</a>, <a class="el" href="rom__map_8h_source.html#l04342">MAP_SSIDMAEnable</a>, <a class="el" href="spi__flash_8h_source.html#l00065">tSPIFlashState::pui8Buffer</a>, <a class="el" href="spi__flash_8h_source.html#l00109">SPI_FLASH_DONE</a>, <a class="el" href="spi__flash_8h_source.html#l00107">SPI_FLASH_IDLE</a>, <a class="el" href="spi__flash_8h_source.html#l00108">SPI_FLASH_WORKING</a>, <a class="el" href="ssi_8h_source.html#l00109">SSI_ADV_MODE_BI_READ</a>, <a class="el" href="ssi_8h_source.html#l00111">SSI_ADV_MODE_QUAD_READ</a>, <a class="el" href="ssi_8h_source.html#l00107">SSI_ADV_MODE_READ_WRITE</a>, <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>, <a class="el" href="ssi_8h_source.html#l00090">SSI_DMA_RX</a>, <a class="el" href="ssi_8h_source.html#l00089">SSI_DMA_TX</a>, <a class="el" href="hw__ssi_8h_source.html#l00200">SSI_ICR_DMARXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00199">SSI_ICR_DMATXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00145">SSI_IM_DMARXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00144">SSI_IM_DMATXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00146">SSI_IM_TXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00182">SSI_MIS_DMARXMIS</a>, <a class="el" href="hw__ssi_8h_source.html#l00180">SSI_MIS_DMATXMIS</a>, <a class="el" href="hw__ssi_8h_source.html#l00050">SSI_O_DR</a>, <a class="el" href="hw__ssi_8h_source.html#l00056">SSI_O_ICR</a>, <a class="el" href="hw__ssi_8h_source.html#l00053">SSI_O_IM</a>, <a class="el" href="hw__ssi_8h_source.html#l00055">SSI_O_MIS</a>, <a class="el" href="spi__flash_8c_source.html#l00073">STATE_ADDR1</a>, <a class="el" href="spi__flash_8c_source.html#l00074">STATE_ADDR2</a>, <a class="el" href="spi__flash_8c_source.html#l00075">STATE_ADDR3</a>, <a class="el" href="spi__flash_8c_source.html#l00072">STATE_CMD</a>, <a class="el" href="spi__flash_8c_source.html#l00071">STATE_IDLE</a>, <a class="el" href="spi__flash_8c_source.html#l00078">STATE_READ_DATA</a>, <a class="el" href="spi__flash_8c_source.html#l00079">STATE_READ_DATA_DMA</a>, <a class="el" href="spi__flash_8c_source.html#l00080">STATE_READ_DATA_END</a>, <a class="el" href="spi__flash_8c_source.html#l00077">STATE_READ_DATA_SETUP</a>, <a class="el" href="spi__flash_8c_source.html#l00076">STATE_READ_DUMMY</a>, <a class="el" href="spi__flash_8c_source.html#l00082">STATE_WRITE_DATA</a>, <a class="el" href="spi__flash_8c_source.html#l00083">STATE_WRITE_DATA_DMA</a>, <a class="el" href="spi__flash_8c_source.html#l00084">STATE_WRITE_DATA_END</a>, <a class="el" href="spi__flash_8c_source.html#l00081">STATE_WRITE_DATA_SETUP</a>, <a class="el" href="hw__udma_8h_source.html#l00065">UDMA_ALTCLR</a>, <a class="el" href="udma_8h_source.html#l00238">UDMA_ARB_2</a>, <a class="el" href="udma_8h_source.html#l00239">UDMA_ARB_4</a>, <a class="el" href="udma_8h_source.html#l00224">UDMA_DST_INC_8</a>, <a class="el" href="udma_8h_source.html#l00227">UDMA_DST_INC_NONE</a>, <a class="el" href="hw__udma_8h_source.html#l00062">UDMA_ENACLR</a>, <a class="el" href="udma_8h_source.html#l00210">UDMA_MODE_BASIC</a>, <a class="el" href="hw__udma_8h_source.html#l00068">UDMA_PRIOCLR</a>, <a class="el" href="hw__udma_8h_source.html#l00067">UDMA_PRIOSET</a>, <a class="el" href="hw__udma_8h_source.html#l00060">UDMA_REQMASKCLR</a>, <a class="el" href="udma_8h_source.html#l00232">UDMA_SIZE_8</a>, <a class="el" href="udma_8h_source.html#l00228">UDMA_SRC_INC_8</a>, <a class="el" href="udma_8h_source.html#l00231">UDMA_SRC_INC_NONE</a>, <a class="el" href="hw__udma_8h_source.html#l00057">UDMA_USEBURSTSET</a>, <a class="el" href="udma_8c_source.html#l00603">uDMAChannelControlSet()</a>, <a class="el" href="udma_8c_source.html#l00152">uDMAChannelEnable()</a>, <a class="el" href="udma_8c_source.html#l00710">uDMAChannelTransferSet()</a>, <a class="el" href="spi__flash_8h_source.html#l00050">tSPIFlashState::ui16Cmd</a>, <a class="el" href="spi__flash_8h_source.html#l00055">tSPIFlashState::ui16State</a>, <a class="el" href="spi__flash_8h_source.html#l00060">tSPIFlashState::ui32Addr</a>, <a class="el" href="spi__flash_8h_source.html#l00045">tSPIFlashState::ui32Base</a>, <a class="el" href="spi__flash_8h_source.html#l00070">tSPIFlashState::ui32ReadCount</a>, <a class="el" href="spi__flash_8h_source.html#l00091">tSPIFlashState::ui32RxChannel</a>, <a class="el" href="spi__flash_8h_source.html#l00086">tSPIFlashState::ui32TxChannel</a>, and <a class="el" href="spi__flash_8h_source.html#l00075">tSPIFlashState::ui32WriteCount</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    uint32_t ui32Data, ui32Count;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Set the write count to four.  This is the maximum number of bytes that</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// will be written into the SSI transmit FIFO in the interrupt handler.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// Writing more might be possible but makes the latency of handling future</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// SSI interrupt critical to preventing receive FIFO overruns.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    ui32Count = 4;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Get the set of asserted and unmasked SSI module interrupts.  Only some</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// of these are directly handled; the others are implicitly handled via the</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// operation of the state machine.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ui32Data = <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#adb7055b4042d647c5810778257911c2f">SSI_O_MIS</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// See if the uDMA transmit complete interrupt has asserted.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span>(ui32Data &amp; <a class="code" href="hw__ssi_8h.html#aa2d7bfefb90fd58c349d8f52fe6e05f0">SSI_MIS_DMATXMIS</a>)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// Determine the size of the uDMA transfer based on the number of bytes</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">// left to write.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1024)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="comment">// There are more than 1024 bytes left to transfer, so the uDMA</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="comment">// transfer that just completed was for a full 1024 bytes.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> -= 1024;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="comment">// If a page program is being performed, then the data buffer</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="comment">// pointer needs to be incremented as well.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> == <a class="code" href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <span class="comment">// Increment the data buffer pointer.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> += 1024;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="comment">// See if there is more than one byte left to transfer.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="comment">// Configure the uDMA to transmit the next portion of the</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    <a class="code" href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3">uDMAChannelTransferSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                           <a class="code" href="udma_8h.html#a0d0916171d90267e53ad4c455f81ab85">UDMA_MODE_BASIC</a>,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                           pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                           (<span class="keywordtype">void</span> *)(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> +</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                    <a class="code" href="hw__ssi_8h.html#aeee45da597a7055c2b8468367cd8e920">SSI_O_DR</a>),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                           (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1024) ?</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                           1024 : pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> - 1);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="comment">// Enable the uDMA transmit channel.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <a class="code" href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06">uDMAChannelEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">// There are 1024 or less bytes left to transfer, so the uDMA</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="comment">// transfer that just copmleted was for one less than the remaining</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="comment">// transfer count.  If a page program is being performed, then the</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">// data buffer pointer needs to be incremented.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> == <a class="code" href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> += (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> - 1);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">// Set the remaining transfer count to 1.  The final byte will be</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="comment">// transferred with PIO since the end of frame flag needs to be set</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">// first.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> = 1;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">// Clear the uDMA transmit complete interrupt.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// See if the uDMA receive complete interrupt has asserted.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span>(ui32Data &amp; <a class="code" href="hw__ssi_8h.html#a9e26a9350a70e9cd92f99d5a83f6670a">SSI_MIS_DMARXMIS</a>)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">// Determine the size of the uDMA transfer based on the number of bytes</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">// left to read.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> &gt;= 1024)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="comment">// There are 1024 or more bytes left to transfer, so the uDMA</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// transfer that just completed was for a full 1024 bytes.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> -= 1024;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> != 0)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> -= 1024;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="comment">// The data buffer pointer needs to be incremented as well.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> += 1024;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">// See if there is additional data to transfer.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> != 0)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="comment">// Configure the transmit uDMA if there is more than one byte</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="comment">// left to write.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    <span class="comment">// Configure the uDMA to transmit the next portion of the</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    <a class="code" href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3">uDMAChannelTransferSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                           <a class="code" href="udma_8h.html#a0d0916171d90267e53ad4c455f81ab85">UDMA_MODE_BASIC</a>, pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                           (<span class="keywordtype">void</span> *)(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> +</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                                    <a class="code" href="hw__ssi_8h.html#aeee45da597a7055c2b8468367cd8e920">SSI_O_DR</a>),</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                           (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1024) ?</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                           1024 : pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> - 1);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <span class="comment">// Enable the uDMA transmit channel.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <a class="code" href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06">uDMAChannelEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="comment">// Configure the uDMA to receive the next portion of the data</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="comment">// buffer.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <a class="code" href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3">uDMAChannelTransferSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>, <a class="code" href="udma_8h.html#a0d0916171d90267e53ad4c455f81ab85">UDMA_MODE_BASIC</a>,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                       (<span class="keywordtype">void</span> *)(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#aeee45da597a7055c2b8468367cd8e920">SSI_O_DR</a>),</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                       pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                       (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> &gt;= 1024) ?</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                       1024 : pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="comment">// Enable the uDMA receive channel.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <a class="code" href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06">uDMAChannelEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="comment">// If this is the final receive uDMA buffer and there is a</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="comment">// transmit uDMA buffer associated, enable the DMA transmit</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="comment">// interrupt.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">if</span>((pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> &lt;= 1024) &amp;&amp;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                   (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1))</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a061b9446afd7711c00e17fb127490c41">SSI_IM_DMATXIM</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">// There are less than 1024 bytes left to transfer, so the uDMA</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="comment">// transfer that copmleted was for the remaining transfer count.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> = 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">// Clear the uDMA receive complete interrupt.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// Drain the receive FIFO is not using uDMA.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span>(!pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a>)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// Loop while there is more data in the receive FIFO and more data to</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">// be read.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">while</span>((pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> != 0) &amp;&amp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;              (<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, &amp;ui32Data) != 0))</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">// Save this byte into the data buffer.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            *(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>)++ = ui32Data &amp; 0xff;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="comment">// Decrement the read count.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a>--;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// The SPI flash state machine.  Loop forever; the state machine will</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// explicitly return to the caller when there is no further work that can</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// be done without stalling.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">while</span>(1)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">// Determine the current state.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">switch</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a>)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="comment">// The state machine is idle.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#gaafff27c7165f059a969fe60fee51f683">STATE_IDLE</a>:</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="comment">// Return indicating that the state machine is idle.  This</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="comment">// should never happen since no further interrupts should occur</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                <span class="comment">// once the transfer has completed and the state machine goes</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <span class="comment">// into the idle state.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ac6eafdef3c4e5d673a746ea45dcafb33">SPI_FLASH_IDLE</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="comment">// The state machine is in the command state.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a>:</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="comment">// Attempt to write the command byte into the FIFO.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                             pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a>) == 0)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    <span class="comment">// The command byte could not be written, so return</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <span class="comment">// The command byte has been written, so move to the first</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    <span class="comment">// address byte state.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga24066dd67ecabc27f87c908010002988">STATE_ADDR1</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    <span class="comment">// Decrement the count of bytes that have been written.</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    ui32Count--;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="comment">// The state machine is in the first address byte state.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga24066dd67ecabc27f87c908010002988">STATE_ADDR1</a>:</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <span class="comment">// Attempt to write the first address byte into the FIFO.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                             (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> &gt;&gt; 16) &amp;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                             0xff) == 0)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    <span class="comment">// The first address byte could not be written, so return</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    <span class="comment">// The first address byte has been written, so move to the</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    <span class="comment">// second address byte state.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga37df3bc5709b8a9c3658aa65175e04d8">STATE_ADDR2</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    <span class="comment">// Decrement the count of bytes that have been written.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    ui32Count--;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="comment">// The state machine is in the second address byte state.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga37df3bc5709b8a9c3658aa65175e04d8">STATE_ADDR2</a>:</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="comment">// Attempt to write the second address byte into the FIFO.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                             (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> &gt;&gt; 8) &amp; 0xff) ==</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                   0)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    <span class="comment">// The second address byte could not be written, so return</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    <span class="comment">// The second address byte has been written, so move to the</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="comment">// third address byte state.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga3b7208a6ce8258ad8bf6160d2ea35b2f">STATE_ADDR3</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    <span class="comment">// Decrement the count of bytes that have been written.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    ui32Count--;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="comment">// The state machine is in the third address byte state.</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga3b7208a6ce8258ad8bf6160d2ea35b2f">STATE_ADDR3</a>:</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <span class="comment">// Attempt to write the third address byte into the FIFO.</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                             pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> &amp; 0xff) == 0)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    <span class="comment">// The third address byte could not be written, so return</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <span class="comment">// The third address byte has been written, so determine</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="comment">// the next state based on the command byte.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> == <a class="code" href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a>)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        <span class="comment">// A page program is being performed, so move to the</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        <span class="comment">// write data setup state.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga75f5fdfe876583fac9954464e1bdacae">STATE_WRITE_DATA_SETUP</a>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> == <a class="code" href="group__spi__flash__api.html#ga9c953a6c538020e644127ee080608021">CMD_READ</a>)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        <span class="comment">// A read is being performed, so move to the read data</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        <span class="comment">// setup state.</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga8a38e584b3df3a826f3e3604b59f1341">STATE_READ_DATA_SETUP</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <span class="comment">// The other forms of read (fast read, dual read, and</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        <span class="comment">// quad read) all require a dummy byte.  Move to the</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="comment">// dummy byte state.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#gaa2044cfac78a38212abe959061b73b93">STATE_READ_DUMMY</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    <span class="comment">// Decrement the count of bytes that have been written.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    ui32Count--;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="comment">// The state machine is in the dummy byte state.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#gaa2044cfac78a38212abe959061b73b93">STATE_READ_DUMMY</a>:</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="comment">// Attempt to write the dummy byte into the FIFO.</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, 0) == 0)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="comment">// THe dummy byte could not be written, so return</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    <span class="comment">// The dummy byte has been written, so move to the read</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                    <span class="comment">// data setup state.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga8a38e584b3df3a826f3e3604b59f1341">STATE_READ_DATA_SETUP</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    <span class="comment">// Decrement the count of bytes that have been written.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                    ui32Count--;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="comment">// The state machine is in the read data setup state.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga8a38e584b3df3a826f3e3604b59f1341">STATE_READ_DATA_SETUP</a>:</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                <span class="comment">// Set the SSI module into the appropriate mode based on the</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                <span class="comment">// command byte.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> == <a class="code" href="group__spi__flash__api.html#gac7464fa85e0f285f4f293e4a5109b88a">CMD_DREAD</a>)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    <span class="comment">// Bi-SPI read mode is used for the dual read command.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, <a class="code" href="ssi_8h.html#a0d3b574fbf3d0b60970d6f3357ac13bd">SSI_ADV_MODE_BI_READ</a>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> == <a class="code" href="group__spi__flash__api.html#gaccf40d95b8aa697f4023b4ff334b61fa">CMD_QREAD</a>)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    <span class="comment">// Quad-SPI read mode is used for the quad read command.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                      <a class="code" href="ssi_8h.html#a4dd541d5976ffab841e75cbaa5515a48">SSI_ADV_MODE_QUAD_READ</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <span class="comment">// Advanced read/write mode is used for the read and fast</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    <span class="comment">// read commands.</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                      <a class="code" href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                <span class="comment">// See if a single byte is being transferred.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> == 1)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    <span class="comment">// Disable the use of uDMA.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    <span class="comment">// Move to the read data end state to transfer the single</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    <span class="comment">// byte.  This uses PIO even if uDMA has been requested.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga0a0a8dfd33eacde71dfa36beccd55673">STATE_READ_DATA_END</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="comment">// See if uDMA has been requested for this transfer.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> || (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> &lt; 4))</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    <span class="comment">// Disable the use of uDMA.</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    <span class="comment">// Move to the read data state.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#gaad5e20feb263b09e1be1f48394fdb50a">STATE_READ_DATA</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="comment">// This transfer should use uDMA.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    <span class="comment">// If the transfer is larger than 1024 bytes, enable the</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <span class="comment">// uDMA receive complete interrupt which will be used to</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    <span class="comment">// move to the next block of the transfer.  Otherwise,</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    <span class="comment">// enable the uDMA transmit complete interrupt which will</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    <span class="comment">// be used to complete the transaction.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> &gt; 1024)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                        <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#ab5b00bc0dac2957c1e749feda9745280">SSI_IM_DMARXIM</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a061b9446afd7711c00e17fb127490c41">SSI_IM_DMATXIM</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    <span class="comment">// Disable the uDMA channels.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#ad6083ee9273019db8454bc298c3673e0">UDMA_ENACLR</a>) = ((1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>) |</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                          (1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>));</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    <span class="comment">// Configure the attributes for the transmit uDMA channel.</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a93b7ff36ae2aa59087166fc2445a5f86">UDMA_USEBURSTSET</a>) = ((1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>) |</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                               (1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>));</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a297a23ad50e4111b1fbd0690c4c4a1c2">UDMA_ALTCLR</a>) = ((1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>) |</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                          (1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>));</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a4551274bc3f8c607d10e7407030a043d">UDMA_PRIOCLR</a>) = 1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a616a171071e25adf3b2ffb37b3c4e31b">UDMA_PRIOSET</a>) = 1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a9bf39ed430bce60aff19ce8115120751">UDMA_REQMASKCLR</a>) = ((1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>) |</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                              (1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>));</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    <span class="comment">// Configure the control parameters of the uDMA channels.</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <a class="code" href="group__udma__api.html#ga6f73ab006ff6a593eeeb947130bbdf6f">uDMAChannelControlSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                          <a class="code" href="udma_8h.html#ace9a62c226f2e73cc1a7c56d80efa361">UDMA_SRC_INC_NONE</a> |</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                          <a class="code" href="udma_8h.html#aff850520540f2dd5ef6c016ac9bc85f8">UDMA_DST_INC_NONE</a> |</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                          <a class="code" href="udma_8h.html#acfd5e57fa4a0c7e33d76c9f0f663c70e">UDMA_SIZE_8</a> | <a class="code" href="udma_8h.html#a06a426feec6bae050e1ceec32feb6524">UDMA_ARB_2</a>);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    <a class="code" href="group__udma__api.html#ga6f73ab006ff6a593eeeb947130bbdf6f">uDMAChannelControlSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>,</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                          <a class="code" href="udma_8h.html#ace9a62c226f2e73cc1a7c56d80efa361">UDMA_SRC_INC_NONE</a> |</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                          <a class="code" href="udma_8h.html#a8df004d5dabcc2302bc3170f228d6a8e">UDMA_DST_INC_8</a> |</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                          <a class="code" href="udma_8h.html#acfd5e57fa4a0c7e33d76c9f0f663c70e">UDMA_SIZE_8</a> | <a class="code" href="udma_8h.html#a54624c18043cb15f52b95faad3251f6d">UDMA_ARB_4</a>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    <span class="comment">// Configure the uDMA receive channel to transfer the first</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    <span class="comment">// portion of the data buffer.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    <a class="code" href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3">uDMAChannelTransferSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                           <a class="code" href="udma_8h.html#a0d0916171d90267e53ad4c455f81ab85">UDMA_MODE_BASIC</a>,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                           (<span class="keywordtype">void</span> *)(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> +</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                                    <a class="code" href="hw__ssi_8h.html#aeee45da597a7055c2b8468367cd8e920">SSI_O_DR</a>),</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                           pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>,</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                           (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> &gt;= 1024) ?</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                           1024 : pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="comment">// Enable the uDMA receive channel.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    <a class="code" href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06">uDMAChannelEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    <span class="comment">// Configure the uDMA channel to transfer the dummy bytes</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    <span class="comment">// for the first portion of the data buffer.  The last</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    <span class="comment">// dummy byte will not be included since it must be treated</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                    <span class="comment">// special.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    <a class="code" href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3">uDMAChannelTransferSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>,</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                                           <a class="code" href="udma_8h.html#a0d0916171d90267e53ad4c455f81ab85">UDMA_MODE_BASIC</a>,</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                           pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                           (<span class="keywordtype">void</span> *)(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> +</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                                    <a class="code" href="hw__ssi_8h.html#aeee45da597a7055c2b8468367cd8e920">SSI_O_DR</a>),</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                           (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1024) ?</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                           1024 : pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> - 1);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <span class="comment">// Enable the uDMA transmit channel.</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    <a class="code" href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06">uDMAChannelEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    <span class="comment">// Clear any previously pending uDMA completion interrupt.</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    <span class="comment">// Enable uDMA transmit and receive in the SSI module.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    <a class="code" href="rom__map_8h.html#a2afd24398ee80ff8864f68c470c0e9b5">MAP_SSIDMAEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                     <a class="code" href="ssi_8h.html#a90f31eb354206da6173911200ba7d2cb">SSI_DMA_TX</a> | <a class="code" href="ssi_8h.html#acad5d21da630367195b15fe80be03a64">SSI_DMA_RX</a>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    <span class="comment">// Move to the uDMA data read state.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga91b29ddde291ec8eb0a75b7d1aa119f9">STATE_READ_DATA_DMA</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="comment">// The state machine is in the read data state.</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#gaad5e20feb263b09e1be1f48394fdb50a">STATE_READ_DATA</a>:</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="comment">// Loop while there is more than one byte left to write.</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="keywordflow">while</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> != 1)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    <span class="comment">// Dummy bytes are written into the FIFO in order to</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    <span class="comment">// trigger the read operation.  Attempt to write another</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    <span class="comment">// dummy byte into the FIFO.</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                        <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, 0) == 0)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                        <span class="comment">// The dummy byte could not be written, so return</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                        <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                        <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    <span class="comment">// Decrement the count of dummy bytes to write.</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a>--;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    <span class="comment">// Decrement the count of bytes that have been written.</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    ui32Count--;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="comment">// Move to the read data end state.</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga0a0a8dfd33eacde71dfa36beccd55673">STATE_READ_DATA_END</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="comment">// The state machine is in the uDMA read data state.</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga91b29ddde291ec8eb0a75b7d1aa119f9">STATE_READ_DATA_DMA</a>:</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <span class="comment">// See if the write count is greater than one.</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    <span class="comment">// Return indicating that the transfer is still in</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    <span class="comment">// progress.</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <span class="comment">// Disable uDMA transmit in the SSI module.</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <a class="code" href="rom__map_8h.html#a07161e7fa7b8499571fcc680d3bbd527">MAP_SSIDMADisable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, <a class="code" href="ssi_8h.html#a90f31eb354206da6173911200ba7d2cb">SSI_DMA_TX</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                <span class="comment">// Enable the uDMA receive done and FIFO transmit interrupt.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) =</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    <a class="code" href="hw__ssi_8h.html#ab5b00bc0dac2957c1e749feda9745280">SSI_IM_DMARXIM</a> | <a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <span class="comment">// Move to the read data end state.</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga0a0a8dfd33eacde71dfa36beccd55673">STATE_READ_DATA_END</a>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="comment">// The state machine is in the data read end state.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga0a0a8dfd33eacde71dfa36beccd55673">STATE_READ_DATA_END</a>:</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <span class="comment">// See if the final dummy byte still needs to be written.</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> != 0)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                    <span class="comment">// Attempt to write the final dummy byte into the FIFO and</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                    <span class="comment">// mark it as the end of the frame.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                    {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                    }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#aed0a08c7007456819f7e6ddc22ddeaba">MAP_SSIAdvDataPutFrameEndNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                                            0) == 0)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                    {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                        <span class="comment">// The dummy byte could not be written, so return</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                        <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                    <span class="comment">// The write portion of the transfer has completed.</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> = 0;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                    <span class="comment">// Disable the transmit interrupt now that the write</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                    <span class="comment">// write portion of the transfer has completed.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) &amp;= ~(<a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a>);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                <span class="comment">// Return indicating that the transfer is still in progress if</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                <span class="comment">// there are still data bytes to be read.</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> != 0)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                <span class="comment">// Disable uDMA receive in the SSI module.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <a class="code" href="rom__map_8h.html#a07161e7fa7b8499571fcc680d3bbd527">MAP_SSIDMADisable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, <a class="code" href="ssi_8h.html#acad5d21da630367195b15fe80be03a64">SSI_DMA_RX</a>);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="comment">// The transfer is complete, so disable all interrupts.</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = 0;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                <span class="comment">// Move to the idle state.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#gaafff27c7165f059a969fe60fee51f683">STATE_IDLE</a>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="comment">// Return indicating that the transfer has completed.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#aca3e474ded3319802c56c082e198903c">SPI_FLASH_DONE</a>);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            <span class="comment">// The state machine is in the write data setup state.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga75f5fdfe876583fac9954464e1bdacae">STATE_WRITE_DATA_SETUP</a>:</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="comment">// See if a single data byte is being transferred.</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> == 1)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                    <span class="comment">// Disable the use of uDMA.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                    <span class="comment">// Move to the write data end state to transfer the single</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    <span class="comment">// byte.  This uses PIO even if uDMA has been requested.</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga6b1d1c61ab08460db62fe8441f7882ee">STATE_WRITE_DATA_END</a>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <span class="comment">// See if uDMA has been requested for this transfer.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> || (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &lt; 4))</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    <span class="comment">// Disable the use of uDMA.</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                    <span class="comment">// uDMA is not being used, so move to the write data state.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga76d26adac52cf8bd900415b001591008">STATE_WRITE_DATA</a>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                <span class="comment">// This transfer should use uDMA.</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    <span class="comment">// Enable the uDMA transmit complete interrupt.</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a061b9446afd7711c00e17fb127490c41">SSI_IM_DMATXIM</a>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                    <span class="comment">// Disable the transmit uDMA channel.</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#ad6083ee9273019db8454bc298c3673e0">UDMA_ENACLR</a>) = 1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    <span class="comment">// Configure the attributes for the transmit uDMA channel.</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a93b7ff36ae2aa59087166fc2445a5f86">UDMA_USEBURSTSET</a>) = 1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a297a23ad50e4111b1fbd0690c4c4a1c2">UDMA_ALTCLR</a>) = 1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a4551274bc3f8c607d10e7407030a043d">UDMA_PRIOCLR</a>) = 1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__udma_8h.html#a9bf39ed430bce60aff19ce8115120751">UDMA_REQMASKCLR</a>) = 1 &lt;&lt; pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                    <span class="comment">// Configure the control parameters of the uDMA channel.</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                    <a class="code" href="group__udma__api.html#ga6f73ab006ff6a593eeeb947130bbdf6f">uDMAChannelControlSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>,</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                          <a class="code" href="udma_8h.html#a3a2ecfdeedc93963d2c5b6dcf3598d80">UDMA_SRC_INC_8</a> |</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                          <a class="code" href="udma_8h.html#aff850520540f2dd5ef6c016ac9bc85f8">UDMA_DST_INC_NONE</a> |</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                                          <a class="code" href="udma_8h.html#acfd5e57fa4a0c7e33d76c9f0f663c70e">UDMA_SIZE_8</a> | <a class="code" href="udma_8h.html#a54624c18043cb15f52b95faad3251f6d">UDMA_ARB_4</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    <span class="comment">// Configure the uDMA channel to transfer the next portion</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                    <span class="comment">// of the data buffer.  The last byte in the buffer will</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                    <span class="comment">// not be included since it must be treated special.</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    <a class="code" href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3">uDMAChannelTransferSet</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>,</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                           <a class="code" href="udma_8h.html#a0d0916171d90267e53ad4c455f81ab85">UDMA_MODE_BASIC</a>,</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                           pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>,</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                           (<span class="keywordtype">void</span> *)(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> +</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                                    <a class="code" href="hw__ssi_8h.html#aeee45da597a7055c2b8468367cd8e920">SSI_O_DR</a>),</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                           (pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1024) ?</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                                           1024 : pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> - 1);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                    <span class="comment">// Enable the uDMA transmit channel.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                    <a class="code" href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06">uDMAChannelEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a>);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    <span class="comment">// Enable uDMA in the SSI module.</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    <a class="code" href="rom__map_8h.html#a2afd24398ee80ff8864f68c470c0e9b5">MAP_SSIDMAEnable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, <a class="code" href="ssi_8h.html#a90f31eb354206da6173911200ba7d2cb">SSI_DMA_TX</a>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                    <span class="comment">// Move to the uDMA data write state.</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga2a54f197080ab88952cb98579bf86d9e">STATE_WRITE_DATA_DMA</a>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="comment">// The state machine is in the write data state.</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga76d26adac52cf8bd900415b001591008">STATE_WRITE_DATA</a>:</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                <span class="comment">// Loop while there is more than one byte left to write.</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                <span class="keywordflow">while</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> != 1)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    <span class="comment">// Attempt to write the next data byte into the FIFO.</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                    <span class="keywordflow">if</span>(ui32Count == 0)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                    }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                                 *(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>)) == 0)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                    {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                        <span class="comment">// The next data byte could not be written, so return</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                        <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                    }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                    <span class="comment">// Increment the buffer pointer and decrement the byte</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                    <span class="comment">// count.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>++;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a>--;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    <span class="comment">// Decrement the count of bytes that have been written.</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    ui32Count--;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="comment">// Move to the write data end state.</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga6b1d1c61ab08460db62fe8441f7882ee">STATE_WRITE_DATA_END</a>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="comment">// The state machine is in the uDMA write data state.</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga2a54f197080ab88952cb98579bf86d9e">STATE_WRITE_DATA_DMA</a>:</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <span class="comment">// See if the write count is greater than one.</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                <span class="keywordflow">if</span>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> &gt; 1)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    <span class="comment">// Return indicating that the transfer is still in</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    <span class="comment">// progress.</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                <span class="comment">// Disable uDMA in the SSI module.</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                <a class="code" href="rom__map_8h.html#a07161e7fa7b8499571fcc680d3bbd527">MAP_SSIDMADisable</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>, <a class="code" href="ssi_8h.html#a90f31eb354206da6173911200ba7d2cb">SSI_DMA_TX</a>);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                <span class="comment">// Disable the uDMA transmit complete interrupt and enable the</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                <span class="comment">// FIFO interrupt.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                <span class="comment">// Move to the write data end state.</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga6b1d1c61ab08460db62fe8441f7882ee">STATE_WRITE_DATA_END</a>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                <span class="comment">// Done with this state.</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="comment">// The state machine is in the write data end state.</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__spi__flash__api.html#ga6b1d1c61ab08460db62fe8441f7882ee">STATE_WRITE_DATA_END</a>:</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="comment">// Attempt to write the final data byte into the FIFO.</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="rom__map_8h.html#aed0a08c7007456819f7e6ddc22ddeaba">MAP_SSIAdvDataPutFrameEndNonBlocking</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a>,</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                                      *(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a>)) ==</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                   0)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    <span class="comment">// The final data byte could not be written, so return</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                    <span class="comment">// indicating that the transfer is still in progress.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                <span class="comment">// The transfer is complete, so disable all interrupts.</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = 0;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                <span class="comment">// Move to the idle state.</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#gaafff27c7165f059a969fe60fee51f683">STATE_IDLE</a>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                <span class="comment">// Return indicating that the transfer has completed.</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                <span class="keywordflow">return</span>(<a class="code" href="spi__flash_8h.html#aca3e474ded3319802c56c082e198903c">SPI_FLASH_DONE</a>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div>
<div class="ttc" id="udma_8h_html_a0d0916171d90267e53ad4c455f81ab85"><div class="ttname"><a href="udma_8h.html#a0d0916171d90267e53ad4c455f81ab85">UDMA_MODE_BASIC</a></div><div class="ttdeci">#define UDMA_MODE_BASIC</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00210">udma.h:210</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga2543fca56aeb170a41cc9f4d9b24c4cf"><div class="ttname"><a href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a></div><div class="ttdeci">#define CMD_PP</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00052">spi_flash.c:52</a></div></div>
<div class="ttc" id="spi__flash_8h_html_aca3e474ded3319802c56c082e198903c"><div class="ttname"><a href="spi__flash_8h.html#aca3e474ded3319802c56c082e198903c">SPI_FLASH_DONE</a></div><div class="ttdeci">#define SPI_FLASH_DONE</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00109">spi_flash.h:109</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gac7464fa85e0f285f4f293e4a5109b88a"><div class="ttname"><a href="group__spi__flash__api.html#gac7464fa85e0f285f4f293e4a5109b88a">CMD_DREAD</a></div><div class="ttdeci">#define CMD_DREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00059">spi_flash.c:59</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ade82e929a6d52eb542fe1d34ee210764"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">tSPIFlashState::ui32ReadCount</a></div><div class="ttdeci">uint32_t ui32ReadCount</div><div class="ttdoc">The count of bytes left to be read. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00070">spi_flash.h:70</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a3bb98b66624f93e28338d954d3fd9032"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">tSPIFlashState::ui32TxChannel</a></div><div class="ttdeci">uint32_t ui32TxChannel</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00086">spi_flash.h:86</a></div></div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaad5e20feb263b09e1be1f48394fdb50a"><div class="ttname"><a href="group__spi__flash__api.html#gaad5e20feb263b09e1be1f48394fdb50a">STATE_READ_DATA</a></div><div class="ttdeci">#define STATE_READ_DATA</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00078">spi_flash.c:78</a></div></div>
<div class="ttc" id="spi__flash_8h_html_ae368a0a3d565b6e96aeb09c7ee4db481"><div class="ttname"><a href="spi__flash_8h.html#ae368a0a3d565b6e96aeb09c7ee4db481">SPI_FLASH_WORKING</a></div><div class="ttdeci">#define SPI_FLASH_WORKING</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00108">spi_flash.h:108</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_aa47658e72d6edfdebf29fd87a368c23e"><div class="ttname"><a href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">tSPIFlashState::ui32RxChannel</a></div><div class="ttdeci">uint32_t ui32RxChannel</div><div class="ttdoc">The uDMA channel to use for receiving when using uDMA for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00091">spi_flash.h:91</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaccf40d95b8aa697f4023b4ff334b61fa"><div class="ttname"><a href="group__spi__flash__api.html#gaccf40d95b8aa697f4023b4ff334b61fa">CMD_QREAD</a></div><div class="ttdeci">#define CMD_QREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00061">spi_flash.c:61</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_afa5492f2bf96fc487cb9c6e89ee75dbf"><div class="ttname"><a href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">tSPIFlashState::ui32Base</a></div><div class="ttdeci">uint32_t ui32Base</div><div class="ttdoc">The base address of the SSI module that is being used. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00045">spi_flash.h:45</a></div></div>
<div class="ttc" id="udma_8h_html_aff850520540f2dd5ef6c016ac9bc85f8"><div class="ttname"><a href="udma_8h.html#aff850520540f2dd5ef6c016ac9bc85f8">UDMA_DST_INC_NONE</a></div><div class="ttdeci">#define UDMA_DST_INC_NONE</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00227">udma.h:227</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2afd24398ee80ff8864f68c470c0e9b5"><div class="ttname"><a href="rom__map_8h.html#a2afd24398ee80ff8864f68c470c0e9b5">MAP_SSIDMAEnable</a></div><div class="ttdeci">#define MAP_SSIDMAEnable</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04342">rom_map.h:4342</a></div></div>
<div class="ttc" id="hw__types_8h_html_ac9660181819fceac0b5abcd67d76ca6e"><div class="ttname"><a href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a></div><div class="ttdeci">#define HWREG(x)</div><div class="ttdef"><b>Definition:</b> <a href="hw__types_8h_source.html#l00048">hw_types.h:48</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a0c839fa56316268d9d3c1a6338d5b9a8"><div class="ttname"><a href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a></div><div class="ttdeci">#define SSI_O_IM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00053">hw_ssi.h:53</a></div></div>
<div class="ttc" id="group__udma__api_html_ga938c21dc70cb6e11e6eb826de0fa21c3"><div class="ttname"><a href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3">uDMAChannelTransferSet</a></div><div class="ttdeci">void uDMAChannelTransferSet(uint32_t ui32ChannelStructIndex, uint32_t ui32Mode, void *pvSrcAddr, void *pvDstAddr, uint32_t ui32TransferSize)</div><div class="ttdef"><b>Definition:</b> <a href="udma_8c_source.html#l00710">udma.c:710</a></div></div>
<div class="ttc" id="spi__flash_8h_html_ac6eafdef3c4e5d673a746ea45dcafb33"><div class="ttname"><a href="spi__flash_8h.html#ac6eafdef3c4e5d673a746ea45dcafb33">SPI_FLASH_IDLE</a></div><div class="ttdeci">#define SPI_FLASH_IDLE</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00107">spi_flash.h:107</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_ab5b00bc0dac2957c1e749feda9745280"><div class="ttname"><a href="hw__ssi_8h.html#ab5b00bc0dac2957c1e749feda9745280">SSI_IM_DMARXIM</a></div><div class="ttdeci">#define SSI_IM_DMARXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00145">hw_ssi.h:145</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a2bc8ac2fab0bc4c2a47f207c976ba875"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">tSPIFlashState::pui8Buffer</a></div><div class="ttdeci">uint8_t * pui8Buffer</div><div class="ttdoc">A pointer to the data buffer that is being read or written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00065">spi_flash.h:65</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga8a38e584b3df3a826f3e3604b59f1341"><div class="ttname"><a href="group__spi__flash__api.html#ga8a38e584b3df3a826f3e3604b59f1341">STATE_READ_DATA_SETUP</a></div><div class="ttdeci">#define STATE_READ_DATA_SETUP</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00077">spi_flash.c:77</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aaf63879f2c29b6fd6d9903153dd4271a"><div class="ttname"><a href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a></div><div class="ttdeci">#define SSI_O_ICR</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00056">hw_ssi.h:56</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga2a54f197080ab88952cb98579bf86d9e"><div class="ttname"><a href="group__spi__flash__api.html#ga2a54f197080ab88952cb98579bf86d9e">STATE_WRITE_DATA_DMA</a></div><div class="ttdeci">#define STATE_WRITE_DATA_DMA</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00083">spi_flash.c:83</a></div></div>
<div class="ttc" id="ssi_8h_html_a4dd541d5976ffab841e75cbaa5515a48"><div class="ttname"><a href="ssi_8h.html#a4dd541d5976ffab841e75cbaa5515a48">SSI_ADV_MODE_QUAD_READ</a></div><div class="ttdeci">#define SSI_ADV_MODE_QUAD_READ</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00111">ssi.h:111</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aeee45da597a7055c2b8468367cd8e920"><div class="ttname"><a href="hw__ssi_8h.html#aeee45da597a7055c2b8468367cd8e920">SSI_O_DR</a></div><div class="ttdeci">#define SSI_O_DR</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00050">hw_ssi.h:50</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8c46066183d1c49c10582b59490607a7"><div class="ttname"><a href="rom__map_8h.html#a8c46066183d1c49c10582b59490607a7">MAP_SSIDataPutNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataPutNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04321">rom_map.h:4321</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a061b9446afd7711c00e17fb127490c41"><div class="ttname"><a href="hw__ssi_8h.html#a061b9446afd7711c00e17fb127490c41">SSI_IM_DMATXIM</a></div><div class="ttdeci">#define SSI_IM_DMATXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00144">hw_ssi.h:144</a></div></div>
<div class="ttc" id="group__udma__api_html_ga6f73ab006ff6a593eeeb947130bbdf6f"><div class="ttname"><a href="group__udma__api.html#ga6f73ab006ff6a593eeeb947130bbdf6f">uDMAChannelControlSet</a></div><div class="ttdeci">void uDMAChannelControlSet(uint32_t ui32ChannelStructIndex, uint32_t ui32Control)</div><div class="ttdef"><b>Definition:</b> <a href="udma_8c_source.html#l00603">udma.c:603</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aa2d7bfefb90fd58c349d8f52fe6e05f0"><div class="ttname"><a href="hw__ssi_8h.html#aa2d7bfefb90fd58c349d8f52fe6e05f0">SSI_MIS_DMATXMIS</a></div><div class="ttdeci">#define SSI_MIS_DMATXMIS</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00180">hw_ssi.h:180</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga88c4e00f812e9b6becece01b8f60d678"><div class="ttname"><a href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a></div><div class="ttdeci">#define STATE_CMD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00072">spi_flash.c:72</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ab33983a1783bc5f7593f60ebf8975645"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">tSPIFlashState::bUseDMA</a></div><div class="ttdeci">bool bUseDMA</div><div class="ttdoc">A flag that is true if uDMA used be used for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00080">spi_flash.h:80</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga76d26adac52cf8bd900415b001591008"><div class="ttname"><a href="group__spi__flash__api.html#ga76d26adac52cf8bd900415b001591008">STATE_WRITE_DATA</a></div><div class="ttdeci">#define STATE_WRITE_DATA</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00082">spi_flash.c:82</a></div></div>
<div class="ttc" id="hw__udma_8h_html_a297a23ad50e4111b1fbd0690c4c4a1c2"><div class="ttname"><a href="hw__udma_8h.html#a297a23ad50e4111b1fbd0690c4c4a1c2">UDMA_ALTCLR</a></div><div class="ttdeci">#define UDMA_ALTCLR</div><div class="ttdef"><b>Definition:</b> <a href="hw__udma_8h_source.html#l00065">hw_udma.h:65</a></div></div>
<div class="ttc" id="hw__udma_8h_html_ad6083ee9273019db8454bc298c3673e0"><div class="ttname"><a href="hw__udma_8h.html#ad6083ee9273019db8454bc298c3673e0">UDMA_ENACLR</a></div><div class="ttdeci">#define UDMA_ENACLR</div><div class="ttdef"><b>Definition:</b> <a href="hw__udma_8h_source.html#l00062">hw_udma.h:62</a></div></div>
<div class="ttc" id="udma_8h_html_ace9a62c226f2e73cc1a7c56d80efa361"><div class="ttname"><a href="udma_8h.html#ace9a62c226f2e73cc1a7c56d80efa361">UDMA_SRC_INC_NONE</a></div><div class="ttdeci">#define UDMA_SRC_INC_NONE</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00231">udma.h:231</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a31ff9833643e984d1fd9e48d7a851a6b"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">tSPIFlashState::ui32WriteCount</a></div><div class="ttdeci">uint32_t ui32WriteCount</div><div class="ttdoc">The count of bytes left to be written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00075">spi_flash.h:75</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaafff27c7165f059a969fe60fee51f683"><div class="ttname"><a href="group__spi__flash__api.html#gaafff27c7165f059a969fe60fee51f683">STATE_IDLE</a></div><div class="ttdeci">#define STATE_IDLE</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00071">spi_flash.c:71</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga0a0a8dfd33eacde71dfa36beccd55673"><div class="ttname"><a href="group__spi__flash__api.html#ga0a0a8dfd33eacde71dfa36beccd55673">STATE_READ_DATA_END</a></div><div class="ttdeci">#define STATE_READ_DATA_END</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00080">spi_flash.c:80</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a074f5ab3f6e39f06334bf7ce875c8027"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">tSPIFlashState::ui16Cmd</a></div><div class="ttdeci">uint16_t ui16Cmd</div><div class="ttdoc">The command that is being send to the SPI flash. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00050">spi_flash.h:50</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaa2044cfac78a38212abe959061b73b93"><div class="ttname"><a href="group__spi__flash__api.html#gaa2044cfac78a38212abe959061b73b93">STATE_READ_DUMMY</a></div><div class="ttdeci">#define STATE_READ_DUMMY</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00076">spi_flash.c:76</a></div></div>
<div class="ttc" id="udma_8h_html_a3a2ecfdeedc93963d2c5b6dcf3598d80"><div class="ttname"><a href="udma_8h.html#a3a2ecfdeedc93963d2c5b6dcf3598d80">UDMA_SRC_INC_8</a></div><div class="ttdeci">#define UDMA_SRC_INC_8</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00228">udma.h:228</a></div></div>
<div class="ttc" id="rom__map_8h_html_a07161e7fa7b8499571fcc680d3bbd527"><div class="ttname"><a href="rom__map_8h.html#a07161e7fa7b8499571fcc680d3bbd527">MAP_SSIDMADisable</a></div><div class="ttdeci">#define MAP_SSIDMADisable</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04349">rom_map.h:4349</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a22cc1ee908ec15a4ae5cec1f77195b53"><div class="ttname"><a href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a></div><div class="ttdeci">#define SSI_IM_TXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00146">hw_ssi.h:146</a></div></div>
<div class="ttc" id="ssi_8h_html_a0d3b574fbf3d0b60970d6f3357ac13bd"><div class="ttname"><a href="ssi_8h.html#a0d3b574fbf3d0b60970d6f3357ac13bd">SSI_ADV_MODE_BI_READ</a></div><div class="ttdeci">#define SSI_ADV_MODE_BI_READ</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00109">ssi.h:109</a></div></div>
<div class="ttc" id="udma_8h_html_a8df004d5dabcc2302bc3170f228d6a8e"><div class="ttname"><a href="udma_8h.html#a8df004d5dabcc2302bc3170f228d6a8e">UDMA_DST_INC_8</a></div><div class="ttdeci">#define UDMA_DST_INC_8</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00224">udma.h:224</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a954860482fa17ad95cd0d4cb44fda84b"><div class="ttname"><a href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a></div><div class="ttdeci">#define SSI_ICR_DMARXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00200">hw_ssi.h:200</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a873e573501798cee815d0e810979e579"><div class="ttname"><a href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a></div><div class="ttdeci">#define SSI_ICR_DMATXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00199">hw_ssi.h:199</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga9c953a6c538020e644127ee080608021"><div class="ttname"><a href="group__spi__flash__api.html#ga9c953a6c538020e644127ee080608021">CMD_READ</a></div><div class="ttdeci">#define CMD_READ</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00053">spi_flash.c:53</a></div></div>
<div class="ttc" id="hw__udma_8h_html_a616a171071e25adf3b2ffb37b3c4e31b"><div class="ttname"><a href="hw__udma_8h.html#a616a171071e25adf3b2ffb37b3c4e31b">UDMA_PRIOSET</a></div><div class="ttdeci">#define UDMA_PRIOSET</div><div class="ttdef"><b>Definition:</b> <a href="hw__udma_8h_source.html#l00067">hw_udma.h:67</a></div></div>
<div class="ttc" id="hw__udma_8h_html_a9bf39ed430bce60aff19ce8115120751"><div class="ttname"><a href="hw__udma_8h.html#a9bf39ed430bce60aff19ce8115120751">UDMA_REQMASKCLR</a></div><div class="ttdeci">#define UDMA_REQMASKCLR</div><div class="ttdef"><b>Definition:</b> <a href="hw__udma_8h_source.html#l00060">hw_udma.h:60</a></div></div>
<div class="ttc" id="ssi_8h_html_acad5d21da630367195b15fe80be03a64"><div class="ttname"><a href="ssi_8h.html#acad5d21da630367195b15fe80be03a64">SSI_DMA_RX</a></div><div class="ttdeci">#define SSI_DMA_RX</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00090">ssi.h:90</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a13617645ea59a89666b09faca56d5e83"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">tSPIFlashState::ui16State</a></div><div class="ttdeci">uint16_t ui16State</div><div class="ttdoc">The current state of the SPI flash state machine. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00055">spi_flash.h:55</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a9e26a9350a70e9cd92f99d5a83f6670a"><div class="ttname"><a href="hw__ssi_8h.html#a9e26a9350a70e9cd92f99d5a83f6670a">SSI_MIS_DMARXMIS</a></div><div class="ttdeci">#define SSI_MIS_DMARXMIS</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00182">hw_ssi.h:182</a></div></div>
<div class="ttc" id="hw__udma_8h_html_a4551274bc3f8c607d10e7407030a043d"><div class="ttname"><a href="hw__udma_8h.html#a4551274bc3f8c607d10e7407030a043d">UDMA_PRIOCLR</a></div><div class="ttdeci">#define UDMA_PRIOCLR</div><div class="ttdef"><b>Definition:</b> <a href="hw__udma_8h_source.html#l00068">hw_udma.h:68</a></div></div>
<div class="ttc" id="ssi_8h_html_a90f31eb354206da6173911200ba7d2cb"><div class="ttname"><a href="ssi_8h.html#a90f31eb354206da6173911200ba7d2cb">SSI_DMA_TX</a></div><div class="ttdeci">#define SSI_DMA_TX</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00089">ssi.h:89</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga6b1d1c61ab08460db62fe8441f7882ee"><div class="ttname"><a href="group__spi__flash__api.html#ga6b1d1c61ab08460db62fe8441f7882ee">STATE_WRITE_DATA_END</a></div><div class="ttdeci">#define STATE_WRITE_DATA_END</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00084">spi_flash.c:84</a></div></div>
<div class="ttc" id="ssi_8h_html_a3b381e1d2c940e29363b2e12591f9a0b"><div class="ttname"><a href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_READ_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00107">ssi.h:107</a></div></div>
<div class="ttc" id="udma_8h_html_a54624c18043cb15f52b95faad3251f6d"><div class="ttname"><a href="udma_8h.html#a54624c18043cb15f52b95faad3251f6d">UDMA_ARB_4</a></div><div class="ttdeci">#define UDMA_ARB_4</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00239">udma.h:239</a></div></div>
<div class="ttc" id="udma_8h_html_a06a426feec6bae050e1ceec32feb6524"><div class="ttname"><a href="udma_8h.html#a06a426feec6bae050e1ceec32feb6524">UDMA_ARB_2</a></div><div class="ttdeci">#define UDMA_ARB_2</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00238">udma.h:238</a></div></div>
<div class="ttc" id="hw__udma_8h_html_a93b7ff36ae2aa59087166fc2445a5f86"><div class="ttname"><a href="hw__udma_8h.html#a93b7ff36ae2aa59087166fc2445a5f86">UDMA_USEBURSTSET</a></div><div class="ttdeci">#define UDMA_USEBURSTSET</div><div class="ttdef"><b>Definition:</b> <a href="hw__udma_8h_source.html#l00057">hw_udma.h:57</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a14849eb4c3631e87c93d6bc2ed7c5a9d"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">tSPIFlashState::ui32Addr</a></div><div class="ttdeci">uint32_t ui32Addr</div><div class="ttdoc">The SPI flash address associated with the command. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00060">spi_flash.h:60</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga91b29ddde291ec8eb0a75b7d1aa119f9"><div class="ttname"><a href="group__spi__flash__api.html#ga91b29ddde291ec8eb0a75b7d1aa119f9">STATE_READ_DATA_DMA</a></div><div class="ttdeci">#define STATE_READ_DATA_DMA</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00079">spi_flash.c:79</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga3b7208a6ce8258ad8bf6160d2ea35b2f"><div class="ttname"><a href="group__spi__flash__api.html#ga3b7208a6ce8258ad8bf6160d2ea35b2f">STATE_ADDR3</a></div><div class="ttdeci">#define STATE_ADDR3</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00075">spi_flash.c:75</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed0a08c7007456819f7e6ddc22ddeaba"><div class="ttname"><a href="rom__map_8h.html#aed0a08c7007456819f7e6ddc22ddeaba">MAP_SSIAdvDataPutFrameEndNonBlocking</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEndNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04391">rom_map.h:4391</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_adb7055b4042d647c5810778257911c2f"><div class="ttname"><a href="hw__ssi_8h.html#adb7055b4042d647c5810778257911c2f">SSI_O_MIS</a></div><div class="ttdeci">#define SSI_O_MIS</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00055">hw_ssi.h:55</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga75f5fdfe876583fac9954464e1bdacae"><div class="ttname"><a href="group__spi__flash__api.html#ga75f5fdfe876583fac9954464e1bdacae">STATE_WRITE_DATA_SETUP</a></div><div class="ttdeci">#define STATE_WRITE_DATA_SETUP</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00081">spi_flash.c:81</a></div></div>
<div class="ttc" id="udma_8h_html_acfd5e57fa4a0c7e33d76c9f0f663c70e"><div class="ttname"><a href="udma_8h.html#acfd5e57fa4a0c7e33d76c9f0f663c70e">UDMA_SIZE_8</a></div><div class="ttdeci">#define UDMA_SIZE_8</div><div class="ttdef"><b>Definition:</b> <a href="udma_8h_source.html#l00232">udma.h:232</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga37df3bc5709b8a9c3658aa65175e04d8"><div class="ttname"><a href="group__spi__flash__api.html#ga37df3bc5709b8a9c3658aa65175e04d8">STATE_ADDR2</a></div><div class="ttdeci">#define STATE_ADDR2</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00074">spi_flash.c:74</a></div></div>
<div class="ttc" id="group__udma__api_html_ga41e21189773539bbc5f302863cd5bf06"><div class="ttname"><a href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06">uDMAChannelEnable</a></div><div class="ttdeci">void uDMAChannelEnable(uint32_t ui32ChannelNum)</div><div class="ttdef"><b>Definition:</b> <a href="udma_8c_source.html#l00152">udma.c:152</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga24066dd67ecabc27f87c908010002988"><div class="ttname"><a href="group__spi__flash__api.html#ga24066dd67ecabc27f87c908010002988">STATE_ADDR1</a></div><div class="ttdeci">#define STATE_ADDR1</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00073">spi_flash.c:73</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__spi__flash__api_ga0d56c3c7817caa138af5f48be143f0f5_cgraph.png" border="0" usemap="#group__spi__flash__api_ga0d56c3c7817caa138af5f48be143f0f5_cgraph" alt=""/></div>
<map name="group__spi__flash__api_ga0d56c3c7817caa138af5f48be143f0f5_cgraph" id="group__spi__flash__api_ga0d56c3c7817caa138af5f48be143f0f5_cgraph">
<area shape="rect" id="node2" href="group__udma__api.html#ga6f73ab006ff6a593eeeb947130bbdf6f" title="uDMAChannelControlSet" alt="" coords="197,5,377,32"/><area shape="rect" id="node3" href="group__udma__api.html#ga41e21189773539bbc5f302863cd5bf06" title="uDMAChannelEnable" alt="" coords="209,56,364,83"/><area shape="rect" id="node4" href="group__udma__api.html#ga938c21dc70cb6e11e6eb826de0fa21c3" title="uDMAChannelTransferSet" alt="" coords="195,107,379,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1bd70e866ded923d10aee1a43bc2b349"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashPageProgram </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Programs the SPI flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to be programmed. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data to be programmed. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to be programmed.</td></tr>
  </table>
  </dd>
</dl>
<p>This function programs data into the SPI flash, using PIO mode. This function will not return until the entire program command has been written into the SSI transmit FIFO. This uses the 0x02 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01248">1248</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00052">CMD_PP</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;{</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="comment">// Send the page program command.</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a>);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">// Send the address of the first byte to program.</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">// Loop while there is more than one data byte left to be sent.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">while</span>(ui32Count-- != 1)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="comment">// Send the next data byte.</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, *pui8Data++);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="comment">// Send the last data byte, marking it as the end of the frame.</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, *pui8Data);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;}</div>
<div class="ttc" id="group__spi__flash__api_html_ga2543fca56aeb170a41cc9f4d9b24c4cf"><div class="ttname"><a href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a></div><div class="ttdeci">#define CMD_PP</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00052">spi_flash.c:52</a></div></div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab47e95a2c22ec3d0eafe80e8fad1e84f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashPageProgramNonBlocking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bUseDMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32TxChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Programs the SPI flash in the background.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pState</td><td>is a pointer to the SPI flash state structure. </td></tr>
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to be programmed. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data to be programmed. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to be programmed. </td></tr>
    <tr><td class="paramname">bUseDMA</td><td>is <b>true</b> if uDMA should be used and <b>false</b> otherwise. </td></tr>
    <tr><td class="paramname">ui32TxChannel</td><td>is the uDMA channel to be used for writing to the SSI module.</td></tr>
  </table>
  </dd>
</dl>
<p>This function programs data into the SPI flash, using either interrupts or uDMA to transfer the data. This function will return immediately and send the data in the background. In order for this to complete successfully, several conditions must be satisfied:</p>
<ul>
<li>Prior to calling this function:<ul>
<li>The SSI module must be enabled in SysCtl.</li>
<li>The SSI pins must be configured for use by the SSI module.</li>
<li>The SSI module interrupt must be enabled in NVIC.</li>
<li>The uDMA module must be enabled in SysCtl and the control table set (if using uDMA).</li>
<li>The uDMA channels must be assigned to the SSI module.</li>
</ul>
</li>
<li>After calling this function:<ul>
<li>The interrupt handler for the SSI module must call <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a>, passing the same pState structure pointer that was supplied to this function.</li>
<li>No other SPI flash operation can be called until this operation has completed.</li>
</ul>
</li>
</ul>
<p>Completion of the programming operation is indicated when <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a> returns <b>SPI_FLASH_DONE</b>.</p>
<p>Like <a class="el" href="group__spi__flash__api.html#ga1bd70e866ded923d10aee1a43bc2b349">SPIFlashPageProgram()</a>, this uses the 0x02 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01327">1327</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8h_source.html#l00080">tSPIFlashState::bUseDMA</a>, <a class="el" href="spi__flash_8c_source.html#l00052">CMD_PP</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="spi__flash_8h_source.html#l00065">tSPIFlashState::pui8Buffer</a>, <a class="el" href="hw__ssi_8h_source.html#l00199">SSI_ICR_DMATXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00146">SSI_IM_TXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00056">SSI_O_ICR</a>, <a class="el" href="hw__ssi_8h_source.html#l00053">SSI_O_IM</a>, <a class="el" href="spi__flash_8c_source.html#l00072">STATE_CMD</a>, <a class="el" href="spi__flash_8h_source.html#l00050">tSPIFlashState::ui16Cmd</a>, <a class="el" href="spi__flash_8h_source.html#l00055">tSPIFlashState::ui16State</a>, <a class="el" href="spi__flash_8h_source.html#l00060">tSPIFlashState::ui32Addr</a>, <a class="el" href="spi__flash_8h_source.html#l00045">tSPIFlashState::ui32Base</a>, <a class="el" href="spi__flash_8h_source.html#l00070">tSPIFlashState::ui32ReadCount</a>, <a class="el" href="spi__flash_8h_source.html#l00086">tSPIFlashState::ui32TxChannel</a>, and <a class="el" href="spi__flash_8h_source.html#l00075">tSPIFlashState::ui32WriteCount</a>.</p>
<div class="fragment"><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;{</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="comment">// Save the parameters of this program operation to the state structure.</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> = ui32Base;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> = <a class="code" href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> = ui32Addr;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> = (uint8_t *)pui8Data;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> = 0;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> = ui32Count;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = bUseDMA;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a> = ui32TxChannel &amp; 0x1f;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">// Enable the SSI transmit interrupt.  This will start the transfer.  If</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">// uDMA is being used, the uDMA-related interrupt will be enabled at the</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="comment">// appropriate time by the interrupt handler.</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a>;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;}</div>
<div class="ttc" id="group__spi__flash__api_html_ga2543fca56aeb170a41cc9f4d9b24c4cf"><div class="ttname"><a href="group__spi__flash__api.html#ga2543fca56aeb170a41cc9f4d9b24c4cf">CMD_PP</a></div><div class="ttdeci">#define CMD_PP</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00052">spi_flash.c:52</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ade82e929a6d52eb542fe1d34ee210764"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">tSPIFlashState::ui32ReadCount</a></div><div class="ttdeci">uint32_t ui32ReadCount</div><div class="ttdoc">The count of bytes left to be read. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00070">spi_flash.h:70</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a3bb98b66624f93e28338d954d3fd9032"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">tSPIFlashState::ui32TxChannel</a></div><div class="ttdeci">uint32_t ui32TxChannel</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00086">spi_flash.h:86</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_afa5492f2bf96fc487cb9c6e89ee75dbf"><div class="ttname"><a href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">tSPIFlashState::ui32Base</a></div><div class="ttdeci">uint32_t ui32Base</div><div class="ttdoc">The base address of the SSI module that is being used. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00045">spi_flash.h:45</a></div></div>
<div class="ttc" id="hw__types_8h_html_ac9660181819fceac0b5abcd67d76ca6e"><div class="ttname"><a href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a></div><div class="ttdeci">#define HWREG(x)</div><div class="ttdef"><b>Definition:</b> <a href="hw__types_8h_source.html#l00048">hw_types.h:48</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a0c839fa56316268d9d3c1a6338d5b9a8"><div class="ttname"><a href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a></div><div class="ttdeci">#define SSI_O_IM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00053">hw_ssi.h:53</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a2bc8ac2fab0bc4c2a47f207c976ba875"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">tSPIFlashState::pui8Buffer</a></div><div class="ttdeci">uint8_t * pui8Buffer</div><div class="ttdoc">A pointer to the data buffer that is being read or written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00065">spi_flash.h:65</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aaf63879f2c29b6fd6d9903153dd4271a"><div class="ttname"><a href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a></div><div class="ttdeci">#define SSI_O_ICR</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00056">hw_ssi.h:56</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga88c4e00f812e9b6becece01b8f60d678"><div class="ttname"><a href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a></div><div class="ttdeci">#define STATE_CMD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00072">spi_flash.c:72</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ab33983a1783bc5f7593f60ebf8975645"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">tSPIFlashState::bUseDMA</a></div><div class="ttdeci">bool bUseDMA</div><div class="ttdoc">A flag that is true if uDMA used be used for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00080">spi_flash.h:80</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a31ff9833643e984d1fd9e48d7a851a6b"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">tSPIFlashState::ui32WriteCount</a></div><div class="ttdeci">uint32_t ui32WriteCount</div><div class="ttdoc">The count of bytes left to be written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00075">spi_flash.h:75</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a074f5ab3f6e39f06334bf7ce875c8027"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">tSPIFlashState::ui16Cmd</a></div><div class="ttdeci">uint16_t ui16Cmd</div><div class="ttdoc">The command that is being send to the SPI flash. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00050">spi_flash.h:50</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a22cc1ee908ec15a4ae5cec1f77195b53"><div class="ttname"><a href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a></div><div class="ttdeci">#define SSI_IM_TXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00146">hw_ssi.h:146</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a873e573501798cee815d0e810979e579"><div class="ttname"><a href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a></div><div class="ttdeci">#define SSI_ICR_DMATXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00199">hw_ssi.h:199</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a13617645ea59a89666b09faca56d5e83"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">tSPIFlashState::ui16State</a></div><div class="ttdeci">uint16_t ui16State</div><div class="ttdoc">The current state of the SPI flash state machine. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00055">spi_flash.h:55</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a14849eb4c3631e87c93d6bc2ed7c5a9d"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">tSPIFlashState::ui32Addr</a></div><div class="ttdeci">uint32_t ui32Addr</div><div class="ttdoc">The SPI flash address associated with the command. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00060">spi_flash.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae88d59957feec85adc1801777157b578"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashQuadRead </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash using Quad-SPI.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash with Quad-SPI, using PIO mode. This function will not return until the read has completed. This uses the 0x6b SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l02159">2159</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00061">CMD_QREAD</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04328">MAP_SSIDataGet</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, <a class="el" href="ssi_8h_source.html#l00111">SSI_ADV_MODE_QUAD_READ</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;{</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    }</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">// Send the quad read command.</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#gaccf40d95b8aa697f4023b4ff334b61fa">CMD_QREAD</a>);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// Send the address of the first byte to read.</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="comment">// Send a dummy byte.</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="comment">// Set the SSI module into Quad-SPI read mode.  In this mode, dummy writes</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="comment">// are required in order to make the transfer occur; the SSI module will</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="comment">// ignore the data (the SPI flash will never see the dummy data since</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="comment">// Quad-SPI read mode is a uni-directional input mode).</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#a4dd541d5976ffab841e75cbaa5515a48">SSI_ADV_MODE_QUAD_READ</a>);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="comment">// See if there is a single byte to be read.</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <span class="keywordflow">if</span>(ui32Count == 1)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        <span class="comment">// Perform a single dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    }</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="comment">// Perform a dummy write to prime the loop.</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        <span class="comment">// Loop while there is more than one byte left to be read.</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        <span class="keywordflow">while</span>(--ui32Count != 1)</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            <span class="comment">// Perform a dummy write to keep the transmit FIFO from going</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            <span class="comment">// empty.</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            <span class="comment">// Read the next data byte from the receive FIFO and place it into</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            <span class="comment">// the data buffer.</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        <span class="comment">// Perform the final dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="comment">// Read the next data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="comment">// Read the final data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaccf40d95b8aa697f4023b4ff334b61fa"><div class="ttname"><a href="group__spi__flash__api.html#gaccf40d95b8aa697f4023b4ff334b61fa">CMD_QREAD</a></div><div class="ttdeci">#define CMD_QREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00061">spi_flash.c:61</a></div></div>
<div class="ttc" id="ssi_8h_html_a4dd541d5976ffab841e75cbaa5515a48"><div class="ttname"><a href="ssi_8h.html#a4dd541d5976ffab841e75cbaa5515a48">SSI_ADV_MODE_QUAD_READ</a></div><div class="ttdeci">#define SSI_ADV_MODE_QUAD_READ</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00111">ssi.h:111</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8f9f9fa6cc04e29027eaa0531d308ff1"><div class="ttname"><a href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a></div><div class="ttdeci">#define MAP_SSIDataGet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04328">rom_map.h:4328</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa4ef70354c42d9ed4a78583e46c16ccd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashQuadReadNonBlocking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bUseDMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32TxChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32RxChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash using Quad-SPI in the background.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pState</td><td>is a pointer to the SPI flash state structure. </td></tr>
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read. </td></tr>
    <tr><td class="paramname">bUseDMA</td><td>is <b>true</b> if uDMA should be used and <b>false</b> otherwise. </td></tr>
    <tr><td class="paramname">ui32TxChannel</td><td>is the uDMA channel to be used for writing to the SSI module. </td></tr>
    <tr><td class="paramname">ui32RxChannel</td><td>is the uDMA channel to be used for reading from the SSI module.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash with Quad-SPI, using either interrupts or uDMA to transfer the data. This function will return immediately and read the data in the background. In order for this to complete successfully, several conditions must be satisfied:</p>
<ul>
<li>Prior to calling this function:<ul>
<li>The SSI module must be enabled in SysCtl.</li>
<li>The SSI pins must be configured for use by the SSI module.</li>
<li>The SSI module interrupt must be enabled in NVIC.</li>
<li>The uDMA module must be enabled in SysCtl and the control table set (if using uDMA).</li>
<li>The uDMA channels must be assigned to the SSI module.</li>
</ul>
</li>
<li>After calling this function:<ul>
<li>The interrupt handler for the SSI module must call <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a>, passing the same pState structure pointer that was supplied to this function.</li>
<li>No other SPI flash operation can be called until this operation has completed.</li>
</ul>
</li>
</ul>
<p>Completion of the read operation is indicated when <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a> returns <b>SPI_FLASH_DONE</b>.</p>
<p>Like <a class="el" href="group__spi__flash__api.html#gae88d59957feec85adc1801777157b578">SPIFlashQuadRead()</a>, this uses the 0x6b SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l02303">2303</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8h_source.html#l00080">tSPIFlashState::bUseDMA</a>, <a class="el" href="spi__flash_8c_source.html#l00061">CMD_QREAD</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="spi__flash_8h_source.html#l00065">tSPIFlashState::pui8Buffer</a>, <a class="el" href="hw__ssi_8h_source.html#l00200">SSI_ICR_DMARXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00199">SSI_ICR_DMATXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00148">SSI_IM_RTIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00147">SSI_IM_RXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00146">SSI_IM_TXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00056">SSI_O_ICR</a>, <a class="el" href="hw__ssi_8h_source.html#l00053">SSI_O_IM</a>, <a class="el" href="spi__flash_8c_source.html#l00072">STATE_CMD</a>, <a class="el" href="spi__flash_8h_source.html#l00050">tSPIFlashState::ui16Cmd</a>, <a class="el" href="spi__flash_8h_source.html#l00055">tSPIFlashState::ui16State</a>, <a class="el" href="spi__flash_8h_source.html#l00060">tSPIFlashState::ui32Addr</a>, <a class="el" href="spi__flash_8h_source.html#l00045">tSPIFlashState::ui32Base</a>, <a class="el" href="spi__flash_8h_source.html#l00070">tSPIFlashState::ui32ReadCount</a>, <a class="el" href="spi__flash_8h_source.html#l00091">tSPIFlashState::ui32RxChannel</a>, <a class="el" href="spi__flash_8h_source.html#l00086">tSPIFlashState::ui32TxChannel</a>, and <a class="el" href="spi__flash_8h_source.html#l00075">tSPIFlashState::ui32WriteCount</a>.</p>
<div class="fragment"><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;{</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    {</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    }</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="comment">// Save the parameters of this read operation to the state structure.</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> = ui32Base;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> = <a class="code" href="group__spi__flash__api.html#gaccf40d95b8aa697f4023b4ff334b61fa">CMD_QREAD</a>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a>;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> = ui32Addr;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> = pui8Data;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> = ui32Count;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> = ui32Count;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = bUseDMA;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a> = ui32TxChannel &amp; 0x1f;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a> = ui32RxChannel &amp; 0x1f;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <span class="comment">// Enable the SSI transmit and receive interrupts.  This will start the</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="comment">// transfer.  If uDMA is being used, the uDMA-related interrupts will be</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="comment">// enabled at the appropriate time by the interrupt handler.</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a> | <a class="code" href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a>;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a> | <a class="code" href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a> | <a class="code" href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;}</div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ade82e929a6d52eb542fe1d34ee210764"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">tSPIFlashState::ui32ReadCount</a></div><div class="ttdeci">uint32_t ui32ReadCount</div><div class="ttdoc">The count of bytes left to be read. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00070">spi_flash.h:70</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a3bb98b66624f93e28338d954d3fd9032"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">tSPIFlashState::ui32TxChannel</a></div><div class="ttdeci">uint32_t ui32TxChannel</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00086">spi_flash.h:86</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_aa47658e72d6edfdebf29fd87a368c23e"><div class="ttname"><a href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">tSPIFlashState::ui32RxChannel</a></div><div class="ttdeci">uint32_t ui32RxChannel</div><div class="ttdoc">The uDMA channel to use for receiving when using uDMA for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00091">spi_flash.h:91</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaccf40d95b8aa697f4023b4ff334b61fa"><div class="ttname"><a href="group__spi__flash__api.html#gaccf40d95b8aa697f4023b4ff334b61fa">CMD_QREAD</a></div><div class="ttdeci">#define CMD_QREAD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00061">spi_flash.c:61</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_afa5492f2bf96fc487cb9c6e89ee75dbf"><div class="ttname"><a href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">tSPIFlashState::ui32Base</a></div><div class="ttdeci">uint32_t ui32Base</div><div class="ttdoc">The base address of the SSI module that is being used. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00045">spi_flash.h:45</a></div></div>
<div class="ttc" id="hw__types_8h_html_ac9660181819fceac0b5abcd67d76ca6e"><div class="ttname"><a href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a></div><div class="ttdeci">#define HWREG(x)</div><div class="ttdef"><b>Definition:</b> <a href="hw__types_8h_source.html#l00048">hw_types.h:48</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a0c839fa56316268d9d3c1a6338d5b9a8"><div class="ttname"><a href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a></div><div class="ttdeci">#define SSI_O_IM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00053">hw_ssi.h:53</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a2bc8ac2fab0bc4c2a47f207c976ba875"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">tSPIFlashState::pui8Buffer</a></div><div class="ttdeci">uint8_t * pui8Buffer</div><div class="ttdoc">A pointer to the data buffer that is being read or written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00065">spi_flash.h:65</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aaf63879f2c29b6fd6d9903153dd4271a"><div class="ttname"><a href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a></div><div class="ttdeci">#define SSI_O_ICR</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00056">hw_ssi.h:56</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga88c4e00f812e9b6becece01b8f60d678"><div class="ttname"><a href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a></div><div class="ttdeci">#define STATE_CMD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00072">spi_flash.c:72</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ab33983a1783bc5f7593f60ebf8975645"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">tSPIFlashState::bUseDMA</a></div><div class="ttdeci">bool bUseDMA</div><div class="ttdoc">A flag that is true if uDMA used be used for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00080">spi_flash.h:80</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a31ff9833643e984d1fd9e48d7a851a6b"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">tSPIFlashState::ui32WriteCount</a></div><div class="ttdeci">uint32_t ui32WriteCount</div><div class="ttdoc">The count of bytes left to be written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00075">spi_flash.h:75</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a074f5ab3f6e39f06334bf7ce875c8027"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">tSPIFlashState::ui16Cmd</a></div><div class="ttdeci">uint16_t ui16Cmd</div><div class="ttdoc">The command that is being send to the SPI flash. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00050">spi_flash.h:50</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a991109b454b7f2a294ce9dd2b523f378"><div class="ttname"><a href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a></div><div class="ttdeci">#define SSI_IM_RXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00147">hw_ssi.h:147</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_afd3ac990370ed4a0100b719fc1c7da7f"><div class="ttname"><a href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a></div><div class="ttdeci">#define SSI_IM_RTIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00148">hw_ssi.h:148</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a22cc1ee908ec15a4ae5cec1f77195b53"><div class="ttname"><a href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a></div><div class="ttdeci">#define SSI_IM_TXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00146">hw_ssi.h:146</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a954860482fa17ad95cd0d4cb44fda84b"><div class="ttname"><a href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a></div><div class="ttdeci">#define SSI_ICR_DMARXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00200">hw_ssi.h:200</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a873e573501798cee815d0e810979e579"><div class="ttname"><a href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a></div><div class="ttdeci">#define SSI_ICR_DMATXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00199">hw_ssi.h:199</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a13617645ea59a89666b09faca56d5e83"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">tSPIFlashState::ui16State</a></div><div class="ttdeci">uint16_t ui16State</div><div class="ttdoc">The current state of the SPI flash state machine. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00055">spi_flash.h:55</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a14849eb4c3631e87c93d6bc2ed7c5a9d"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">tSPIFlashState::ui32Addr</a></div><div class="ttdeci">uint32_t ui32Addr</div><div class="ttdoc">The SPI flash address associated with the command. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00060">spi_flash.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad3dbb731a043f828f04867ff9146b07a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashRead </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash, using PIO mode. This function will not return until the read has completed. This uses the 0x03 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01372">1372</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00053">CMD_READ</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04328">MAP_SSIDataGet</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, <a class="el" href="ssi_8h_source.html#l00107">SSI_ADV_MODE_READ_WRITE</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;{</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">// Send the read command.</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga9c953a6c538020e644127ee080608021">CMD_READ</a>);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="comment">// Send the address of the first byte to read.</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">// Set the SSI module into read/write mode.  In this mode, dummy writes are</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">// required in order to make the transfer occur; the SPI flash will ignore</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="comment">// the data.</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a>);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">// See if there is a single byte to be read.</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span>(ui32Count == 1)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="comment">// Perform a single dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="comment">// Perform a dummy write to prime the loop.</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="comment">// Loop while there is more than one byte left to be read.</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">while</span>(--ui32Count != 1)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <span class="comment">// Perform a dummy write to keep the transmit FIFO from going</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            <span class="comment">// empty.</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <span class="comment">// Read the next data byte from the receive FIFO and place it into</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <span class="comment">// the data buffer.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="comment">// Perform the final dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="comment">// Read the next data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">// Read the final data byte from the receive FIFO and place it into the</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="comment">// data buffer.</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Addr);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    *pui8Data++ = ui32Addr &amp; 0xff;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8f9f9fa6cc04e29027eaa0531d308ff1"><div class="ttname"><a href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a></div><div class="ttdeci">#define MAP_SSIDataGet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04328">rom_map.h:4328</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga9c953a6c538020e644127ee080608021"><div class="ttname"><a href="group__spi__flash__api.html#ga9c953a6c538020e644127ee080608021">CMD_READ</a></div><div class="ttdeci">#define CMD_READ</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00053">spi_flash.c:53</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="ssi_8h_html_a3b381e1d2c940e29363b2e12591f9a0b"><div class="ttname"><a href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_READ_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00107">ssi.h:107</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8d594d8bdd9e5f553ed8f626a118ed7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashReadID </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8ManufacturerID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>pui16DeviceID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads the manufacturer and device IDs from the SPI flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">pui8ManufacturerID</td><td>is a pointer to the location into which to store the manufacturer ID. </td></tr>
    <tr><td class="paramname">pui16DeviceID</td><td>is a pointer to the location into which to store the device ID.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads the manufacturer and device IDs from the SPI flash. These values can be used to identify the SPI flash that is attached, as well as determining if a SPI flash is attached (if the <b>SSIRx</b> pin is pulled up or down, either using the pad's weak pull up/down or using an external resistor, which will cause the returned IDs to be either all zeros or all ones if the SPI flash is not attached). This uses the 0x9f SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l02362">2362</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00062">CMD_RDID</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04328">MAP_SSIDataGet</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, <a class="el" href="ssi_8h_source.html#l00107">SSI_ADV_MODE_READ_WRITE</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;{</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    uint32_t ui32Data1, ui32Data2;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Data1) != 0)</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    }</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="comment">// Send the read ID command.</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga7dcce537746ff1c0c717f6ac1f4af57b">CMD_RDID</a>);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="comment">// Set the SSI module into read/write mode.  In this mode, dummy writes are</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="comment">// required in order to make the transfer occur; the SPI flash will ignore</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="comment">// the data.</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a>);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="comment">// Send three dummy bytes, marking the last as the end of the frame.</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, 0);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="comment">// Read the first returned data byte, which contains the manufacturer ID.</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Data1);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    *pui8ManufacturerID = ui32Data1 &amp; 0xff;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="comment">// Read the remaining two data bytes, which contain the device ID.</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Data1);</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Data2);</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    *pui16DeviceID = ((ui32Data1 &amp; 0xff) &lt;&lt; 8) | (ui32Data2 &amp; 0xff);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8f9f9fa6cc04e29027eaa0531d308ff1"><div class="ttname"><a href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a></div><div class="ttdeci">#define MAP_SSIDataGet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04328">rom_map.h:4328</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga7dcce537746ff1c0c717f6ac1f4af57b"><div class="ttname"><a href="group__spi__flash__api.html#ga7dcce537746ff1c0c717f6ac1f4af57b">CMD_RDID</a></div><div class="ttdeci">#define CMD_RDID</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00062">spi_flash.c:62</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="ssi_8h_html_a3b381e1d2c940e29363b2e12591f9a0b"><div class="ttname"><a href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_READ_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00107">ssi.h:107</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf8c7a404794d8d63406154471c73540f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashReadNonBlocking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt_s_p_i_flash_state.html">tSPIFlashState</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pui8Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bUseDMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32TxChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32RxChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the SPI flash in the background.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pState</td><td>is a pointer to the SPI flash state structure. </td></tr>
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to read. </td></tr>
    <tr><td class="paramname">pui8Data</td><td>is a pointer to the data buffer to into which to read the data. </td></tr>
    <tr><td class="paramname">ui32Count</td><td>is the number of bytes to read. </td></tr>
    <tr><td class="paramname">bUseDMA</td><td>is <b>true</b> if uDMA should be used and <b>false</b> otherwise. </td></tr>
    <tr><td class="paramname">ui32TxChannel</td><td>is the uDMA channel to be used for writing to the SSI module. </td></tr>
    <tr><td class="paramname">ui32RxChannel</td><td>is the uDMA channel to be used for reading from the SSI module.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads data from the SPI flash, using either interrupts or uDMA to transfer the data. This function will return immediately and read the data in the background. In order for this to complete successfully, several conditions must be satisfied:</p>
<ul>
<li>Prior to calling this function:<ul>
<li>The SSI module must be enabled in SysCtl.</li>
<li>The SSI pins must be configured for use by the SSI module.</li>
<li>The SSI module interrupt must be enabled in NVIC.</li>
<li>The uDMA module must be enabled in SysCtl and the control table set (if using uDMA).</li>
<li>The uDMA channels must be assigned to the SSI module.</li>
</ul>
</li>
<li>After calling this function:<ul>
<li>The interrupt handler for the SSI module must call <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a>, passing the same pState structure pointer that was supplied to this function.</li>
<li>No other SPI flash operation can be called until this operation has completed.</li>
</ul>
</li>
</ul>
<p>Completion of the read operation is indicated when <a class="el" href="group__spi__flash__api.html#ga0d56c3c7817caa138af5f48be143f0f5">SPIFlashIntHandler()</a> returns <b>SPI_FLASH_DONE</b>.</p>
<p>Like <a class="el" href="group__spi__flash__api.html#gad3dbb731a043f828f04867ff9146b07a">SPIFlashRead()</a>, this uses the 0x03 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01510">1510</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8h_source.html#l00080">tSPIFlashState::bUseDMA</a>, <a class="el" href="spi__flash_8c_source.html#l00053">CMD_READ</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="spi__flash_8h_source.html#l00065">tSPIFlashState::pui8Buffer</a>, <a class="el" href="hw__ssi_8h_source.html#l00200">SSI_ICR_DMARXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00199">SSI_ICR_DMATXIC</a>, <a class="el" href="hw__ssi_8h_source.html#l00148">SSI_IM_RTIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00147">SSI_IM_RXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00146">SSI_IM_TXIM</a>, <a class="el" href="hw__ssi_8h_source.html#l00056">SSI_O_ICR</a>, <a class="el" href="hw__ssi_8h_source.html#l00053">SSI_O_IM</a>, <a class="el" href="spi__flash_8c_source.html#l00072">STATE_CMD</a>, <a class="el" href="spi__flash_8h_source.html#l00050">tSPIFlashState::ui16Cmd</a>, <a class="el" href="spi__flash_8h_source.html#l00055">tSPIFlashState::ui16State</a>, <a class="el" href="spi__flash_8h_source.html#l00060">tSPIFlashState::ui32Addr</a>, <a class="el" href="spi__flash_8h_source.html#l00045">tSPIFlashState::ui32Base</a>, <a class="el" href="spi__flash_8h_source.html#l00070">tSPIFlashState::ui32ReadCount</a>, <a class="el" href="spi__flash_8h_source.html#l00091">tSPIFlashState::ui32RxChannel</a>, <a class="el" href="spi__flash_8h_source.html#l00086">tSPIFlashState::ui32TxChannel</a>, and <a class="el" href="spi__flash_8h_source.html#l00075">tSPIFlashState::ui32WriteCount</a>.</p>
<div class="fragment"><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;{</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    uint32_t ui32Trash;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Trash) != 0)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    }</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">// Save the parameters of this read operation to the state structure.</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">ui32Base</a> = ui32Base;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">ui16Cmd</a> = <a class="code" href="group__spi__flash__api.html#ga9c953a6c538020e644127ee080608021">CMD_READ</a>;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">ui16State</a> = <a class="code" href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">ui32Addr</a> = ui32Addr;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">pui8Buffer</a> = pui8Data;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">ui32ReadCount</a> = ui32Count;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">ui32WriteCount</a> = ui32Count;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">bUseDMA</a> = bUseDMA;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">ui32TxChannel</a> = ui32TxChannel &amp; 0x1f;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    pState-&gt;<a class="code" href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">ui32RxChannel</a> = ui32RxChannel &amp; 0x1f;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="comment">// Enable the SSI transmit and receive interrupts.  This will start the</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">// transfer.  If uDMA is being used, the uDMA-related interrupts will be</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">// enabled at the appropriate time by the interrupt handler.</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a>) = <a class="code" href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a> | <a class="code" href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a>;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(ui32Base + <a class="code" href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a>) = <a class="code" href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a> | <a class="code" href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a> | <a class="code" href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a>;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;}</div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ade82e929a6d52eb542fe1d34ee210764"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ade82e929a6d52eb542fe1d34ee210764">tSPIFlashState::ui32ReadCount</a></div><div class="ttdeci">uint32_t ui32ReadCount</div><div class="ttdoc">The count of bytes left to be read. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00070">spi_flash.h:70</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a3bb98b66624f93e28338d954d3fd9032"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a3bb98b66624f93e28338d954d3fd9032">tSPIFlashState::ui32TxChannel</a></div><div class="ttdeci">uint32_t ui32TxChannel</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00086">spi_flash.h:86</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_aa47658e72d6edfdebf29fd87a368c23e"><div class="ttname"><a href="structt_s_p_i_flash_state.html#aa47658e72d6edfdebf29fd87a368c23e">tSPIFlashState::ui32RxChannel</a></div><div class="ttdeci">uint32_t ui32RxChannel</div><div class="ttdoc">The uDMA channel to use for receiving when using uDMA for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00091">spi_flash.h:91</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_afa5492f2bf96fc487cb9c6e89ee75dbf"><div class="ttname"><a href="structt_s_p_i_flash_state.html#afa5492f2bf96fc487cb9c6e89ee75dbf">tSPIFlashState::ui32Base</a></div><div class="ttdeci">uint32_t ui32Base</div><div class="ttdoc">The base address of the SSI module that is being used. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00045">spi_flash.h:45</a></div></div>
<div class="ttc" id="hw__types_8h_html_ac9660181819fceac0b5abcd67d76ca6e"><div class="ttname"><a href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a></div><div class="ttdeci">#define HWREG(x)</div><div class="ttdef"><b>Definition:</b> <a href="hw__types_8h_source.html#l00048">hw_types.h:48</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a0c839fa56316268d9d3c1a6338d5b9a8"><div class="ttname"><a href="hw__ssi_8h.html#a0c839fa56316268d9d3c1a6338d5b9a8">SSI_O_IM</a></div><div class="ttdeci">#define SSI_O_IM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00053">hw_ssi.h:53</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a2bc8ac2fab0bc4c2a47f207c976ba875"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a2bc8ac2fab0bc4c2a47f207c976ba875">tSPIFlashState::pui8Buffer</a></div><div class="ttdeci">uint8_t * pui8Buffer</div><div class="ttdoc">A pointer to the data buffer that is being read or written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00065">spi_flash.h:65</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_aaf63879f2c29b6fd6d9903153dd4271a"><div class="ttname"><a href="hw__ssi_8h.html#aaf63879f2c29b6fd6d9903153dd4271a">SSI_O_ICR</a></div><div class="ttdeci">#define SSI_O_ICR</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00056">hw_ssi.h:56</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga88c4e00f812e9b6becece01b8f60d678"><div class="ttname"><a href="group__spi__flash__api.html#ga88c4e00f812e9b6becece01b8f60d678">STATE_CMD</a></div><div class="ttdeci">#define STATE_CMD</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00072">spi_flash.c:72</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_ab33983a1783bc5f7593f60ebf8975645"><div class="ttname"><a href="structt_s_p_i_flash_state.html#ab33983a1783bc5f7593f60ebf8975645">tSPIFlashState::bUseDMA</a></div><div class="ttdeci">bool bUseDMA</div><div class="ttdoc">A flag that is true if uDMA used be used for the transfer. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00080">spi_flash.h:80</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a31ff9833643e984d1fd9e48d7a851a6b"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a31ff9833643e984d1fd9e48d7a851a6b">tSPIFlashState::ui32WriteCount</a></div><div class="ttdeci">uint32_t ui32WriteCount</div><div class="ttdoc">The count of bytes left to be written. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00075">spi_flash.h:75</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a074f5ab3f6e39f06334bf7ce875c8027"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a074f5ab3f6e39f06334bf7ce875c8027">tSPIFlashState::ui16Cmd</a></div><div class="ttdeci">uint16_t ui16Cmd</div><div class="ttdoc">The command that is being send to the SPI flash. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00050">spi_flash.h:50</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a991109b454b7f2a294ce9dd2b523f378"><div class="ttname"><a href="hw__ssi_8h.html#a991109b454b7f2a294ce9dd2b523f378">SSI_IM_RXIM</a></div><div class="ttdeci">#define SSI_IM_RXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00147">hw_ssi.h:147</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_afd3ac990370ed4a0100b719fc1c7da7f"><div class="ttname"><a href="hw__ssi_8h.html#afd3ac990370ed4a0100b719fc1c7da7f">SSI_IM_RTIM</a></div><div class="ttdeci">#define SSI_IM_RTIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00148">hw_ssi.h:148</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a22cc1ee908ec15a4ae5cec1f77195b53"><div class="ttname"><a href="hw__ssi_8h.html#a22cc1ee908ec15a4ae5cec1f77195b53">SSI_IM_TXIM</a></div><div class="ttdeci">#define SSI_IM_TXIM</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00146">hw_ssi.h:146</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a954860482fa17ad95cd0d4cb44fda84b"><div class="ttname"><a href="hw__ssi_8h.html#a954860482fa17ad95cd0d4cb44fda84b">SSI_ICR_DMARXIC</a></div><div class="ttdeci">#define SSI_ICR_DMARXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00200">hw_ssi.h:200</a></div></div>
<div class="ttc" id="hw__ssi_8h_html_a873e573501798cee815d0e810979e579"><div class="ttname"><a href="hw__ssi_8h.html#a873e573501798cee815d0e810979e579">SSI_ICR_DMATXIC</a></div><div class="ttdeci">#define SSI_ICR_DMATXIC</div><div class="ttdef"><b>Definition:</b> <a href="hw__ssi_8h_source.html#l00199">hw_ssi.h:199</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_ga9c953a6c538020e644127ee080608021"><div class="ttname"><a href="group__spi__flash__api.html#ga9c953a6c538020e644127ee080608021">CMD_READ</a></div><div class="ttdeci">#define CMD_READ</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00053">spi_flash.c:53</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a13617645ea59a89666b09faca56d5e83"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a13617645ea59a89666b09faca56d5e83">tSPIFlashState::ui16State</a></div><div class="ttdeci">uint16_t ui16State</div><div class="ttdoc">The current state of the SPI flash state machine. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00055">spi_flash.h:55</a></div></div>
<div class="ttc" id="structt_s_p_i_flash_state_html_a14849eb4c3631e87c93d6bc2ed7c5a9d"><div class="ttname"><a href="structt_s_p_i_flash_state.html#a14849eb4c3631e87c93d6bc2ed7c5a9d">tSPIFlashState::ui32Addr</a></div><div class="ttdeci">uint32_t ui32Addr</div><div class="ttdoc">The SPI flash address associated with the command. </div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8h_source.html#l00060">spi_flash.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gabb1bf43047839456adfc4c6e484585a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t SPIFlashReadStatus </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads the SPI flash status register.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address.</td></tr>
  </table>
  </dd>
</dl>
<p>This function reads the SPI flash status register. This uses the 0x05 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns the value of the SPI flash status register. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01587">1587</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00055">CMD_RDSR</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04328">MAP_SSIDataGet</a>, <a class="el" href="rom__map_8h_source.html#l04335">MAP_SSIDataGetNonBlocking</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, <a class="el" href="ssi_8h_source.html#l00107">SSI_ADV_MODE_READ_WRITE</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;{</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    uint32_t ui32Data;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="comment">// Drain any residual data from the receive FIFO.</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a>(ui32Base, &amp;ui32Data) != 0)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">// Send the write status register command.</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#gaf36d3b85d64c03760c6b76e916b443c1">CMD_RDSR</a>);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">// Set the SSI module into read/write mode.  In this mode, dummy writes are</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">// required in order to make the transfer occur; the SPI flash will ignore</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">// the data.</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a>);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="comment">// Perform a single dummy write, marking it as the end of the frame.</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, 0);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">// Read the value of the status register.</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <a class="code" href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a>(ui32Base, &amp;ui32Data);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// Return the status register value.</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">return</span>(ui32Data &amp; 0xff);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_a8f9f9fa6cc04e29027eaa0531d308ff1"><div class="ttname"><a href="rom__map_8h.html#a8f9f9fa6cc04e29027eaa0531d308ff1">MAP_SSIDataGet</a></div><div class="ttdeci">#define MAP_SSIDataGet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04328">rom_map.h:4328</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_a2985d0cd62b5efa437dd6c4053a66e4f"><div class="ttname"><a href="rom__map_8h.html#a2985d0cd62b5efa437dd6c4053a66e4f">MAP_SSIDataGetNonBlocking</a></div><div class="ttdeci">#define MAP_SSIDataGetNonBlocking</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04335">rom_map.h:4335</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="ssi_8h_html_a3b381e1d2c940e29363b2e12591f9a0b"><div class="ttname"><a href="ssi_8h.html#a3b381e1d2c940e29363b2e12591f9a0b">SSI_ADV_MODE_READ_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_READ_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00107">ssi.h:107</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaf36d3b85d64c03760c6b76e916b443c1"><div class="ttname"><a href="group__spi__flash__api.html#gaf36d3b85d64c03760c6b76e916b443c1">CMD_RDSR</a></div><div class="ttdeci">#define CMD_RDSR</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00055">spi_flash.c:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga058368211f1723e85295eb32b637360e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashSectorErase </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Erases a 4 KB sector of the SPI flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the SPI flash address to erase.</td></tr>
  </table>
  </dd>
</dl>
<p>This function erases a sector of the SPI flash. Each sector is 4 KB with a 4 KB alignment; the SPI flash will ignore the lower ten bits of the address provided. The sector erase command is issued by this function; <a class="el" href="group__spi__flash__api.html#gabb1bf43047839456adfc4c6e484585a6">SPIFlashReadStatus()</a> must be used to query the SPI flash to determine when the sector erase operation has completed. This uses the 0x20 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01882">1882</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00058">CMD_SE</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;{</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">// Send the sector erase command.</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#gab108a0bca1eff44cfc82862a6931b04f">CMD_SE</a>);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="comment">// Send the address of the sector to be erased, marking the last byte of</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="comment">// the address as the end of the frame.</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, (ui32Addr &gt;&gt; 8) &amp; 0xff);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, ui32Addr &amp; 0xff);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gab108a0bca1eff44cfc82862a6931b04f"><div class="ttname"><a href="group__spi__flash__api.html#gab108a0bca1eff44cfc82862a6931b04f">CMD_SE</a></div><div class="ttdeci">#define CMD_SE</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00058">spi_flash.c:58</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga86346f2b25c46fb16acdb7a0315f68c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashWriteDisable </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Disables SPI flash write operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address.</td></tr>
  </table>
  </dd>
</dl>
<p>This function sets the SPI flash to disallow program and erase operations. This uses the 0x04 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01560">1560</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00054">CMD_WRDI</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;{</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="comment">// Send the write disable command, marking this byte as the end of the</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="comment">// frame.</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#gaa98eb90657f02a0b7a4634174081799e">CMD_WRDI</a>);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gaa98eb90657f02a0b7a4634174081799e"><div class="ttname"><a href="group__spi__flash__api.html#gaa98eb90657f02a0b7a4634174081799e">CMD_WRDI</a></div><div class="ttdeci">#define CMD_WRDI</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00054">spi_flash.c:54</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadd97a4e0bcaa224283744a64c10a701c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashWriteEnable </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enables SPI flash write operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address.</td></tr>
  </table>
  </dd>
</dl>
<p>This function sets the SPI flash to allow program and erase operations. This must be done prior to each SPI flash program or erase operation; the SPI flash will automatically disable program and erase operations once a program or erase operation has completed. This uses the 0x06 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01647">1647</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00056">CMD_WREN</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;{</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="comment">// Send the write enable command, marking this byte as the end of the</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="comment">// frame.</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#ga233ab2b77759d1d35814743f08c96347">CMD_WREN</a>);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;}</div>
<div class="ttc" id="group__spi__flash__api_html_ga233ab2b77759d1d35814743f08c96347"><div class="ttname"><a href="group__spi__flash__api.html#ga233ab2b77759d1d35814743f08c96347">CMD_WREN</a></div><div class="ttdeci">#define CMD_WREN</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00056">spi_flash.c:56</a></div></div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga901b800fe1f8a373dcc1e269f4f40e04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIFlashWriteStatus </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ui8Status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Writes the SPI flash status register.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Base</td><td>is the SSI module base address. </td></tr>
    <tr><td class="paramname">ui8Status</td><td>is the value to write to the status register.</td></tr>
  </table>
  </dd>
</dl>
<p>This function writes the SPI flash status register. This uses the 0x01 SPI flash command.</p>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="spi__flash_8c_source.html#l01212">1212</a> of file <a class="el" href="spi__flash_8c_source.html">spi_flash.c</a>.</p>

<p>References <a class="el" href="spi__flash_8c_source.html#l00051">CMD_WRSR</a>, <a class="el" href="rom__map_8h_source.html#l04384">MAP_SSIAdvDataPutFrameEnd</a>, <a class="el" href="rom__map_8h_source.html#l04377">MAP_SSIAdvModeSet</a>, <a class="el" href="rom__map_8h_source.html#l04265">MAP_SSIDataPut</a>, and <a class="el" href="ssi_8h_source.html#l00108">SSI_ADV_MODE_WRITE</a>.</p>
<div class="fragment"><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;{</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">// Set the SSI module into write-only mode.</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a>(ui32Base, <a class="code" href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a>);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">// Send the write status register command.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a>(ui32Base, <a class="code" href="group__spi__flash__api.html#gacf9ec38b37caa1223e957bba6058f626">CMD_WRSR</a>);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">// Send the new status register value, marking this byte as the end of the</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// frame.</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a>(ui32Base, ui8Status);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;}</div>
<div class="ttc" id="ssi_8h_html_ac06e63f4a08c332b7dbd3b1cb0c6154c"><div class="ttname"><a href="ssi_8h.html#ac06e63f4a08c332b7dbd3b1cb0c6154c">SSI_ADV_MODE_WRITE</a></div><div class="ttdeci">#define SSI_ADV_MODE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssi_8h_source.html#l00108">ssi.h:108</a></div></div>
<div class="ttc" id="rom__map_8h_html_af2a8506d9ba0b87db9ebb07871785993"><div class="ttname"><a href="rom__map_8h.html#af2a8506d9ba0b87db9ebb07871785993">MAP_SSIAdvModeSet</a></div><div class="ttdeci">#define MAP_SSIAdvModeSet</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04377">rom_map.h:4377</a></div></div>
<div class="ttc" id="group__spi__flash__api_html_gacf9ec38b37caa1223e957bba6058f626"><div class="ttname"><a href="group__spi__flash__api.html#gacf9ec38b37caa1223e957bba6058f626">CMD_WRSR</a></div><div class="ttdeci">#define CMD_WRSR</div><div class="ttdef"><b>Definition:</b> <a href="spi__flash_8c_source.html#l00051">spi_flash.c:51</a></div></div>
<div class="ttc" id="rom__map_8h_html_aed26e3b46561e08948d24d8f583a7c43"><div class="ttname"><a href="rom__map_8h.html#aed26e3b46561e08948d24d8f583a7c43">MAP_SSIDataPut</a></div><div class="ttdeci">#define MAP_SSIDataPut</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04265">rom_map.h:4265</a></div></div>
<div class="ttc" id="rom__map_8h_html_a96329eb749a2f91f9676bbfacbe0bb7d"><div class="ttname"><a href="rom__map_8h.html#a96329eb749a2f91f9676bbfacbe0bb7d">MAP_SSIAdvDataPutFrameEnd</a></div><div class="ttdeci">#define MAP_SSIAdvDataPutFrameEnd</div><div class="ttdef"><b>Definition:</b> <a href="rom__map_8h_source.html#l04384">rom_map.h:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Feb 14 2015 21:58:15 for EE445M RTOS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
