<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>EE 445M: Mpu_api</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">EE 445M
   
   </div>
   <div id="projectbrief">Real Time Operating Systems taken at University of Texas Spring 2015</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group__mpu__api.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Mpu_api</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga16c52787707bbfe428269741396cd79d">MPUEnable</a> (uint32_t ui32MPUConfig)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#gae98f222992a05f9a0feae96f933dd69d">MPUDisable</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga682b0d081b78b73e14fa4d540291fb7e">MPURegionCountGet</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga17918fcd1ac15cb5456d7ae3ad388aaa">MPURegionEnable</a> (uint32_t ui32Region)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga36b1830b3d7ee909ee8a21a267df5164">MPURegionDisable</a> (uint32_t ui32Region)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet</a> (uint32_t ui32Region, uint32_t ui32Addr, uint32_t ui32Flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga197e3c9b41e6f05cf91ee618678dea89">MPURegionGet</a> (uint32_t ui32Region, uint32_t *pui32Addr, uint32_t *pui32Flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga5f391e2bed9919c3e98ee744d76a5a03">MPUIntRegister</a> (void(*pfnHandler)(void))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mpu__api.html#ga8bd36f9796c8a112476a11f381cd5c90">MPUIntUnregister</a> (void)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gae98f222992a05f9a0feae96f933dd69d"></a><!-- doxytag: member="mpu.c::MPUDisable" ref="gae98f222992a05f9a0feae96f933dd69d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#gae98f222992a05f9a0feae96f933dd69d">MPUDisable</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Disables the MPU for use.</p>
<p>This function disables the Cortex-M memory protection unit. When the MPU is disabled, the default memory map is used and memory management faults are not generated.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00116">116</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="hw__nvic_8h_source.html#l00131">NVIC_MPU_CTRL</a>, and <a class="el" href="hw__nvic_8h_source.html#l01123">NVIC_MPU_CTRL_ENABLE</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Turn off the MPU enable bit.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a3ddc77a4059aa9dcb20fbd9f543363a0">NVIC_MPU_CTRL</a>) &amp;= ~<a class="code" href="hw__nvic_8h.html#a22b49b0b74754a9bc96ac110f95b2f45">NVIC_MPU_CTRL_ENABLE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga16c52787707bbfe428269741396cd79d"></a><!-- doxytag: member="mpu.c::MPUEnable" ref="ga16c52787707bbfe428269741396cd79d" args="(uint32_t ui32MPUConfig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#ga16c52787707bbfe428269741396cd79d">MPUEnable</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32MPUConfig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enables and configures the MPU for use.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32MPUConfig</td><td>is the logical OR of the possible configurations.</td></tr>
  </table>
  </dd>
</dl>
<p>This function enables the Cortex-M memory protection unit. It also configures the default behavior when in privileged mode and while handling a hard fault or NMI. Prior to enabling the MPU, at least one region must be set by calling <a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet()</a> or else by enabling the default region for privileged mode by passing the <b>MPU_CONFIG_PRIV_DEFAULT</b> flag to <a class="el" href="group__mpu__api.html#ga16c52787707bbfe428269741396cd79d">MPUEnable()</a>. Once the MPU is enabled, a memory management fault is generated for memory access violations.</p>
<p>The <em>ui32MPUConfig</em> parameter should be the logical OR of any of the following:</p>
<ul>
<li><b>MPU_CONFIG_PRIV_DEFAULT</b> enables the default memory map when in privileged mode and when no other regions are defined. If this option is not enabled, then there must be at least one valid region already defined when the MPU is enabled.</li>
<li><b>MPU_CONFIG_HARDFLT_NMI</b> enables the MPU while in a hard fault or NMI exception handler. If this option is not enabled, then the MPU is disabled while in one of these exception handlers and the default memory map is applied.</li>
<li><b>MPU_CONFIG_NONE</b> chooses none of the above options. In this case, no default memory map is provided in privileged mode, and the MPU is not enabled in the fault handlers.</li>
</ul>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00089">89</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="debug_8h_source.html#l00067">ASSERT</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="mpu_8h_source.html#l00060">MPU_CONFIG_HARDFLT_NMI</a>, <a class="el" href="mpu_8h_source.html#l00059">MPU_CONFIG_PRIV_DEFAULT</a>, <a class="el" href="hw__nvic_8h_source.html#l00131">NVIC_MPU_CTRL</a>, and <a class="el" href="hw__nvic_8h_source.html#l01123">NVIC_MPU_CTRL_ENABLE</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Check the arguments.</span>
    <span class="comment">//</span>
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(!(ui32MPUConfig &amp; ~(<a class="code" href="mpu_8h.html#a360a7bc66885fa499128e66678531a62">MPU_CONFIG_PRIV_DEFAULT</a> |
                               <a class="code" href="mpu_8h.html#aecd48948da5ff4d30a1b669bd52575f5">MPU_CONFIG_HARDFLT_NMI</a>)));

    <span class="comment">//</span>
    <span class="comment">// Set the MPU control bits according to the flags passed by the user,</span>
    <span class="comment">// and also set the enable bit.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a3ddc77a4059aa9dcb20fbd9f543363a0">NVIC_MPU_CTRL</a>) = ui32MPUConfig | <a class="code" href="hw__nvic_8h.html#a22b49b0b74754a9bc96ac110f95b2f45">NVIC_MPU_CTRL_ENABLE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga5f391e2bed9919c3e98ee744d76a5a03"></a><!-- doxytag: member="mpu.c::MPUIntRegister" ref="ga5f391e2bed9919c3e98ee744d76a5a03" args="(void(*pfnHandler)(void))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#ga5f391e2bed9919c3e98ee744d76a5a03">MPUIntRegister</a> </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&#160;</td>
          <td class="paramname"><em>pfnHandler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Registers an interrupt handler for the memory management fault.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pfnHandler</td><td>is a pointer to the function to be called when the memory management fault occurs.</td></tr>
  </table>
  </dd>
</dl>
<p>This function sets and enables the handler to be called when the MPU generates a memory management fault due to a protection region access violation.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__interrupt__api.html#ga0a32aafea7f4904d2a64ee18b45f96c9">IntRegister()</a> for important information about registering interrupt handlers.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00409">409</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="debug_8h_source.html#l00067">ASSERT</a>, <a class="el" href="hw__ints_8h_source.html#l00051">FAULT_MPU</a>, <a class="el" href="interrupt_8c_source.html#l00610">IntEnable()</a>, and <a class="el" href="interrupt_8c_source.html#l00309">IntRegister()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Check the arguments.</span>
    <span class="comment">//</span>
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(pfnHandler);

    <span class="comment">//</span>
    <span class="comment">// Register the interrupt handler.</span>
    <span class="comment">//</span>
    <a class="code" href="group__interrupt__api.html#ga0a32aafea7f4904d2a64ee18b45f96c9">IntRegister</a>(<a class="code" href="hw__ints_8h.html#a50e6a1690bac07a5eeb247a96052c880">FAULT_MPU</a>, pfnHandler);

    <span class="comment">//</span>
    <span class="comment">// Enable the memory management fault.</span>
    <span class="comment">//</span>
    <a class="code" href="group__interrupt__api.html#ga49fc9c3d1a0f8c42a20249f8c5d360ce">IntEnable</a>(<a class="code" href="hw__ints_8h.html#a50e6a1690bac07a5eeb247a96052c880">FAULT_MPU</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__mpu__api_ga5f391e2bed9919c3e98ee744d76a5a03_cgraph.png" border="0" usemap="#group__mpu__api_ga5f391e2bed9919c3e98ee744d76a5a03_cgraph" alt=""/></div>
<map name="group__mpu__api_ga5f391e2bed9919c3e98ee744d76a5a03_cgraph" id="group__mpu__api_ga5f391e2bed9919c3e98ee744d76a5a03_cgraph">
<area shape="rect" id="node3" href="group__interrupt__api.html#ga49fc9c3d1a0f8c42a20249f8c5d360ce" title="IntEnable" alt="" coords="176,5,253,35"/><area shape="rect" id="node5" href="group__interrupt__api.html#ga0a32aafea7f4904d2a64ee18b45f96c9" title="IntRegister" alt="" coords="172,59,257,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga8bd36f9796c8a112476a11f381cd5c90"></a><!-- doxytag: member="mpu.c::MPUIntUnregister" ref="ga8bd36f9796c8a112476a11f381cd5c90" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#ga8bd36f9796c8a112476a11f381cd5c90">MPUIntUnregister</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Unregisters an interrupt handler for the memory management fault.</p>
<p>This function disables and clears the handler to be called when a memory management fault occurs.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__interrupt__api.html#ga0a32aafea7f4904d2a64ee18b45f96c9">IntRegister()</a> for important information about registering interrupt handlers.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00441">441</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="hw__ints_8h_source.html#l00051">FAULT_MPU</a>, <a class="el" href="interrupt_8c_source.html#l00684">IntDisable()</a>, and <a class="el" href="interrupt_8c_source.html#l00381">IntUnregister()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Disable the interrupt.</span>
    <span class="comment">//</span>
    <a class="code" href="group__interrupt__api.html#ga9af6b00884dc44e92b3d05ff821b5334">IntDisable</a>(<a class="code" href="hw__ints_8h.html#a50e6a1690bac07a5eeb247a96052c880">FAULT_MPU</a>);

    <span class="comment">//</span>
    <span class="comment">// Unregister the interrupt handler.</span>
    <span class="comment">//</span>
    <a class="code" href="group__interrupt__api.html#ga5dffc81c27c005f83e9bfc30f775982a">IntUnregister</a>(<a class="code" href="hw__ints_8h.html#a50e6a1690bac07a5eeb247a96052c880">FAULT_MPU</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__mpu__api_ga8bd36f9796c8a112476a11f381cd5c90_cgraph.png" border="0" usemap="#group__mpu__api_ga8bd36f9796c8a112476a11f381cd5c90_cgraph" alt=""/></div>
<map name="group__mpu__api_ga8bd36f9796c8a112476a11f381cd5c90_cgraph" id="group__mpu__api_ga8bd36f9796c8a112476a11f381cd5c90_cgraph">
<area shape="rect" id="node3" href="group__interrupt__api.html#ga9af6b00884dc44e92b3d05ff821b5334" title="IntDisable" alt="" coords="191,5,271,35"/><area shape="rect" id="node5" href="group__interrupt__api.html#ga5dffc81c27c005f83e9bfc30f775982a" title="IntUnregister" alt="" coords="183,59,279,88"/><area shape="rect" id="node7" href="group__interrupt__api.html#gaef37c406caeeb884ba343265b953120d" title="_IntDefaultHandler" alt="" coords="328,59,459,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga682b0d081b78b73e14fa4d540291fb7e"></a><!-- doxytag: member="mpu.c::MPURegionCountGet" ref="ga682b0d081b78b73e14fa4d540291fb7e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="group__mpu__api.html#ga682b0d081b78b73e14fa4d540291fb7e">MPURegionCountGet</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets the count of regions supported by the MPU.</p>
<p>This function is used to get the total number of regions that are supported by the MPU, including regions that are already programmed.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of memory protection regions that are available for programming using <a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet()</a>. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00136">136</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="hw__nvic_8h_source.html#l00130">NVIC_MPU_TYPE</a>, <a class="el" href="hw__nvic_8h_source.html#l01111">NVIC_MPU_TYPE_DREGION_M</a>, and <a class="el" href="hw__nvic_8h_source.html#l01114">NVIC_MPU_TYPE_DREGION_S</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Read the DREGION field of the MPU type register and mask off</span>
    <span class="comment">// the bits of interest to get the count of regions.</span>
    <span class="comment">//</span>
    <span class="keywordflow">return</span>((<a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a7be75ffdc159ad15d871dc79b12a6675">NVIC_MPU_TYPE</a>) &amp; <a class="code" href="hw__nvic_8h.html#adf9d1b6341d4d1328a37c0cdc78d160a">NVIC_MPU_TYPE_DREGION_M</a>) &gt;&gt;
           <a class="code" href="hw__nvic_8h.html#a68af7d0238520f4f2fe971bdc91e566b">NVIC_MPU_TYPE_DREGION_S</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga36b1830b3d7ee909ee8a21a267df5164"></a><!-- doxytag: member="mpu.c::MPURegionDisable" ref="ga36b1830b3d7ee909ee8a21a267df5164" args="(uint32_t ui32Region)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#ga36b1830b3d7ee909ee8a21a267df5164">MPURegionDisable</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Region</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Disables a specific region.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Region</td><td>is the region number to disable.</td></tr>
  </table>
  </dd>
</dl>
<p>This function is used to disable a previously enabled memory protection region. The region remains configured if it is not overwritten with another call to <a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet()</a>, and can be enabled again by calling <a class="el" href="group__mpu__api.html#ga17918fcd1ac15cb5456d7ae3ad388aaa">MPURegionEnable()</a>.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00194">194</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="debug_8h_source.html#l00067">ASSERT</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="hw__nvic_8h_source.html#l00134">NVIC_MPU_ATTR</a>, <a class="el" href="hw__nvic_8h_source.html#l01200">NVIC_MPU_ATTR_ENABLE</a>, and <a class="el" href="hw__nvic_8h_source.html#l00132">NVIC_MPU_NUMBER</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Check the arguments.</span>
    <span class="comment">//</span>
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Region &lt; 8);

    <span class="comment">//</span>
    <span class="comment">// Select the region to modify.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#ade051e0e6b4c898e3488eb39bfaae129">NVIC_MPU_NUMBER</a>) = ui32Region;

    <span class="comment">//</span>
    <span class="comment">// Modify the enable bit in the region attributes.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a27fcd26de5ff56333143e9d4e48c2198">NVIC_MPU_ATTR</a>) &amp;= ~<a class="code" href="hw__nvic_8h.html#aeda7a9221dedae07f1b41a94e5db8d76">NVIC_MPU_ATTR_ENABLE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga17918fcd1ac15cb5456d7ae3ad388aaa"></a><!-- doxytag: member="mpu.c::MPURegionEnable" ref="ga17918fcd1ac15cb5456d7ae3ad388aaa" args="(uint32_t ui32Region)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#ga17918fcd1ac15cb5456d7ae3ad388aaa">MPURegionEnable</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Region</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enables a specific region.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Region</td><td>is the region number to enable.</td></tr>
  </table>
  </dd>
</dl>
<p>This function is used to enable a memory protection region. The region should already be configured with the <a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet()</a> function. Once enabled, the memory protection rules of the region are applied and access violations cause a memory management fault.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00161">161</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="debug_8h_source.html#l00067">ASSERT</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="hw__nvic_8h_source.html#l00134">NVIC_MPU_ATTR</a>, <a class="el" href="hw__nvic_8h_source.html#l01200">NVIC_MPU_ATTR_ENABLE</a>, and <a class="el" href="hw__nvic_8h_source.html#l00132">NVIC_MPU_NUMBER</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Check the arguments.</span>
    <span class="comment">//</span>
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Region &lt; 8);

    <span class="comment">//</span>
    <span class="comment">// Select the region to modify.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#ade051e0e6b4c898e3488eb39bfaae129">NVIC_MPU_NUMBER</a>) = ui32Region;

    <span class="comment">//</span>
    <span class="comment">// Modify the enable bit in the region attributes.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a27fcd26de5ff56333143e9d4e48c2198">NVIC_MPU_ATTR</a>) |= <a class="code" href="hw__nvic_8h.html#aeda7a9221dedae07f1b41a94e5db8d76">NVIC_MPU_ATTR_ENABLE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga197e3c9b41e6f05cf91ee618678dea89"></a><!-- doxytag: member="mpu.c::MPURegionGet" ref="ga197e3c9b41e6f05cf91ee618678dea89" args="(uint32_t ui32Region, uint32_t *pui32Addr, uint32_t *pui32Flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#ga197e3c9b41e6f05cf91ee618678dea89">MPURegionGet</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pui32Flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets the current settings for a specific region.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Region</td><td>is the region number to get. </td></tr>
    <tr><td class="paramname">pui32Addr</td><td>points to storage for the base address of the region. </td></tr>
    <tr><td class="paramname">pui32Flags</td><td>points to the attribute flags for the region.</td></tr>
  </table>
  </dd>
</dl>
<p>This function retrieves the configuration of a specific region. The meanings and format of the parameters is the same as that of the <a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet()</a> function.</p>
<p>This function can be used to save the configuration of a region for later use with the <a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet()</a> function. The region's enable state is preserved in the attributes that are saved.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00366">366</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="debug_8h_source.html#l00067">ASSERT</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="hw__nvic_8h_source.html#l00134">NVIC_MPU_ATTR</a>, <a class="el" href="hw__nvic_8h_source.html#l00133">NVIC_MPU_BASE</a>, <a class="el" href="hw__nvic_8h_source.html#l01139">NVIC_MPU_BASE_ADDR_M</a>, and <a class="el" href="hw__nvic_8h_source.html#l00132">NVIC_MPU_NUMBER</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Check the arguments.</span>
    <span class="comment">//</span>
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Region &lt; 8);
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(pui32Addr);
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(pui32Flags);

    <span class="comment">//</span>
    <span class="comment">// Select the region to get.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#ade051e0e6b4c898e3488eb39bfaae129">NVIC_MPU_NUMBER</a>) = ui32Region;

    <span class="comment">//</span>
    <span class="comment">// Read and store the base address for the region.</span>
    <span class="comment">//</span>
    *pui32Addr = <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a89eef9b61007afd7b03f5384a4eed0f4">NVIC_MPU_BASE</a>) &amp; <a class="code" href="hw__nvic_8h.html#a4b81d3f15160fc142808d9d136e1abe2">NVIC_MPU_BASE_ADDR_M</a>;

    <span class="comment">//</span>
    <span class="comment">// Read and store the region attributes.</span>
    <span class="comment">//</span>
    *pui32Flags = <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a27fcd26de5ff56333143e9d4e48c2198">NVIC_MPU_ATTR</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga6134864a66eb0a110320fc98a49c8c57"></a><!-- doxytag: member="mpu.c::MPURegionSet" ref="ga6134864a66eb0a110320fc98a49c8c57" args="(uint32_t ui32Region, uint32_t ui32Addr, uint32_t ui32Flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__mpu__api.html#ga6134864a66eb0a110320fc98a49c8c57">MPURegionSet</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets up the access rules for a specific region.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Region</td><td>is the region number to set up. </td></tr>
    <tr><td class="paramname">ui32Addr</td><td>is the base address of the region. It must be aligned according to the size of the region specified in ui32Flags. </td></tr>
    <tr><td class="paramname">ui32Flags</td><td>is a set of flags to define the attributes of the region.</td></tr>
  </table>
  </dd>
</dl>
<p>This function sets up the protection rules for a region. The region has a base address and a set of attributes including the size. The base address parameter, <em>ui32Addr</em>, must be aligned according to the size, and the size must be a power of 2.</p>
<p>The <em>ui32Flags</em> parameter is the logical OR of all of the attributes of the region. It is a combination of choices for region size, execute permission, read/write permissions, disabled sub-regions, and a flag to determine if the region is enabled.</p>
<p>The size flag determines the size of a region and must be one of the following:</p>
<ul>
<li><b>MPU_RGN_SIZE_32B</b> </li>
<li><b>MPU_RGN_SIZE_64B</b> </li>
<li><b>MPU_RGN_SIZE_128B</b> </li>
<li><b>MPU_RGN_SIZE_256B</b> </li>
<li><b>MPU_RGN_SIZE_512B</b> </li>
<li><b>MPU_RGN_SIZE_1K</b> </li>
<li><b>MPU_RGN_SIZE_2K</b> </li>
<li><b>MPU_RGN_SIZE_4K</b> </li>
<li><b>MPU_RGN_SIZE_8K</b> </li>
<li><b>MPU_RGN_SIZE_16K</b> </li>
<li><b>MPU_RGN_SIZE_32K</b> </li>
<li><b>MPU_RGN_SIZE_64K</b> </li>
<li><b>MPU_RGN_SIZE_128K</b> </li>
<li><b>MPU_RGN_SIZE_256K</b> </li>
<li><b>MPU_RGN_SIZE_512K</b> </li>
<li><b>MPU_RGN_SIZE_1M</b> </li>
<li><b>MPU_RGN_SIZE_2M</b> </li>
<li><b>MPU_RGN_SIZE_4M</b> </li>
<li><b>MPU_RGN_SIZE_8M</b> </li>
<li><b>MPU_RGN_SIZE_16M</b> </li>
<li><b>MPU_RGN_SIZE_32M</b> </li>
<li><b>MPU_RGN_SIZE_64M</b> </li>
<li><b>MPU_RGN_SIZE_128M</b> </li>
<li><b>MPU_RGN_SIZE_256M</b> </li>
<li><b>MPU_RGN_SIZE_512M</b> </li>
<li><b>MPU_RGN_SIZE_1G</b> </li>
<li><b>MPU_RGN_SIZE_2G</b> </li>
<li><b>MPU_RGN_SIZE_4G</b> </li>
</ul>
<p>The execute permission flag must be one of the following:</p>
<ul>
<li><b>MPU_RGN_PERM_EXEC</b> enables the region for execution of code</li>
<li><b>MPU_RGN_PERM_NOEXEC</b> disables the region for execution of code</li>
</ul>
<p>The read/write access permissions are applied separately for the privileged and user modes. The read/write access flags must be one of the following:</p>
<ul>
<li><b>MPU_RGN_PERM_PRV_NO_USR_NO</b> - no access in privileged or user mode</li>
<li><b>MPU_RGN_PERM_PRV_RW_USR_NO</b> - privileged read/write, user no access</li>
<li><b>MPU_RGN_PERM_PRV_RW_USR_RO</b> - privileged read/write, user read-only</li>
<li><b>MPU_RGN_PERM_PRV_RW_USR_RW</b> - privileged read/write, user read/write</li>
<li><b>MPU_RGN_PERM_PRV_RO_USR_NO</b> - privileged read-only, user no access</li>
<li><b>MPU_RGN_PERM_PRV_RO_USR_RO</b> - privileged read-only, user read-only</li>
</ul>
<p>The region is automatically divided into 8 equally-sized sub-regions by the MPU. Sub-regions can only be used in regions of size 256 bytes or larger. Any of these 8 sub-regions can be disabled, allowing for creation of ``holes'' in a region which can be left open, or overlaid by another region with different attributes. Any of the 8 sub-regions can be disabled with a logical OR of any of the following flags:</p>
<ul>
<li><b>MPU_SUB_RGN_DISABLE_0</b> </li>
<li><b>MPU_SUB_RGN_DISABLE_1</b> </li>
<li><b>MPU_SUB_RGN_DISABLE_2</b> </li>
<li><b>MPU_SUB_RGN_DISABLE_3</b> </li>
<li><b>MPU_SUB_RGN_DISABLE_4</b> </li>
<li><b>MPU_SUB_RGN_DISABLE_5</b> </li>
<li><b>MPU_SUB_RGN_DISABLE_6</b> </li>
<li><b>MPU_SUB_RGN_DISABLE_7</b> </li>
</ul>
<p>Finally, the region can be initially enabled or disabled with one of the following flags:</p>
<ul>
<li><b>MPU_RGN_ENABLE</b> </li>
<li><b>MPU_RGN_DISABLE</b> </li>
</ul>
<p>As an example, to set a region with the following attributes: size of 32 KB, execution enabled, read-only for both privileged and user, one sub-region disabled, and initially enabled; the <em>ui32Flags</em> parameter would have the following value:</p>
<p><code> (MPU_RGN_SIZE_32K | MPU_RGN_PERM_EXEC | MPU_RGN_PERM_PRV_RO_USR_RO | MPU_SUB_RGN_DISABLE_2 | MPU_RGN_ENABLE) </code></p>
<dl class="note"><dt><b>Note:</b></dt><dd>This function writes to multiple registers and is not protected from interrupts. It is possible that an interrupt which accesses a region may occur while that region is in the process of being changed. The safest way to handle this is to disable a region before changing it. Refer to the discussion of this in the API Detailed Description section.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p>Definition at line <a class="el" href="mpu_8c_source.html#l00321">321</a> of file <a class="el" href="mpu_8c_source.html">mpu.c</a>.</p>

<p>References <a class="el" href="debug_8h_source.html#l00067">ASSERT</a>, <a class="el" href="hw__types_8h_source.html#l00048">HWREG</a>, <a class="el" href="hw__nvic_8h_source.html#l00134">NVIC_MPU_ATTR</a>, <a class="el" href="hw__nvic_8h_source.html#l01161">NVIC_MPU_ATTR_BUFFRABLE</a>, <a class="el" href="hw__nvic_8h_source.html#l01160">NVIC_MPU_ATTR_CACHEABLE</a>, <a class="el" href="hw__nvic_8h_source.html#l01159">NVIC_MPU_ATTR_SHAREABLE</a>, <a class="el" href="hw__nvic_8h_source.html#l01171">NVIC_MPU_ATTR_SIZE_M</a>, <a class="el" href="hw__nvic_8h_source.html#l01158">NVIC_MPU_ATTR_TEX_M</a>, <a class="el" href="hw__nvic_8h_source.html#l00133">NVIC_MPU_BASE</a>, and <a class="el" href="hw__nvic_8h_source.html#l01140">NVIC_MPU_BASE_VALID</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// Check the arguments.</span>
    <span class="comment">//</span>
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Region &lt; 8);
    <a class="code" href="debug_8h.html#a28301f76c53b643912da7c538f74e2c6">ASSERT</a>(ui32Addr ==
           (ui32Addr &amp; ~0 &lt;&lt; (((ui32Flags &amp; <a class="code" href="hw__nvic_8h.html#a3b344bf97566e487ec79dd8215df3c09">NVIC_MPU_ATTR_SIZE_M</a>) &gt;&gt; 1) + 1)));

    <span class="comment">//</span>
    <span class="comment">// Program the base address, use the region field to select the</span>
    <span class="comment">// region at the same time.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a89eef9b61007afd7b03f5384a4eed0f4">NVIC_MPU_BASE</a>) = ui32Addr | ui32Region | <a class="code" href="hw__nvic_8h.html#ac465a5bbc07ac6618a9d20ca0fa92bb4">NVIC_MPU_BASE_VALID</a>;

    <span class="comment">//</span>
    <span class="comment">// Program the region attributes.  Set the TEX field and the S, C,</span>
    <span class="comment">// and B bits to fixed values that are suitable for all Tiva C and</span>
    <span class="comment">// E Series memory.</span>
    <span class="comment">//</span>
    <a class="code" href="hw__types_8h.html#ac9660181819fceac0b5abcd67d76ca6e">HWREG</a>(<a class="code" href="hw__nvic_8h.html#a27fcd26de5ff56333143e9d4e48c2198">NVIC_MPU_ATTR</a>) = ((ui32Flags &amp; ~(<a class="code" href="hw__nvic_8h.html#a8fd5ec44512b3ccad91f78ce3b522bc9">NVIC_MPU_ATTR_TEX_M</a> |
                                           <a class="code" href="hw__nvic_8h.html#a538036f9c4394e8538313e68dd00fffd">NVIC_MPU_ATTR_CACHEABLE</a>)) |
                            <a class="code" href="hw__nvic_8h.html#a51299e27596a801bd96d2696b50caf10">NVIC_MPU_ATTR_SHAREABLE</a> | <a class="code" href="hw__nvic_8h.html#a1310e6fcd8ad9dc6de1841c30890b3d2">NVIC_MPU_ATTR_BUFFRABLE</a>);
}
</pre></div>
</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated on Tue Jan 27 2015 21:45:35 for EE 445M by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
